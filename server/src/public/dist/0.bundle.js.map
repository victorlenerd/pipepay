{"version":3,"sources":["webpack:///./src/public/js/pages/signin/index.js"],"names":["SignIn","state","error","submit","e","props","setCurrentUser","history","preventDefault","formEl","checkValidity","email","target","value","password","username","split","NProgress","start","signin","cognitoUser","userPool","getCurrentUser","getSession","err","result","isValid","done","idToken","payload","jwtToken","token","push","setState","message","code","React","PureComponent","withRouter"],"mappings":"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","file":"0.bundle.js","sourcesContent":["//@flow\nimport React from \"react\";\nimport { signin, userPool } from \"../../utils/auth\";\nimport { withRouter, Link } from \"react-router-dom\";\nimport NProgress from \"nprogress\";\n\n// type Props = {\n// \thistory: any,\n// \tsetCurrentUser?: any,\n// };\n\n// type State = {\n// \terror: string,\n// };\n\nclass SignIn extends React.PureComponent {\n\tstate = {\n\t\terror: \"\",\n\t};\n\n\tsubmit = async e => {\n\t\tconst { setCurrentUser, history } = this.props;\n\t\te.preventDefault();\n\t\tif (this.formEl.checkValidity() === true) {\n\t\t\tconst email = e.target.email.value;\n\t\t\tconst password = e.target.password.value;\n\t\t\tconst username = email.split(\"@\")[0];\n\n\t\t\ttry {\n\t\t\t\tNProgress.start();\n\t\t\t\tawait signin(username, password);\n\t\t\t\tconst cognitoUser = userPool.getCurrentUser();\n\t\t\t\tcognitoUser.getSession((err, result) => {\n\t\t\t\t\tif (result && result.isValid()) {\n\t\t\t\t\t\tNProgress.done();\n\t\t\t\t\t\tconst { idToken } = result;\n\n\t\t\t\t\t\tconst { payload, jwtToken } = idToken;\n\t\t\t\t\t\tpayload.token = jwtToken;\n\t\t\t\t\t\tsetCurrentUser(payload);\n\n\t\t\t\t\t\tif (\n\t\t\t\t\t\t\tpayload[\"custom:account_number\"] &&\n\t\t\t\t\t\t\tpayload[\"custom:bank_code\"]\n\t\t\t\t\t\t) {\n\t\t\t\t\t\t\thistory.push(\"/invoices\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\thistory.push(\"/verifyaccn\");\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.setState({ error: err.message });\n\t\t\t\t});\n\t\t\t} catch (err) {\n\t\t\t\tNProgress.done();\n\t\t\t\tif (err.code === \"UserNotConfirmedException\") {\n\t\t\t\t\treturn history.push(\"/verifyemail\", { username, password });\n\t\t\t\t}\n\t\t\t\tthis.setState({ error: err.message });\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setState({ error: \"Please fill all the required fields.\" });\n\t\t}\n\t};\n\n\trender() {\n\t\treturn (\n\t\t\t<React.Fragment>\n\t\t\t\t<div\n\t\t\t\t\tclassName=\"col-lg-6 col-md-6 col-sm-12 col-xs-1 cloths-bg\"\n\t\t\t\t\tid=\"noPad\"\n\t\t\t\t>\n\t\t\t\t\t<div className=\"overlay\" />\n\t\t\t\t</div>\n\t\t\t\t<div className=\"col-lg-6 col-md-6 col-sm-12 col-xs-12 left-from-content\">\n\t\t\t\t\t<div className=\"container-main\">\n\t\t\t\t\t\t<div className=\"header\">\n\t\t\t\t\t\t\t<h1>Sign In.</h1>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<br />\n\t\t\t\t\t\t<div className=\"form\">\n\t\t\t\t\t\t\t<form\n\t\t\t\t\t\t\t\tref={e => (this.formEl = e)}\n\t\t\t\t\t\t\t\tname=\"reg-form\"\n\t\t\t\t\t\t\t\tonSubmit={this.submit}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t{this.state.error !== null && (\n\t\t\t\t\t\t\t\t\t<div className=\"form-error\">{this.state.error}</div>\n\t\t\t\t\t\t\t\t)}\n\t\t\t\t\t\t\t\t<label htmlFor=\"email\">Email</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"email\"\n\t\t\t\t\t\t\t\t\tname=\"email\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\tclassName=\"text-input\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<label htmlFor=\"password\">Password</label>\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"password\"\n\t\t\t\t\t\t\t\t\tname=\"password\"\n\t\t\t\t\t\t\t\t\tplaceholder=\"\"\n\t\t\t\t\t\t\t\t\tclassName=\"text-input\"\n\t\t\t\t\t\t\t\t\trequired\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<Link to=\"forgotpassword\" id=\"forgot\">\n\t\t\t\t\t\t\t\t\tForgot Password?\n\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"submit\"\n\t\t\t\t\t\t\t\t\tname=\"sign-in\"\n\t\t\t\t\t\t\t\t\tvalue=\"SIGN IN\"\n\t\t\t\t\t\t\t\t\tclassName=\"text-submit\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<br />\n\t\t\t\t\t\t\t\t<div id=\"have-account\">\n\t\t\t\t\t\t\t\t\t<Link className=\"text-centr\" to=\"signup\">\n\t\t\t\t\t\t\t\t\t\tI haven't created an account\n\t\t\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</form>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</React.Fragment>\n\t\t);\n\t}\n}\n\nexport default withRouter(SignIn);\n"],"sourceRoot":""}