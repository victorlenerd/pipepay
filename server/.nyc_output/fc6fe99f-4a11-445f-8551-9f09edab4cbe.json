{"/Users/Sleekvick/Projects/pipepay/server/src/middleware.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/middleware.js","statementMap":{"0":{"start":{"line":4,"column":26},"end":{"line":8,"column":1}},"1":{"start":{"line":5,"column":4},"end":{"line":5,"column":22}},"2":{"start":{"line":6,"column":4},"end":{"line":6,"column":55}},"3":{"start":{"line":7,"column":4},"end":{"line":7,"column":31}}},"fnMap":{"0":{"name":"setGlobalMiddleware","decl":{"start":{"line":4,"column":35},"end":{"line":4,"column":54}},"loc":{"start":{"line":4,"column":60},"end":{"line":8,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"sources":["src/middleware.js"],"names":["bodyParser","morgan","setGlobalMiddleware","app","use","urlencoded","extended","json"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,aAAvB;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AAEA,IAAMC,sBAAsB,SAAtBA,mBAAsB,MAAO;AAC/BC,QAAIC,GAAJ,CAAQH,QAAR;AACAE,QAAIC,GAAJ,CAAQJ,WAAWK,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAH,QAAIC,GAAJ,CAAQJ,WAAWO,IAAX,EAAR;AACH,CAJD;;AAMA,eAAeL,mBAAf","file":"middleware.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import bodyParser from 'body-parser';\nimport morgan from 'morgan';\n\nconst setGlobalMiddleware = app => {\n    app.use(morgan());\n    app.use(bodyParser.urlencoded({ extended: true }))\n    app.use(bodyParser.json())\n}\n\nexport default setGlobalMiddleware;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"29cee4da1d88e554e3027715d8cf64866613745b"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":11,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.model.js"],"names":["mongoose","DisputeSchema","Schema","customerEmail","String","marchantEmail","from","reason","category","invoiceId","type","unique","status","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,mBAAeC,MADuB;AAEtCC,mBAAeD,MAFuB;AAGtCE,UAAMF,MAHgC;AAItCG,YAAQH,MAJ8B;AAKtCI,cAAUJ,MAL4B;AAMtCK,eAAW,EAAEC,MAAMN,MAAR,EAAgBO,QAAQ,IAAxB,EAN2B;AAOtCC,YAAQR;AAP8B,CAApB,CAAtB;;AAUA,eAAeJ,SAASa,KAAT,CAAe,SAAf,EAA0BZ,aAA1B,CAAf","file":"dispute.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst DisputeSchema = new mongoose.Schema({\n    customerEmail: String,\n    marchantEmail: String,\n    from: String,\n    reason: String,\n    category: String,\n    invoiceId: { type: String, unique: true },\n    status: String\n});\n\nexport default mongoose.model('Dispute', DisputeSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"fd133248553e28755a4b1ff62262a15a5497b4df"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":18,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.model.js"],"names":["mongoose","InvoiceSchema","Schema","userId","String","description","deliveryAmount","Number","purchaseAmount","totalPrice","customerName","customerEmail","marchantName","marchantAccountNumber","marchantBankCode","marchantEmail","invoice_code","verifyCode","status","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,YAAQC,MAD8B;AAEtCC,iBAAaD,MAFyB;AAGtCE,oBAAgBC,MAHsB;AAItCC,oBAAgBD,MAJsB;AAKtCE,gBAAYF,MAL0B;AAMtCG,kBAAcN,MANwB;AAOtCO,mBAAeP,MAPuB;AAQtCQ,kBAAcR,MARwB;AAStCS,2BAAuBT,MATe;AAUtCU,sBAAkBV,MAVoB;AAWtCW,mBAAeX,MAXuB;AAYtCY,kBAAcZ,MAZwB;AAatCa,gBAAYb,MAb0B;AActCc,YAAQd;AAd8B,CAApB,CAAtB;;AAiBA,eAAeJ,SAASmB,KAAT,CAAe,SAAf,EAA0BlB,aAA1B,CAAf","file":"invoice.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst InvoiceSchema = new mongoose.Schema({\n    userId: String,\n    description: String,\n    deliveryAmount: Number,\n    purchaseAmount: Number,\n    totalPrice: Number,\n    customerName: String,\n    customerEmail: String,\n    marchantName: String,\n    marchantAccountNumber: String,\n    marchantBankCode: String,\n    marchantEmail: String,\n    invoice_code: String,\n    verifyCode: String,\n    status: String\n});\n\nexport default mongoose.model('Invoice', InvoiceSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"a9b67bab3f5e6af017f5e0c89d4be1b7810e8ec2"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/generateController.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/generateController.js","statementMap":{"0":{"start":{"line":4,"column":21},"end":{"line":49,"column":5}},"1":{"start":{"line":6,"column":12},"end":{"line":10,"column":15}},"2":{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},"3":{"start":{"line":7,"column":25},"end":{"line":7,"column":99}},"4":{"start":{"line":8,"column":16},"end":{"line":8,"column":35}},"5":{"start":{"line":9,"column":16},"end":{"line":9,"column":23}},"6":{"start":{"line":13,"column":23},"end":{"line":13,"column":31}},"7":{"start":{"line":14,"column":12},"end":{"line":14,"column":38}},"8":{"start":{"line":15,"column":12},"end":{"line":18,"column":15}},"9":{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},"10":{"start":{"line":16,"column":25},"end":{"line":16,"column":92}},"11":{"start":{"line":17,"column":16},"end":{"line":17,"column":67}},"12":{"start":{"line":21,"column":21},"end":{"line":21,"column":30}},"13":{"start":{"line":22,"column":12},"end":{"line":25,"column":15}},"14":{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},"15":{"start":{"line":23,"column":25},"end":{"line":23,"column":92}},"16":{"start":{"line":24,"column":16},"end":{"line":24,"column":56}},"17":{"start":{"line":28,"column":12},"end":{"line":31,"column":15}},"18":{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},"19":{"start":{"line":29,"column":25},"end":{"line":29,"column":92}},"20":{"start":{"line":30,"column":16},"end":{"line":30,"column":68}},"21":{"start":{"line":34,"column":21},"end":{"line":34,"column":30}},"22":{"start":{"line":35,"column":12},"end":{"line":38,"column":15}},"23":{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},"24":{"start":{"line":36,"column":25},"end":{"line":36,"column":92}},"25":{"start":{"line":37,"column":16},"end":{"line":37,"column":71}},"26":{"start":{"line":41,"column":21},"end":{"line":41,"column":30}},"27":{"start":{"line":42,"column":23},"end":{"line":42,"column":31}},"28":{"start":{"line":43,"column":12},"end":{"line":47,"column":15}},"29":{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},"30":{"start":{"line":44,"column":25},"end":{"line":44,"column":92}},"31":{"start":{"line":45,"column":30},"end":{"line":45,"column":59}},"32":{"start":{"line":46,"column":16},"end":{"line":46,"column":71}},"33":{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},"34":{"start":{"line":52,"column":8},"end":{"line":52,"column":23}},"35":{"start":{"line":55,"column":4},"end":{"line":55,"column":53}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":15},"end":{"line":3,"column":16}},"loc":{"start":{"line":3,"column":43},"end":{"line":56,"column":1}},"line":3},"1":{"name":"findByParam","decl":{"start":{"line":5,"column":30},"end":{"line":5,"column":41}},"loc":{"start":{"line":5,"column":62},"end":{"line":11,"column":9}},"line":5},"2":{"name":"(anonymous_2)","decl":{"start":{"line":6,"column":31},"end":{"line":6,"column":32}},"loc":{"start":{"line":6,"column":51},"end":{"line":10,"column":13}},"line":6},"3":{"name":"createOne","decl":{"start":{"line":12,"column":28},"end":{"line":12,"column":37}},"loc":{"start":{"line":12,"column":48},"end":{"line":19,"column":9}},"line":12},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":31},"end":{"line":15,"column":32}},"loc":{"start":{"line":15,"column":51},"end":{"line":18,"column":13}},"line":15},"5":{"name":"deleteOne","decl":{"start":{"line":20,"column":28},"end":{"line":20,"column":37}},"loc":{"start":{"line":20,"column":48},"end":{"line":26,"column":9}},"line":20},"6":{"name":"(anonymous_6)","decl":{"start":{"line":22,"column":41},"end":{"line":22,"column":42}},"loc":{"start":{"line":22,"column":61},"end":{"line":25,"column":13}},"line":22},"7":{"name":"getAll","decl":{"start":{"line":27,"column":25},"end":{"line":27,"column":31}},"loc":{"start":{"line":27,"column":42},"end":{"line":32,"column":9}},"line":27},"8":{"name":"(anonymous_8)","decl":{"start":{"line":28,"column":27},"end":{"line":28,"column":28}},"loc":{"start":{"line":28,"column":48},"end":{"line":31,"column":13}},"line":28},"9":{"name":"getOne","decl":{"start":{"line":33,"column":25},"end":{"line":33,"column":31}},"loc":{"start":{"line":33,"column":42},"end":{"line":39,"column":9}},"line":33},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":36},"end":{"line":35,"column":37}},"loc":{"start":{"line":35,"column":57},"end":{"line":38,"column":13}},"line":35},"11":{"name":"updateOne","decl":{"start":{"line":40,"column":28},"end":{"line":40,"column":37}},"loc":{"start":{"line":40,"column":48},"end":{"line":48,"column":9}},"line":40},"12":{"name":"(anonymous_12)","decl":{"start":{"line":43,"column":54},"end":{"line":43,"column":55}},"loc":{"start":{"line":43,"column":74},"end":{"line":47,"column":13}},"line":43}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},"type":"if","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},{"start":{"line":7,"column":16},"end":{"line":7,"column":99}}],"line":7},"1":{"loc":{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},"type":"if","locations":[{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},{"start":{"line":16,"column":16},"end":{"line":16,"column":92}}],"line":16},"2":{"loc":{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},"type":"if","locations":[{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},{"start":{"line":23,"column":16},"end":{"line":23,"column":92}}],"line":23},"3":{"loc":{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},"type":"if","locations":[{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},{"start":{"line":29,"column":16},"end":{"line":29,"column":92}}],"line":29},"4":{"loc":{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},"type":"if","locations":[{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},{"start":{"line":36,"column":16},"end":{"line":36,"column":92}}],"line":36},"5":{"loc":{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},"type":"if","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},{"start":{"line":44,"column":16},"end":{"line":44,"column":92}}],"line":44},"6":{"loc":{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},{"start":{"line":51,"column":4},"end":{"line":53,"column":5}}],"line":51}},"s":{"0":3,"1":2,"2":2,"3":0,"4":2,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":1,"22":1,"23":1,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":3,"34":0,"35":3},"f":{"0":3,"1":2,"2":2,"3":0,"4":0,"5":1,"6":1,"7":0,"8":0,"9":1,"10":1,"11":0,"12":0},"b":{"0":[0,2],"1":[0,0],"2":[0,1],"3":[0,0],"4":[0,1],"5":[0,0],"6":[0,3]},"inputSourceMap":{"version":3,"sources":["src/api/modules/generateController.js"],"names":["model","overrides","controller","findByParam","req","res","next","id","findById","err","doc","status","send","success","error","message","docId","createOne","body","userId","user","create","data","deleteOne","_id","getAll","find","docs","getOne","updateOne","findOneAndUpdate","updated"],"mappings":"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","file":"generateController.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["export default function (model, overrides) {\n    var controller = {\n        findByParam: function (req, res, next, id) {\n            model.findById(id, function (err, doc) {\n                if (err) res.status(404).send({ success: false, error: { message: \"Not found\" } });\n                req.docId = doc.id;\n                next();\n            });\n        },\n        createOne: function (req, res) {\n            var body = req.body;\n            body.userId = req.user.id;\n            model.create(body, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });\n                res.status(200).send({ success: true, data: doc });\n            });\n        },\n        deleteOne: function (req, res) {\n            var id = req.docId;\n            model.deleteOne({ _id: id }, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true });\n            });\n        },\n        getAll: function (req, res) {\n            model.find({}, function (err, docs) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true, data: docs });\n            });\n        },\n        getOne: function (req, res) {\n            var id = req.docId;\n            model.find({ _id: id }, function (err, docs) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true, data: docs[0] });\n            });\n        },\n        updateOne: function (req, res) {\n            var id = req.docId;\n            var body = req.body;\n            model.findOneAndUpdate({ _id: id }, body, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                var updated = Object.assign({}, body, doc);\n                res.status(200).send({ success: true, data: updated });\n            });\n        }\n    };\n\n    if (!overrides) {\n        overrides = {}\n    }\n\n    return Object.assign({}, controller, overrides);\n};"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"c7631bddd9b0416ea7b10a2286b419bc28f8c545"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/mailer.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/mailer.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":10,"column":17},"end":{"line":10,"column":39}},"2":{"start":{"line":11,"column":20},"end":{"line":11,"column":45}},"3":{"start":{"line":13,"column":18},"end":{"line":21,"column":2}},"4":{"start":{"line":23,"column":11},"end":{"line":23,"column":43}},"5":{"start":{"line":25,"column":29},"end":{"line":44,"column":1}},"6":{"start":{"line":26,"column":24},"end":{"line":26,"column":42}},"7":{"start":{"line":27,"column":21},"end":{"line":27,"column":36}},"8":{"start":{"line":28,"column":4},"end":{"line":43,"column":7}},"9":{"start":{"line":29,"column":26},"end":{"line":34,"column":9}},"10":{"start":{"line":36,"column":8},"end":{"line":42,"column":11}},"11":{"start":{"line":37,"column":12},"end":{"line":39,"column":13}},"12":{"start":{"line":38,"column":16},"end":{"line":38,"column":48}},"13":{"start":{"line":41,"column":12},"end":{"line":41,"column":26}},"14":{"start":{"line":46,"column":13},"end":{"line":56,"column":1}},"15":{"start":{"line":47,"column":4},"end":{"line":55,"column":7}},"16":{"start":{"line":48,"column":8},"end":{"line":54,"column":11}},"17":{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},"18":{"start":{"line":50,"column":16},"end":{"line":50,"column":48}},"19":{"start":{"line":53,"column":12},"end":{"line":53,"column":26}},"20":{"start":{"line":58,"column":29},"end":{"line":98,"column":1}},"21":{"start":{"line":59,"column":4},"end":{"line":97,"column":9}},"22":{"start":{"line":60,"column":20},"end":{"line":92,"column":11}},"23":{"start":{"line":62,"column":12},"end":{"line":91,"column":41}},"24":{"start":{"line":63,"column":16},"end":{"line":90,"column":17}},"25":{"start":{"line":64,"column":20},"end":{"line":89,"column":21}},"26":{"start":{"line":66,"column":28},"end":{"line":70,"column":30}},"27":{"start":{"line":71,"column":28},"end":{"line":71,"column":46}},"28":{"start":{"line":72,"column":28},"end":{"line":72,"column":46}},"29":{"start":{"line":73,"column":28},"end":{"line":73,"column":164}},"30":{"start":{"line":76,"column":28},"end":{"line":76,"column":38}},"31":{"start":{"line":77,"column":28},"end":{"line":77,"column":47}},"32":{"start":{"line":78,"column":28},"end":{"line":78,"column":34}},"33":{"start":{"line":81,"column":28},"end":{"line":81,"column":46}},"34":{"start":{"line":82,"column":28},"end":{"line":82,"column":63}},"35":{"start":{"line":84,"column":28},"end":{"line":84,"column":48}},"36":{"start":{"line":88,"column":28},"end":{"line":88,"column":51}},"37":{"start":{"line":94,"column":8},"end":{"line":96,"column":10}},"38":{"start":{"line":95,"column":12},"end":{"line":95,"column":48}},"39":{"start":{"line":100,"column":30},"end":{"line":102,"column":1}},"40":{"start":{"line":101,"column":4},"end":{"line":101,"column":54}},"41":{"start":{"line":104,"column":29},"end":{"line":158,"column":1}},"42":{"start":{"line":105,"column":23},"end":{"line":105,"column":113}},"43":{"start":{"line":106,"column":4},"end":{"line":157,"column":9}},"44":{"start":{"line":107,"column":20},"end":{"line":152,"column":11}},"45":{"start":{"line":109,"column":12},"end":{"line":151,"column":43}},"46":{"start":{"line":110,"column":16},"end":{"line":150,"column":17}},"47":{"start":{"line":111,"column":20},"end":{"line":149,"column":21}},"48":{"start":{"line":113,"column":28},"end":{"line":116,"column":30}},"49":{"start":{"line":117,"column":28},"end":{"line":117,"column":47}},"50":{"start":{"line":119,"column":28},"end":{"line":122,"column":29}},"51":{"start":{"line":120,"column":32},"end":{"line":120,"column":51}},"52":{"start":{"line":121,"column":32},"end":{"line":121,"column":38}},"53":{"start":{"line":124,"column":28},"end":{"line":124,"column":47}},"54":{"start":{"line":125,"column":28},"end":{"line":125,"column":504}},"55":{"start":{"line":128,"column":28},"end":{"line":128,"column":47}},"56":{"start":{"line":129,"column":28},"end":{"line":129,"column":34}},"57":{"start":{"line":132,"column":28},"end":{"line":132,"column":47}},"58":{"start":{"line":133,"column":28},"end":{"line":133,"column":504}},"59":{"start":{"line":136,"column":28},"end":{"line":136,"column":38}},"60":{"start":{"line":137,"column":28},"end":{"line":137,"column":48}},"61":{"start":{"line":138,"column":28},"end":{"line":138,"column":34}},"62":{"start":{"line":141,"column":28},"end":{"line":141,"column":48}},"63":{"start":{"line":142,"column":28},"end":{"line":142,"column":65}},"64":{"start":{"line":144,"column":28},"end":{"line":144,"column":49}},"65":{"start":{"line":148,"column":28},"end":{"line":148,"column":52}},"66":{"start":{"line":154,"column":8},"end":{"line":156,"column":10}},"67":{"start":{"line":155,"column":12},"end":{"line":155,"column":48}},"68":{"start":{"line":160,"column":43},"end":{"line":200,"column":1}},"69":{"start":{"line":161,"column":4},"end":{"line":199,"column":9}},"70":{"start":{"line":162,"column":20},"end":{"line":194,"column":11}},"71":{"start":{"line":164,"column":12},"end":{"line":193,"column":42}},"72":{"start":{"line":165,"column":16},"end":{"line":192,"column":17}},"73":{"start":{"line":166,"column":20},"end":{"line":191,"column":21}},"74":{"start":{"line":168,"column":28},"end":{"line":172,"column":30}},"75":{"start":{"line":173,"column":28},"end":{"line":173,"column":47}},"76":{"start":{"line":174,"column":28},"end":{"line":174,"column":47}},"77":{"start":{"line":175,"column":28},"end":{"line":175,"column":91}},"78":{"start":{"line":178,"column":28},"end":{"line":178,"column":38}},"79":{"start":{"line":179,"column":28},"end":{"line":179,"column":48}},"80":{"start":{"line":180,"column":28},"end":{"line":180,"column":34}},"81":{"start":{"line":183,"column":28},"end":{"line":183,"column":47}},"82":{"start":{"line":184,"column":28},"end":{"line":184,"column":65}},"83":{"start":{"line":186,"column":28},"end":{"line":186,"column":49}},"84":{"start":{"line":190,"column":28},"end":{"line":190,"column":52}},"85":{"start":{"line":196,"column":8},"end":{"line":198,"column":10}},"86":{"start":{"line":197,"column":12},"end":{"line":197,"column":48}}},"fnMap":{"0":{"name":"sendInvoiceMail","decl":{"start":{"line":25,"column":38},"end":{"line":25,"column":53}},"loc":{"start":{"line":25,"column":60},"end":{"line":44,"column":1}},"line":25},"1":{"name":"(anonymous_1)","decl":{"start":{"line":28,"column":24},"end":{"line":28,"column":25}},"loc":{"start":{"line":28,"column":51},"end":{"line":43,"column":5}},"line":28},"2":{"name":"(anonymous_2)","decl":{"start":{"line":36,"column":42},"end":{"line":36,"column":43}},"loc":{"start":{"line":36,"column":65},"end":{"line":42,"column":9}},"line":36},"3":{"name":"sendTo","decl":{"start":{"line":46,"column":22},"end":{"line":46,"column":28}},"loc":{"start":{"line":46,"column":41},"end":{"line":56,"column":1}},"line":46},"4":{"name":"(anonymous_4)","decl":{"start":{"line":47,"column":24},"end":{"line":47,"column":25}},"loc":{"start":{"line":47,"column":51},"end":{"line":55,"column":5}},"line":47},"5":{"name":"(anonymous_5)","decl":{"start":{"line":48,"column":41},"end":{"line":48,"column":42}},"loc":{"start":{"line":48,"column":64},"end":{"line":54,"column":9}},"line":48},"6":{"name":"sendReceiptMail","decl":{"start":{"line":58,"column":38},"end":{"line":58,"column":53}},"loc":{"start":{"line":58,"column":106},"end":{"line":98,"column":1}},"line":58},"7":{"name":"(anonymous_7)","decl":{"start":{"line":59,"column":24},"end":{"line":59,"column":25}},"loc":{"start":{"line":59,"column":36},"end":{"line":97,"column":5}},"line":59},"8":{"name":"_callee","decl":{"start":{"line":60,"column":86},"end":{"line":60,"column":93}},"loc":{"start":{"line":60,"column":111},"end":{"line":92,"column":9}},"line":60},"9":{"name":"_callee$","decl":{"start":{"line":62,"column":53},"end":{"line":62,"column":61}},"loc":{"start":{"line":62,"column":72},"end":{"line":91,"column":13}},"line":62},"10":{"name":"(anonymous_10)","decl":{"start":{"line":94,"column":15},"end":{"line":94,"column":16}},"loc":{"start":{"line":94,"column":34},"end":{"line":96,"column":9}},"line":94},"11":{"name":"sendTransferMail","decl":{"start":{"line":100,"column":39},"end":{"line":100,"column":55}},"loc":{"start":{"line":100,"column":86},"end":{"line":102,"column":1}},"line":100},"12":{"name":"(anonymous_12)","decl":{"start":{"line":101,"column":24},"end":{"line":101,"column":25}},"loc":{"start":{"line":101,"column":50},"end":{"line":101,"column":52}},"line":101},"13":{"name":"sendDisputeMail","decl":{"start":{"line":104,"column":38},"end":{"line":104,"column":53}},"loc":{"start":{"line":104,"column":119},"end":{"line":158,"column":1}},"line":104},"14":{"name":"(anonymous_14)","decl":{"start":{"line":106,"column":24},"end":{"line":106,"column":25}},"loc":{"start":{"line":106,"column":36},"end":{"line":157,"column":5}},"line":106},"15":{"name":"_callee2","decl":{"start":{"line":107,"column":86},"end":{"line":107,"column":94}},"loc":{"start":{"line":107,"column":112},"end":{"line":152,"column":9}},"line":107},"16":{"name":"_callee2$","decl":{"start":{"line":109,"column":53},"end":{"line":109,"column":62}},"loc":{"start":{"line":109,"column":74},"end":{"line":151,"column":13}},"line":109},"17":{"name":"(anonymous_17)","decl":{"start":{"line":154,"column":15},"end":{"line":154,"column":16}},"loc":{"start":{"line":154,"column":35},"end":{"line":156,"column":9}},"line":154},"18":{"name":"sendCustormerVerificationCode","decl":{"start":{"line":160,"column":52},"end":{"line":160,"column":81}},"loc":{"start":{"line":160,"column":103},"end":{"line":200,"column":1}},"line":160},"19":{"name":"(anonymous_19)","decl":{"start":{"line":161,"column":24},"end":{"line":161,"column":25}},"loc":{"start":{"line":161,"column":36},"end":{"line":199,"column":5}},"line":161},"20":{"name":"_callee3","decl":{"start":{"line":162,"column":86},"end":{"line":162,"column":94}},"loc":{"start":{"line":162,"column":112},"end":{"line":194,"column":9}},"line":162},"21":{"name":"_callee3$","decl":{"start":{"line":164,"column":53},"end":{"line":164,"column":62}},"loc":{"start":{"line":164,"column":74},"end":{"line":193,"column":13}},"line":164},"22":{"name":"(anonymous_22)","decl":{"start":{"line":196,"column":15},"end":{"line":196,"column":16}},"loc":{"start":{"line":196,"column":35},"end":{"line":198,"column":9}},"line":196}},"branchMap":{"0":{"loc":{"start":{"line":37,"column":12},"end":{"line":39,"column":13}},"type":"if","locations":[{"start":{"line":37,"column":12},"end":{"line":39,"column":13}},{"start":{"line":37,"column":12},"end":{"line":39,"column":13}}],"line":37},"1":{"loc":{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},{"start":{"line":49,"column":12},"end":{"line":51,"column":13}}],"line":49},"2":{"loc":{"start":{"line":64,"column":20},"end":{"line":89,"column":21}},"type":"switch","locations":[{"start":{"line":65,"column":24},"end":{"line":73,"column":164}},{"start":{"line":75,"column":24},"end":{"line":78,"column":34}},{"start":{"line":80,"column":24},"end":{"line":84,"column":48}},{"start":{"line":86,"column":24},"end":{"line":86,"column":32}},{"start":{"line":87,"column":24},"end":{"line":88,"column":51}}],"line":64},"3":{"loc":{"start":{"line":105,"column":23},"end":{"line":105,"column":113}},"type":"cond-expr","locations":[{"start":{"line":105,"column":76},"end":{"line":105,"column":88}},{"start":{"line":105,"column":91},"end":{"line":105,"column":113}}],"line":105},"4":{"loc":{"start":{"line":105,"column":23},"end":{"line":105,"column":73}},"type":"binary-expr","locations":[{"start":{"line":105,"column":23},"end":{"line":105,"column":43}},{"start":{"line":105,"column":47},"end":{"line":105,"column":73}}],"line":105},"5":{"loc":{"start":{"line":111,"column":20},"end":{"line":149,"column":21}},"type":"switch","locations":[{"start":{"line":112,"column":24},"end":{"line":125,"column":504}},{"start":{"line":127,"column":24},"end":{"line":129,"column":34}},{"start":{"line":131,"column":24},"end":{"line":133,"column":504}},{"start":{"line":135,"column":24},"end":{"line":138,"column":34}},{"start":{"line":140,"column":24},"end":{"line":144,"column":49}},{"start":{"line":146,"column":24},"end":{"line":146,"column":32}},{"start":{"line":147,"column":24},"end":{"line":148,"column":52}}],"line":111},"6":{"loc":{"start":{"line":119,"column":28},"end":{"line":122,"column":29}},"type":"if","locations":[{"start":{"line":119,"column":28},"end":{"line":122,"column":29}},{"start":{"line":119,"column":28},"end":{"line":122,"column":29}}],"line":119},"7":{"loc":{"start":{"line":166,"column":20},"end":{"line":191,"column":21}},"type":"switch","locations":[{"start":{"line":167,"column":24},"end":{"line":175,"column":91}},{"start":{"line":177,"column":24},"end":{"line":180,"column":34}},{"start":{"line":182,"column":24},"end":{"line":186,"column":49}},{"start":{"line":188,"column":24},"end":{"line":188,"column":32}},{"start":{"line":189,"column":24},"end":{"line":190,"column":52}}],"line":166}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":6,"16":6,"17":6,"18":0,"19":6,"20":1,"21":1,"22":1,"23":1,"24":2,"25":3,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":1,"37":1,"38":1,"39":1,"40":0,"41":1,"42":1,"43":1,"44":1,"45":1,"46":2,"47":4,"48":1,"49":1,"50":1,"51":1,"52":1,"53":0,"54":0,"55":0,"56":0,"57":1,"58":1,"59":1,"60":1,"61":1,"62":0,"63":0,"64":0,"65":1,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":2,"73":3,"74":1,"75":1,"76":1,"77":1,"78":1,"79":1,"80":1,"81":0,"82":0,"83":0,"84":1,"85":1,"86":1},"f":{"0":0,"1":0,"2":0,"3":6,"4":6,"5":6,"6":1,"7":1,"8":1,"9":2,"10":1,"11":0,"12":0,"13":1,"14":1,"15":1,"16":2,"17":1,"18":1,"19":1,"20":1,"21":2,"22":1},"b":{"0":[0,0],"1":[0,6],"2":[1,1,0,1,1],"3":[0,1],"4":[1,0],"5":[1,0,1,1,0,1,1],"6":[1,0],"7":[1,1,0,1,1]},"inputSourceMap":{"version":3,"sources":["src/api/modules/mailer.js"],"names":["nodemailer","ZOHO_EMAIL","process","env","ZOHO_PASSWORD","transporter","createTransport","host","port","secure","auth","user","pass","from","sendInvoiceMail","customerEmail","totalPrice","resolve","reject","mailOptions","to","subject","text","sendMail","error","info","Error","sendTo","mailOption","sendReceiptMail","customerName","marchantEmail","amount","all","sendTransferMail","esolve","sendDisputeMail","reason","disputeFrom","supportEmail","sendCustormerVerificationCode","code"],"mappings":"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","file":"mailer.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import nodemailer from 'nodemailer';\n\nconst ZOHO_EMAIL = process.env.ZOHO_EMAIL;\nconst ZOHO_PASSWORD = process.env.ZOHO_PASSWORD;\n\nconst transporter = nodemailer.createTransport({\n    host: 'smtp.zoho.com',\n    port: 465,\n    secure: true,\n    auth: {\n        user: ZOHO_EMAIL,\n        pass: ZOHO_PASSWORD\n    }\n});\n\nconst from = 'Pipepay <hello@pipepay.africa>';\n\nexport const sendInvoiceMail = ({ customerEmail, totalPrice }) => new Promise((resolve, reject) => {\n    let mailOptions = {\n        from,\n        to: customerEmail,\n        subject: 'Your Invoice Is Ready',\n        text: `Your invoice is worth ${totalPrice }`,\n    };\n\n    transporter.sendMail(mailOptions, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n\n        resolve(info);\n    });\n});\n\nconst sendTo = (mailOption) => new Promise((resolve, reject) => {\n    transporter.sendMail(mailOption, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n\n        resolve(info);\n    });\n});\n\nexport const sendReceiptMail = (customerName, customerEmail, marchantEmail, amount) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Your Receipt Is Ready',\n        text: `${customerName} made payment of ${amount}`,\n    };\n\n\n    try {\n        await Promise.all([\n            sendTo({ ...mailOption, to: customerEmail }),\n            sendTo({ ...mailOption, to: marchantEmail })\n        ]);\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendTransferMail = (customerEmail, marchantEmail) => new Promise((esolve, reject) => {\n\n});\n\nexport const sendDisputeMail = (marchantEmail, customerEmail, customerName, reason, disputeFrom, supportEmail = 'hello@pipepay.africa') => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Payment Dispute',\n    };\n\n    try {\n        if (disputeFrom !== 'marchant') {\n            await Promise.all([\n                sendTo({ ...mailOption, to: customerEmail,  text: 'Your dispute has been received, you will hear from our support rep soon.' }),\n                sendTo({ ...mailOption, to: marchantEmail, text: `New dispute from ${customerName} reason being that: \"${reason}\"` }),\n                sendTo({ ...mailOption, to: supportEmail, text: `New dispute from ${customerEmail} reason being that: \"${reason}\" marchant email is ${marchantEmail}` })\n            ]);\n        } else {\n            await Promise.all([\n                sendTo({ ...mailOption, to: customerEmail,  text: 'Your dispute has been received, you will hear from our support rep soon.' }),\n                sendTo({ ...mailOption, to: marchantEmail, text: `New dispute from ${customerName} reason being that: \"${reason}\"` }),\n                sendTo({ ...mailOption, to: supportEmail, text: `New dispute from ${marchantEmail} reason being that: \"${reason}\" customer email is ${customerEmail}` })\n            ]);\n        }\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendCustormerVerificationCode = (customerEmail, code) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Invoice Mail Verification',\n        text: `Your invoice verfication code is ${code}`\n    };\n\n    try {\n        await sendTo({ ...mailOption, to: customerEmail });\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"c2bfc4a951dac5a2d522e2999a86fcba9d30ced2"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.controller.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":11,"column":24},"end":{"line":103,"column":2}},"2":{"start":{"line":13,"column":18},"end":{"line":13,"column":38}},"3":{"start":{"line":15,"column":8},"end":{"line":19,"column":11}},"4":{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},"5":{"start":{"line":16,"column":21},"end":{"line":16,"column":123}},"6":{"start":{"line":17,"column":12},"end":{"line":17,"column":30}},"7":{"start":{"line":18,"column":12},"end":{"line":18,"column":19}},"8":{"start":{"line":22,"column":19},"end":{"line":22,"column":27}},"9":{"start":{"line":23,"column":27},"end":{"line":23,"column":38}},"10":{"start":{"line":24,"column":28},"end":{"line":24,"column":54}},"11":{"start":{"line":25,"column":28},"end":{"line":25,"column":54}},"12":{"start":{"line":26,"column":27},"end":{"line":26,"column":52}},"13":{"start":{"line":27,"column":18},"end":{"line":27,"column":34}},"14":{"start":{"line":29,"column":8},"end":{"line":29,"column":29}},"15":{"start":{"line":30,"column":8},"end":{"line":30,"column":29}},"16":{"start":{"line":31,"column":8},"end":{"line":70,"column":13}},"17":{"start":{"line":32,"column":23},"end":{"line":65,"column":15}},"18":{"start":{"line":33,"column":16},"end":{"line":64,"column":45}},"19":{"start":{"line":34,"column":20},"end":{"line":63,"column":21}},"20":{"start":{"line":35,"column":24},"end":{"line":62,"column":25}},"21":{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},"22":{"start":{"line":38,"column":36},"end":{"line":38,"column":54}},"23":{"start":{"line":39,"column":36},"end":{"line":39,"column":42}},"24":{"start":{"line":42,"column":32},"end":{"line":42,"column":159}},"25":{"start":{"line":45,"column":32},"end":{"line":45,"column":50}},"26":{"start":{"line":46,"column":32},"end":{"line":46,"column":50}},"27":{"start":{"line":47,"column":32},"end":{"line":47,"column":123}},"28":{"start":{"line":50,"column":32},"end":{"line":50,"column":71}},"29":{"start":{"line":51,"column":32},"end":{"line":51,"column":51}},"30":{"start":{"line":52,"column":32},"end":{"line":52,"column":38}},"31":{"start":{"line":55,"column":32},"end":{"line":55,"column":50}},"32":{"start":{"line":56,"column":32},"end":{"line":56,"column":67}},"33":{"start":{"line":57,"column":32},"end":{"line":57,"column":150}},"34":{"start":{"line":61,"column":32},"end":{"line":61,"column":55}},"35":{"start":{"line":67,"column":12},"end":{"line":69,"column":14}},"36":{"start":{"line":68,"column":16},"end":{"line":68,"column":51}},"37":{"start":{"line":73,"column":24},"end":{"line":73,"column":44}},"38":{"start":{"line":74,"column":8},"end":{"line":101,"column":13}},"39":{"start":{"line":75,"column":24},"end":{"line":96,"column":15}},"40":{"start":{"line":76,"column":16},"end":{"line":95,"column":36}},"41":{"start":{"line":77,"column":20},"end":{"line":94,"column":21}},"42":{"start":{"line":78,"column":24},"end":{"line":93,"column":25}},"43":{"start":{"line":80,"column":32},"end":{"line":83,"column":33}},"44":{"start":{"line":81,"column":36},"end":{"line":81,"column":55}},"45":{"start":{"line":82,"column":36},"end":{"line":82,"column":42}},"46":{"start":{"line":85,"column":32},"end":{"line":85,"column":144}},"47":{"start":{"line":88,"column":32},"end":{"line":88,"column":71}},"48":{"start":{"line":92,"column":32},"end":{"line":92,"column":56}},"49":{"start":{"line":98,"column":12},"end":{"line":100,"column":14}},"50":{"start":{"line":99,"column":16},"end":{"line":99,"column":52}}},"fnMap":{"0":{"name":"getInvoiceId","decl":{"start":{"line":12,"column":27},"end":{"line":12,"column":39}},"loc":{"start":{"line":12,"column":56},"end":{"line":20,"column":5}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":43},"end":{"line":15,"column":44}},"loc":{"start":{"line":15,"column":63},"end":{"line":19,"column":9}},"line":15},"2":{"name":"createOne","decl":{"start":{"line":21,"column":24},"end":{"line":21,"column":33}},"loc":{"start":{"line":21,"column":44},"end":{"line":71,"column":5}},"line":21},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":34},"end":{"line":31,"column":35}},"loc":{"start":{"line":31,"column":46},"end":{"line":70,"column":9}},"line":31},"4":{"name":"_callee","decl":{"start":{"line":32,"column":89},"end":{"line":32,"column":96}},"loc":{"start":{"line":32,"column":107},"end":{"line":65,"column":13}},"line":32},"5":{"name":"_callee$","decl":{"start":{"line":33,"column":57},"end":{"line":33,"column":65}},"loc":{"start":{"line":33,"column":76},"end":{"line":64,"column":17}},"line":33},"6":{"name":"(anonymous_6)","decl":{"start":{"line":67,"column":19},"end":{"line":67,"column":20}},"loc":{"start":{"line":67,"column":38},"end":{"line":69,"column":13}},"line":67},"7":{"name":"getOne","decl":{"start":{"line":72,"column":21},"end":{"line":72,"column":27}},"loc":{"start":{"line":72,"column":38},"end":{"line":102,"column":5}},"line":72},"8":{"name":"(anonymous_8)","decl":{"start":{"line":74,"column":55},"end":{"line":74,"column":56}},"loc":{"start":{"line":74,"column":67},"end":{"line":101,"column":9}},"line":74},"9":{"name":"_callee2","decl":{"start":{"line":75,"column":90},"end":{"line":75,"column":98}},"loc":{"start":{"line":75,"column":109},"end":{"line":96,"column":13}},"line":75},"10":{"name":"_callee2$","decl":{"start":{"line":76,"column":57},"end":{"line":76,"column":66}},"loc":{"start":{"line":76,"column":78},"end":{"line":95,"column":17}},"line":76},"11":{"name":"(anonymous_11)","decl":{"start":{"line":98,"column":19},"end":{"line":98,"column":20}},"loc":{"start":{"line":98,"column":39},"end":{"line":100,"column":13}},"line":98}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},"type":"if","locations":[{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},{"start":{"line":16,"column":12},"end":{"line":16,"column":123}}],"line":16},"1":{"loc":{"start":{"line":35,"column":24},"end":{"line":62,"column":25}},"type":"switch","locations":[{"start":{"line":36,"column":28},"end":{"line":42,"column":159}},{"start":{"line":44,"column":28},"end":{"line":47,"column":123}},{"start":{"line":49,"column":28},"end":{"line":52,"column":38}},{"start":{"line":54,"column":28},"end":{"line":57,"column":150}},{"start":{"line":59,"column":28},"end":{"line":59,"column":36}},{"start":{"line":60,"column":28},"end":{"line":61,"column":55}}],"line":35},"2":{"loc":{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},"type":"if","locations":[{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},{"start":{"line":37,"column":32},"end":{"line":40,"column":33}}],"line":37},"3":{"loc":{"start":{"line":78,"column":24},"end":{"line":93,"column":25}},"type":"switch","locations":[{"start":{"line":79,"column":28},"end":{"line":85,"column":144}},{"start":{"line":87,"column":28},"end":{"line":88,"column":71}},{"start":{"line":90,"column":28},"end":{"line":90,"column":35}},{"start":{"line":91,"column":28},"end":{"line":92,"column":56}}],"line":78},"4":{"loc":{"start":{"line":80,"column":32},"end":{"line":83,"column":33}},"type":"if","locations":[{"start":{"line":80,"column":32},"end":{"line":83,"column":33}},{"start":{"line":80,"column":32},"end":{"line":83,"column":33}}],"line":80}},"s":{"0":1,"1":1,"2":6,"3":6,"4":6,"5":0,"6":6,"7":6,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":2,"20":4,"21":1,"22":1,"23":1,"24":0,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":0,"32":0,"33":0,"34":1,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":2,"43":1,"44":1,"45":1,"46":0,"47":1,"48":1,"49":1,"50":1},"f":{"0":6,"1":6,"2":1,"3":1,"4":1,"5":2,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1},"b":{"0":[0,6],"1":[1,1,1,0,1,1],"2":[1,0],"3":[1,1,1,1],"4":[1,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.controller.js"],"names":["DisputeModel","InvoiceModel","generateController","sendDisputeMail","DisputeController","getInvoiceId","req","res","next","_id","params","invoiceId","findOne","err","doc","status","send","error","message","success","invoice","createOne","body","marchantEmail","customerEmail","customerName","create","reason","from","data","getOne"],"mappings":";;;;;AAAA,OAAOA,YAAP,MAAyB,iBAAzB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,kBAAP,MAA+B,kCAA/B;AACA,SAASC,eAAT,QAAgC,sBAAhC;;AAEA,IAAMC,oBAAoBF,mBAAmBF,YAAnB,EAAiC;AACvDK,kBAAc,sBAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9B,YAAMC,MAAMH,IAAII,MAAJ,CAAWC,SAAvB;;AAEAV,qBAAaW,OAAb,CAAqB,EAAEH,QAAF,EAArB,EAA8B,UAACI,GAAD,EAAMC,GAAN,EAAc;AACxC,gBAAID,GAAJ,EAAS,OAAON,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,gCAAX,EAAT,EAAwDC,SAAS,KAAjE,EAArB,CAAP;AACTb,gBAAIc,OAAJ,GAAcN,GAAd;AACAN;AACH,SAJD;AAKH,KATsD;AAUvDa,eAAW,mBAACf,GAAD,EAAMC,GAAN,EAAc;AACrB,YAAMe,OAAOhB,IAAIgB,IAAjB;AADqB,2BAEuChB,IAAIc,OAF3C;AAAA,YAEbG,aAFa,gBAEbA,aAFa;AAAA,YAEEC,aAFF,gBAEEA,aAFF;AAAA,YAEiBC,YAFjB,gBAEiBA,YAFjB;AAAA,YAE+BhB,GAF/B,gBAE+BA,GAF/B;;AAGrBa,aAAKP,MAAL,GAAc,MAAd;AACAO,aAAKX,SAAL,GAAiBF,GAAjB;AACAT,qBAAa0B,MAAb,CAAoBJ,IAApB;AAAA,gFAA0B,iBAAOT,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,qCAClBD,GADkB;AAAA;AAAA;AAAA;;AAAA,iEACNN,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,8BAAX,EAAT,EAAsDC,SAAS,KAA/D,EAArB,CADM;;AAAA;AAAA;AAAA;AAAA,uCAIZhB,gBAAgBoB,aAAhB,EAA+BC,aAA/B,EAA8CC,YAA9C,EAA4DH,KAAKK,MAAjE,EAAyEL,KAAKM,IAA9E,CAJY;;AAAA;AAKlBrB,oCAAIS,IAAJ,CAAS,EAAEa,MAAMf,GAAR,EAAaK,SAAS,IAAtB,EAAT;AALkB;AAAA;;AAAA;AAAA;AAAA;AAAA,iEAOXZ,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,qBAAX,EAAT,EAA6CC,SAAS,KAAtD,EAArB,CAPW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAA1B;;AAAA;AAAA;AAAA;AAAA;AAUH,KAzBsD;AA0BvDW,YAAQ,gBAACxB,GAAD,EAAMC,GAAN,EAAc;AAClB,YAAMI,YAAYL,IAAII,MAAJ,CAAWC,SAA7B;AACAX,qBAAaY,OAAb,CAAqB,EAAED,oBAAF,EAArB;AAAA,iFAAoC,kBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,qCAC5BD,GAD4B;AAAA;AAAA;AAAA;;AAAA,kEAChBN,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,cAAX,EAAT,EAAsCC,SAAS,KAA/C,EAArB,CADgB;;AAAA;AAEhCZ,oCAAIS,IAAJ,CAAS,EAAEa,MAAMf,GAAR,EAAaK,SAAS,IAAtB,EAAT;;AAFgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAApC;;AAAA;AAAA;AAAA;AAAA;AAIH;AAhCsD,CAAjC,CAA1B;;AAmCA,eAAef,iBAAf","file":"dispute.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import DisputeModel from './dispute.model';\nimport InvoiceModel from '../invoice/invoice.model';\nimport generateController from '../../modules/generateController';\nimport { sendDisputeMail } from '../../modules/mailer';\n\nconst DisputeController = generateController(DisputeModel, {\n    getInvoiceId: (req, res, next) => {\n        const _id = req.params.invoiceId;\n\n        InvoiceModel.findOne({ _id }, (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Invoice with id does not exits' }, success: false });\n            req.invoice = doc;\n            next()\n        });\n    },\n    createOne: (req, res) => {\n        const body = req.body;\n        const { marchantEmail, customerEmail, customerName, _id } = req.invoice;\n        body.status = \"open\";\n        body.invoiceId = _id;\n        DisputeModel.create(body, async (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Could not create the dispute' }, success: false });\n\n            try {\n                await sendDisputeMail(marchantEmail, customerEmail, customerName, body.reason, body.from);\n                res.send({ data: doc, success: true });\n            } catch (err) {\n                return res.status(400).send({ error: { message: 'Could not send mail' }, success: false });\n            }\n        });\n    },\n    getOne: (req, res) => {\n        const invoiceId = req.params.invoiceId;\n        DisputeModel.findOne({ invoiceId }, async (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Find dispute' }, success: false });\n            res.send({ data: doc, success: true });\n        });\n    }\n});\n\nexport default DisputeController;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"a9bd1131caf8e1ac1905da55b3cbb9d278c1f65f"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/verify/verify.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/verify/verify.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":10,"column":13},"end":{"line":10,"column":29}},"2":{"start":{"line":12,"column":0},"end":{"line":12,"column":58}},"3":{"start":{"line":14,"column":0},"end":{"line":49,"column":5}},"4":{"start":{"line":15,"column":15},"end":{"line":44,"column":7}},"5":{"start":{"line":18,"column":8},"end":{"line":43,"column":37}},"6":{"start":{"line":19,"column":12},"end":{"line":42,"column":13}},"7":{"start":{"line":20,"column":16},"end":{"line":41,"column":17}},"8":{"start":{"line":22,"column":24},"end":{"line":22,"column":133}},"9":{"start":{"line":23,"column":24},"end":{"line":23,"column":42}},"10":{"start":{"line":24,"column":24},"end":{"line":24,"column":42}},"11":{"start":{"line":25,"column":24},"end":{"line":25,"column":88}},"12":{"start":{"line":28,"column":24},"end":{"line":28,"column":52}},"13":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"14":{"start":{"line":30,"column":24},"end":{"line":30,"column":30}},"15":{"start":{"line":33,"column":24},"end":{"line":33,"column":42}},"16":{"start":{"line":34,"column":24},"end":{"line":34,"column":59}},"17":{"start":{"line":36,"column":24},"end":{"line":36,"column":84}},"18":{"start":{"line":40,"column":24},"end":{"line":40,"column":47}},"19":{"start":{"line":46,"column":4},"end":{"line":48,"column":6}},"20":{"start":{"line":47,"column":8},"end":{"line":47,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":32},"end":{"line":14,"column":33}},"loc":{"start":{"line":14,"column":44},"end":{"line":49,"column":1}},"line":14},"1":{"name":"_callee","decl":{"start":{"line":15,"column":81},"end":{"line":15,"column":88}},"loc":{"start":{"line":15,"column":99},"end":{"line":44,"column":5}},"line":15},"2":{"name":"_callee$","decl":{"start":{"line":18,"column":49},"end":{"line":18,"column":57}},"loc":{"start":{"line":18,"column":68},"end":{"line":43,"column":9}},"line":18},"3":{"name":"(anonymous_3)","decl":{"start":{"line":46,"column":11},"end":{"line":46,"column":12}},"loc":{"start":{"line":46,"column":30},"end":{"line":48,"column":5}},"line":46}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":16},"end":{"line":41,"column":17}},"type":"switch","locations":[{"start":{"line":21,"column":20},"end":{"line":25,"column":88}},{"start":{"line":27,"column":20},"end":{"line":30,"column":30}},{"start":{"line":32,"column":20},"end":{"line":36,"column":84}},{"start":{"line":38,"column":20},"end":{"line":38,"column":28}},{"start":{"line":39,"column":20},"end":{"line":40,"column":47}}],"line":20}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":2,"7":3,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":1,"19":1,"20":1},"f":{"0":1,"1":1,"2":2,"3":1},"b":{"0":[1,1,0,1,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/verify/verify.route.js"],"names":["express","DisputeController","sendCustormerVerificationCode","Router","param","getInvoiceId","route","get","req","res","invoice","customerEmail","verifyCode","send","success","status","error"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,+BAA9B;AACA,SAASC,6BAAT,QAA8C,sBAA9C;;AAEA,IAAMC,SAASH,QAAQG,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,WAAb,EAA0BH,kBAAkBI,YAA5C;;AAEAF,OAAOG,KAAP,CAAa,aAAb,EACKC,GADL;AAAA,wEACS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uCACqCD,IAAIE,OADzC,EACOC,aADP,gBACOA,aADP,EACsBC,UADtB,gBACsBA,UADtB;AAAA;AAAA;AAAA,+BAISV,8BAA8BS,aAA9B,EAA6CC,UAA7C,CAJT;;AAAA;AAKGH,4BAAII,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAT;AALH;AAAA;;AAAA;AAAA;AAAA;;AAOGL,4BAAIM,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB,EAAEE,QAAQ,KAAV,EAAiBC,kBAAjB,EAArB;;AAPH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAYA,eAAeb,MAAf","file":"verify.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport DisputeController from '../dispute/dispute.controller';\nimport { sendCustormerVerificationCode } from '../../modules/mailer';\n\nconst Router = express.Router();\n\nRouter.param('invoiceId', DisputeController.getInvoiceId);\n\nRouter.route('/:invoiceId')\n    .get(async (req, res) => {\n        const { customerEmail, verifyCode } = req.invoice;\n\n        try {\n            await sendCustormerVerificationCode(customerEmail, verifyCode);\n            res.send({ success: true });\n        } catch (error) {\n            res.status(400).send({ status: false, error });\n        }\n    });\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"3e3ed174ba3cd9b8a308e49b5f7e7635103460b0"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/recode.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/recode.js","statementMap":{"0":{"start":{"line":1,"column":18},"end":{"line":3,"column":1}},"1":{"start":{"line":2,"column":2},"end":{"line":2,"column":87}},"2":{"start":{"line":4,"column":16},"end":{"line":6,"column":1}},"3":{"start":{"line":5,"column":2},"end":{"line":5,"column":39}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":102}}},"fnMap":{"0":{"name":"randomAlpha","decl":{"start":{"line":1,"column":27},"end":{"line":1,"column":38}},"loc":{"start":{"line":1,"column":41},"end":{"line":3,"column":1}},"line":1},"1":{"name":"randomNum","decl":{"start":{"line":4,"column":25},"end":{"line":4,"column":34}},"loc":{"start":{"line":4,"column":37},"end":{"line":6,"column":1}},"line":4},"2":{"name":"(anonymous_2)","decl":{"start":{"line":7,"column":16},"end":{"line":7,"column":17}},"loc":{"start":{"line":7,"column":28},"end":{"line":9,"column":1}},"line":7}},"branchMap":{},"s":{"0":1,"1":0,"2":1,"3":0,"4":0},"f":{"0":0,"1":0,"2":0},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/modules/recode.js"],"names":["randomAlpha","charAt","Math","floor","random","alpha","length","randomNum"],"mappings":"AAAA,IAAMA,cAAc,SAAdA,WAAc;AAAA,SAAM,6BAA6BC,MAA7B,CAAoCC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgBC,MAAMC,MAAjC,CAApC,CAAN;AAAA,CAApB;AACA,IAAMC,YAAY,SAAZA,SAAY;AAAA,SAAML,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,CAA3B,CAAN;AAAA,CAAlB;AACA,gBAAe;AAAA,cAASJ,aAAT,GAAyBO,WAAzB,GAAuCP,aAAvC,GAAuDO,WAAvD,GAAqEP,aAArE,GAAqFO,WAArF;AAAA,CAAf","file":"recode.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["const randomAlpha = () => 'abcdefghijklmnopqrstuvwxyz'.charAt(Math.floor(Math.random() * alpha.length));\nconst randomNum = () => Math.floor(Math.random() * 9);\nexport default () => `${randomAlpha()}${randomNum()}${randomAlpha()}${randomNum()}${randomAlpha()}${randomNum()}`;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"9f2ba0b9f8dad86a1094729d38b396d3f758d723"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/invoice.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/invoice.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":9,"column":13},"end":{"line":9,"column":40}},"2":{"start":{"line":11,"column":21},"end":{"line":27,"column":1}},"3":{"start":{"line":12,"column":15},"end":{"line":12,"column":24}},"4":{"start":{"line":13,"column":16},"end":{"line":13,"column":26}},"5":{"start":{"line":14,"column":16},"end":{"line":14,"column":26}},"6":{"start":{"line":15,"column":4},"end":{"line":26,"column":7}},"7":{"start":{"line":16,"column":8},"end":{"line":25,"column":11}},"8":{"start":{"line":21,"column":23},"end":{"line":21,"column":33}},"9":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"10":{"start":{"line":23,"column":21},"end":{"line":23,"column":33}},"11":{"start":{"line":24,"column":12},"end":{"line":24,"column":26}},"12":{"start":{"line":29,"column":27},"end":{"line":71,"column":1}},"13":{"start":{"line":30,"column":4},"end":{"line":70,"column":9}},"14":{"start":{"line":31,"column":20},"end":{"line":65,"column":11}},"15":{"start":{"line":34,"column":12},"end":{"line":64,"column":31}},"16":{"start":{"line":35,"column":16},"end":{"line":63,"column":17}},"17":{"start":{"line":36,"column":20},"end":{"line":62,"column":21}},"18":{"start":{"line":38,"column":28},"end":{"line":38,"column":46}},"19":{"start":{"line":39,"column":28},"end":{"line":39,"column":60}},"20":{"start":{"line":42,"column":28},"end":{"line":42,"column":50}},"21":{"start":{"line":43,"column":28},"end":{"line":43,"column":69}},"22":{"start":{"line":44,"column":28},"end":{"line":44,"column":62}},"23":{"start":{"line":47,"column":28},"end":{"line":57,"column":31}},"24":{"start":{"line":53,"column":43},"end":{"line":53,"column":53}},"25":{"start":{"line":55,"column":32},"end":{"line":55,"column":53}},"26":{"start":{"line":55,"column":41},"end":{"line":55,"column":53}},"27":{"start":{"line":56,"column":32},"end":{"line":56,"column":46}},"28":{"start":{"line":61,"column":28},"end":{"line":61,"column":51}},"29":{"start":{"line":67,"column":8},"end":{"line":69,"column":10}},"30":{"start":{"line":68,"column":12},"end":{"line":68,"column":48}}},"fnMap":{"0":{"name":"CreateCustomer","decl":{"start":{"line":11,"column":30},"end":{"line":11,"column":44}},"loc":{"start":{"line":11,"column":51},"end":{"line":27,"column":1}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":24},"end":{"line":15,"column":25}},"loc":{"start":{"line":15,"column":51},"end":{"line":26,"column":5}},"line":15},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":15},"end":{"line":20,"column":16}},"loc":{"start":{"line":20,"column":37},"end":{"line":25,"column":9}},"line":20},"3":{"name":"CreateInvoice","decl":{"start":{"line":29,"column":36},"end":{"line":29,"column":49}},"loc":{"start":{"line":29,"column":81},"end":{"line":71,"column":1}},"line":29},"4":{"name":"(anonymous_4)","decl":{"start":{"line":30,"column":24},"end":{"line":30,"column":25}},"loc":{"start":{"line":30,"column":36},"end":{"line":70,"column":5}},"line":30},"5":{"name":"_callee","decl":{"start":{"line":31,"column":86},"end":{"line":31,"column":93}},"loc":{"start":{"line":31,"column":111},"end":{"line":65,"column":9}},"line":31},"6":{"name":"_callee$","decl":{"start":{"line":34,"column":53},"end":{"line":34,"column":61}},"loc":{"start":{"line":34,"column":72},"end":{"line":64,"column":13}},"line":34},"7":{"name":"(anonymous_7)","decl":{"start":{"line":52,"column":35},"end":{"line":52,"column":36}},"loc":{"start":{"line":52,"column":57},"end":{"line":57,"column":29}},"line":52},"8":{"name":"(anonymous_8)","decl":{"start":{"line":67,"column":15},"end":{"line":67,"column":16}},"loc":{"start":{"line":67,"column":34},"end":{"line":69,"column":9}},"line":67}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"type":"if","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},{"start":{"line":23,"column":12},"end":{"line":23,"column":33}}],"line":23},"1":{"loc":{"start":{"line":36,"column":20},"end":{"line":62,"column":21}},"type":"switch","locations":[{"start":{"line":37,"column":24},"end":{"line":39,"column":60}},{"start":{"line":41,"column":24},"end":{"line":57,"column":31}},{"start":{"line":59,"column":24},"end":{"line":59,"column":31}},{"start":{"line":60,"column":24},"end":{"line":61,"column":51}}],"line":36},"2":{"loc":{"start":{"line":55,"column":32},"end":{"line":55,"column":53}},"type":"if","locations":[{"start":{"line":55,"column":32},"end":{"line":55,"column":53}},{"start":{"line":55,"column":32},"end":{"line":55,"column":53}}],"line":55}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":1,"12":1,"13":1,"14":1,"15":1,"16":2,"17":2,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":1,"28":1,"29":1,"30":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":2,"7":1,"8":1},"b":{"0":[0,1],"1":[1,1,1,1],"2":[0,1]},"inputSourceMap":{"version":3,"sources":["src/api/modules/invoice.js"],"names":["request","addDays","secret","process","env","PAYSTACK_SECRET","CreateCustomer","name","email","phone","resolve","reject","post","set","send","end","err","body","CreateInvoice","customer","amount","description","customer_code","data","due_date","Date"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;;AAEA,IAAMC,iBAAiB,SAAjBA,cAAiB;AAAA,QAAGC,IAAH,QAAGA,IAAH;AAAA,QAASC,KAAT,QAASA,KAAT;AAAA,QAAgBC,KAAhB,QAAgBA,KAAhB;AAAA,WAA4B,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAChFX,gBACKY,IADL,qCAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACFP,sBADE;AAEFC,wBAFE;AAGFC;AAHE,SAHV,EAQKM,GARL,CAQS,UAACC,GAAD,SAAmB;AAAA,gBAAXC,IAAW,SAAXA,IAAW;;AACpB,gBAAID,GAAJ,EAASL,OAAOK,GAAP;AACTN,oBAAQO,IAAR;AACH,SAXL;AAYH,KAbkD,CAA5B;AAAA,CAAvB;;AAeA,OAAO,IAAMC,gBAAgB,SAAhBA,aAAgB,CAACC,QAAD,EAAWC,MAAX,EAAmBC,WAAnB;AAAA,WAAmC;AAAA,6EAAY,iBAAOX,OAAP,EAAgBC,MAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAC9BL,eAAea,QAAf,CAD8B;;AAAA;AAAA;AACxDG,yCADwD,SAChEC,IADgE,CACxDD,aADwD;AAElEE,oCAFkE,GAEvDvB,QAAQ,IAAIwB,IAAJ,EAAR,EAAoB,CAApB,CAFuD;;;AAIxEzB,oCACKY,IADL,2CAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACFK,0CAAUG,aADR;AAEFD,wDAFE;AAGFD,8CAHE;AAIFI;AAJE,6BAHV,EASKT,GATL,CASS,UAACC,GAAD,SAAmB;AAAA,oCAAXC,IAAW,SAAXA,IAAW;;AACpB,oCAAID,GAAJ,EAASL,OAAOK,GAAP;AACTN,wCAAQO,IAAR;AACH,6BAZL;;AAJwE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAZ;;AAAA;AAAA;AAAA;AAAA,QAAnC;AAAA,CAAtB","file":"invoice.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nimport addDays from 'date-fns/add_days';\nconst secret = process.env.PAYSTACK_SECRET;\n\nconst CreateCustomer = ({ name, email, phone }) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/customer`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            name,\n            email,\n            phone\n        })\n        .end((err, { body }) => {\n            if (err) reject(err);\n            resolve(body);\n        });\n});\n\nexport const CreateInvoice = (customer, amount, description) => new Promise(async (resolve, reject) => {\n    const { data: { customer_code } } = await CreateCustomer(customer);\n    const due_date = addDays(new Date(), 7);\n\n    request\n        .post(`https://api.paystack.co/paymentrequest`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            customer: customer_code,\n            description,\n            amount,\n            due_date\n        })\n        .end((err, { body }) => {\n            if (err) reject(err);\n            resolve(body);\n        });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"e60950118f3c34c1bd8af58155b3e72382fce508"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.controller.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":14,"column":19},"end":{"line":83,"column":11}},"2":{"start":{"line":17,"column":12},"end":{"line":82,"column":43}},"3":{"start":{"line":18,"column":16},"end":{"line":81,"column":17}},"4":{"start":{"line":19,"column":20},"end":{"line":80,"column":21}},"5":{"start":{"line":21,"column":28},"end":{"line":21,"column":44}},"6":{"start":{"line":23,"column":28},"end":{"line":23,"column":54}},"7":{"start":{"line":24,"column":28},"end":{"line":24,"column":64}},"8":{"start":{"line":25,"column":28},"end":{"line":25,"column":49}},"9":{"start":{"line":26,"column":28},"end":{"line":26,"column":105}},"10":{"start":{"line":27,"column":28},"end":{"line":27,"column":150}},"11":{"start":{"line":29,"column":28},"end":{"line":29,"column":47}},"12":{"start":{"line":30,"column":28},"end":{"line":30,"column":47}},"13":{"start":{"line":31,"column":28},"end":{"line":31,"column":167}},"14":{"start":{"line":34,"column":28},"end":{"line":34,"column":51}},"15":{"start":{"line":35,"column":28},"end":{"line":35,"column":67}},"16":{"start":{"line":38,"column":28},"end":{"line":38,"column":61}},"17":{"start":{"line":40,"column":28},"end":{"line":68,"column":33}},"18":{"start":{"line":41,"column":44},"end":{"line":63,"column":35}},"19":{"start":{"line":42,"column":36},"end":{"line":62,"column":55}},"20":{"start":{"line":43,"column":40},"end":{"line":61,"column":41}},"21":{"start":{"line":44,"column":44},"end":{"line":60,"column":45}},"22":{"start":{"line":46,"column":52},"end":{"line":49,"column":53}},"23":{"start":{"line":47,"column":56},"end":{"line":47,"column":74}},"24":{"start":{"line":48,"column":56},"end":{"line":48,"column":62}},"25":{"start":{"line":51,"column":52},"end":{"line":51,"column":179}},"26":{"start":{"line":54,"column":52},"end":{"line":54,"column":74}},"27":{"start":{"line":55,"column":52},"end":{"line":55,"column":91}},"28":{"start":{"line":59,"column":52},"end":{"line":59,"column":75}},"29":{"start":{"line":65,"column":32},"end":{"line":67,"column":34}},"30":{"start":{"line":66,"column":36},"end":{"line":66,"column":72}},"31":{"start":{"line":69,"column":28},"end":{"line":69,"column":48}},"32":{"start":{"line":70,"column":28},"end":{"line":70,"column":34}},"33":{"start":{"line":73,"column":28},"end":{"line":73,"column":48}},"34":{"start":{"line":74,"column":28},"end":{"line":74,"column":65}},"35":{"start":{"line":75,"column":28},"end":{"line":75,"column":123}},"36":{"start":{"line":79,"column":28},"end":{"line":79,"column":52}},"37":{"start":{"line":85,"column":8},"end":{"line":87,"column":10}},"38":{"start":{"line":86,"column":12},"end":{"line":86,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":13,"column":15},"end":{"line":13,"column":16}},"loc":{"start":{"line":13,"column":27},"end":{"line":88,"column":5}},"line":13},"1":{"name":"_callee2","decl":{"start":{"line":14,"column":85},"end":{"line":14,"column":93}},"loc":{"start":{"line":14,"column":104},"end":{"line":83,"column":9}},"line":14},"2":{"name":"_callee2$","decl":{"start":{"line":17,"column":53},"end":{"line":17,"column":62}},"loc":{"start":{"line":17,"column":74},"end":{"line":82,"column":13}},"line":17},"3":{"name":"(anonymous_3)","decl":{"start":{"line":40,"column":54},"end":{"line":40,"column":55}},"loc":{"start":{"line":40,"column":66},"end":{"line":68,"column":29}},"line":40},"4":{"name":"_callee","decl":{"start":{"line":41,"column":110},"end":{"line":41,"column":117}},"loc":{"start":{"line":41,"column":128},"end":{"line":63,"column":33}},"line":41},"5":{"name":"_callee$","decl":{"start":{"line":42,"column":77},"end":{"line":42,"column":85}},"loc":{"start":{"line":42,"column":96},"end":{"line":62,"column":37}},"line":42},"6":{"name":"(anonymous_6)","decl":{"start":{"line":65,"column":39},"end":{"line":65,"column":40}},"loc":{"start":{"line":65,"column":59},"end":{"line":67,"column":33}},"line":65},"7":{"name":"createOne","decl":{"start":{"line":85,"column":24},"end":{"line":85,"column":33}},"loc":{"start":{"line":85,"column":43},"end":{"line":87,"column":9}},"line":85}},"branchMap":{"0":{"loc":{"start":{"line":19,"column":20},"end":{"line":80,"column":21}},"type":"switch","locations":[{"start":{"line":20,"column":24},"end":{"line":31,"column":167}},{"start":{"line":33,"column":24},"end":{"line":70,"column":34}},{"start":{"line":72,"column":24},"end":{"line":75,"column":123}},{"start":{"line":77,"column":24},"end":{"line":77,"column":32}},{"start":{"line":78,"column":24},"end":{"line":79,"column":52}}],"line":19},"1":{"loc":{"start":{"line":26,"column":46},"end":{"line":26,"column":104}},"type":"cond-expr","locations":[{"start":{"line":26,"column":83},"end":{"line":26,"column":93}},{"start":{"line":26,"column":96},"end":{"line":26,"column":104}}],"line":26},"2":{"loc":{"start":{"line":44,"column":44},"end":{"line":60,"column":45}},"type":"switch","locations":[{"start":{"line":45,"column":48},"end":{"line":51,"column":179}},{"start":{"line":53,"column":48},"end":{"line":55,"column":91}},{"start":{"line":57,"column":48},"end":{"line":57,"column":55}},{"start":{"line":58,"column":48},"end":{"line":59,"column":75}}],"line":44},"3":{"loc":{"start":{"line":46,"column":52},"end":{"line":49,"column":53}},"type":"if","locations":[{"start":{"line":46,"column":52},"end":{"line":49,"column":53}},{"start":{"line":46,"column":52},"end":{"line":49,"column":53}}],"line":46}},"s":{"0":1,"1":1,"2":1,"3":2,"4":3,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":2,"22":1,"23":1,"24":1,"25":0,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":1,"37":1,"38":1},"f":{"0":1,"1":1,"2":2,"3":1,"4":1,"5":1,"6":1,"7":1},"b":{"0":[1,1,0,1,1],"1":[1,0],"2":[1,1,1,1],"3":[1,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.controller.js"],"names":["InvoiceModel","mailer","recode","generateController","CreateInvoice","createOne","req","res","body","userId","user","id","marchantEmail","email","status","verifyCode","process","env","NODE_ENV","totalPrice","purchaseAmount","deliveryAmount","customerEmail","name","customerName","phone","customerPhone","description","request_code","data","invoice_code","create","err","doc","send","error","message","success"],"mappings":";;;;;AAAA,OAAOA,YAAP,MAAyB,iBAAzB;AACA,OAAO,KAAKC,MAAZ,MAAwB,sBAAxB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,kBAAP,MAA+B,kCAA/B;AACA,SAASC,aAAT,QAA8B,uBAA9B;;AAEA,eAAeD,mBAAmBH,YAAnB,EAAiC;AAC5CK;AAAA,4EAAW,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AACHC,gCADG,GACIF,IAAIE,IADR;;AAEPA,iCAAKC,MAAL,GAAcH,IAAII,IAAJ,CAASC,EAAvB;AACAH,iCAAKI,aAAL,GAAqBN,IAAII,IAAJ,CAASG,KAA9B;AACAL,iCAAKM,MAAL,GAAc,MAAd;AACAN,iCAAKO,UAAL,GAAkBC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,SAAzB,GAAqC,UAArC,GAAkDhB,QAApE;AACAM,iCAAKW,UAAL,GAAmB,MAAM,GAAP,GAAeX,KAAKY,cAAL,GAAsB,GAArC,GAA6CZ,KAAKa,cAAL,GAAsB,GAAnE,GAA6Eb,KAAKY,cAAL,GAAsB,CAAvB,GAA4B,GAA7B,GAAoC,GAAjI;;AANO;AAAA;AAAA,mCASuChB,cAAc,EAAES,OAAOL,KAAKc,aAAd,EAA6BC,MAAMf,KAAKgB,YAAxC,EAAsDC,OAAOjB,KAAKkB,aAAlE,EAAd,EAAiGlB,KAAKW,UAAtG,EAAkHX,KAAKmB,WAAvH,CATvC;;AAAA;AAAA;AASaC,wCATb,SASKC,IATL,CASaD,YATb;;;AAWHpB,iCAAKsB,YAAL,GAAoBF,YAApB;;AAEA5B,yCAAa+B,MAAb,CAAoBvB,IAApB;AAAA,qGAA0B,iBAAOwB,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,yDAClBD,GADkB;AAAA;AAAA;AAAA;;AAAA,qFACNzB,IAAIO,MAAJ,CAAW,GAAX,EAAgBoB,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,8BAAX,EAAT,EAAsDC,SAAS,KAA/D,EAArB,CADM;;AAAA;AAEtB,2DAAOJ,IAAIlB,UAAX;AACAR,wDAAI2B,IAAJ,CAAS,EAAEL,MAAMI,GAAR,EAAaI,SAAS,IAAtB,EAAT;;AAHsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iCAA1B;;AAAA;AAAA;AAAA;AAAA;AAbG;AAAA;;AAAA;AAAA;AAAA;AAAA,8DAmBI9B,IAAIO,MAAJ,CAAW,GAAX,EAAgBoB,IAAhB,CAAqB,EAAEF,iBAAF,EAAOK,SAAS,KAAhB,EAArB,CAnBJ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAX;;AAAA;AAAA;AAAA;AAAA;AAD4C,CAAjC,CAAf","file":"invoice.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import InvoiceModel from './invoice.model';\nimport * as mailer from '../../modules/mailer';\nimport recode from '../../modules/recode';\nimport generateController from '../../modules/generateController';\nimport { CreateInvoice } from '../../modules/invoice';\n\nexport default generateController(InvoiceModel, {\n    createOne: async (req, res) => {\n        var body = req.body;\n        body.userId = req.user.id;\n        body.marchantEmail = req.user.email;\n        body.status = \"sent\";\n        body.verifyCode = process.env.NODE_ENV === 'testing' ? 'AXYZ0000' : recode();\n        body.totalPrice = (200 * 100) + (body.purchaseAmount * 100) + (body.deliveryAmount * 100) + (((body.purchaseAmount * 5) / 100) * 100);\n\n        try {\n            const { data: { request_code } }  = await CreateInvoice({ email: body.customerEmail, name: body.customerName, phone: body.customerPhone }, body.totalPrice, body.description);\n            \n            body.invoice_code = request_code;\n\n            InvoiceModel.create(body, async (err, doc) => {\n                if (err) return res.status(400).send({ error: { message: 'Could not create the invoice' }, success: false });\n                delete doc.verifyCode;\n                res.send({ data: doc, success: true });\n            });\n        } catch(err) {\n            return res.status(400).send({ err, success: false });\n        }\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"aacae840d3b13f663030417b154093a03f74eb3e"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.route.js","statementMap":{"0":{"start":{"line":4,"column":20},"end":{"line":4,"column":36}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":57}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":59}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":94}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.route.js"],"names":["express","InvoiceController","InvoiceRouter","Router","param","findByParam","route","post","createOne","get","getOne","delete","deleteOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;;AAEA,IAAMC,gBAAgBF,QAAQG,MAAR,EAAtB;;AAEAD,cAAcE,KAAd,CAAoB,IAApB,EAA0BH,kBAAkBI,WAA5C;;AAEAH,cAAcI,KAAd,CAAoB,GAApB,EACKC,IADL,CACUN,kBAAkBO,SAD5B;;AAGAN,cAAcI,KAAd,CAAoB,MAApB,EACKG,GADL,CACSR,kBAAkBS,MAD3B,EAEKC,MAFL,CAEYV,kBAAkBW,SAF9B;;AAIA,eAAeV,aAAf","file":"invoice.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport InvoiceController from './invoice.controller';\n\nconst InvoiceRouter = express.Router();\n\nInvoiceRouter.param('id', InvoiceController.findByParam);\n\nInvoiceRouter.route('/')\n    .post(InvoiceController.createOne);\n\nInvoiceRouter.route('/:id')\n    .get(InvoiceController.getOne)\n    .delete(InvoiceController.deleteOne);\n\nexport default InvoiceRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"973b2e6590768c65707300b1a223369f43b7fa35"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":9,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.model.js"],"names":["mongoose","PaymentSchema","Schema","marchantEmail","String","customerEmail","amount","Number","invoiceId","reference","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,mBAAeC,MADuB;AAEtCC,mBAAeD,MAFuB;AAGtCE,YAAQC,MAH8B;AAItCC,eAAWJ,MAJ2B;AAKtCK,eAAWL;AAL2B,CAApB,CAAtB;;AAQA,eAAeJ,SAASU,KAAT,CAAe,SAAf,EAA0BT,aAA1B,CAAf","file":"payment.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst PaymentSchema = new mongoose.Schema({\n    marchantEmail: String,\n    customerEmail: String,\n    amount: Number,\n    invoiceId: String,\n    reference: String\n});\n\nexport default mongoose.model('Payment', PaymentSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"9e15a13fd93cf962a8c5c8090d8e6bb47055ee25"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/transfer.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/transfer.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":8,"column":13},"end":{"line":8,"column":40}},"2":{"start":{"line":10,"column":17},"end":{"line":25,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":24,"column":7}},"4":{"start":{"line":12,"column":8},"end":{"line":23,"column":11}},"5":{"start":{"line":19,"column":23},"end":{"line":19,"column":32}},"6":{"start":{"line":21,"column":12},"end":{"line":21,"column":33}},"7":{"start":{"line":21,"column":21},"end":{"line":21,"column":33}},"8":{"start":{"line":22,"column":12},"end":{"line":22,"column":26}},"9":{"start":{"line":27,"column":19},"end":{"line":41,"column":1}},"10":{"start":{"line":28,"column":4},"end":{"line":40,"column":7}},"11":{"start":{"line":29,"column":8},"end":{"line":39,"column":11}},"12":{"start":{"line":35,"column":23},"end":{"line":35,"column":33}},"13":{"start":{"line":37,"column":12},"end":{"line":37,"column":33}},"14":{"start":{"line":37,"column":21},"end":{"line":37,"column":33}},"15":{"start":{"line":38,"column":12},"end":{"line":38,"column":26}},"16":{"start":{"line":43,"column":15},"end":{"line":102,"column":1}},"17":{"start":{"line":44,"column":4},"end":{"line":101,"column":9}},"18":{"start":{"line":45,"column":20},"end":{"line":96,"column":11}},"19":{"start":{"line":48,"column":12},"end":{"line":95,"column":42}},"20":{"start":{"line":49,"column":16},"end":{"line":94,"column":17}},"21":{"start":{"line":50,"column":20},"end":{"line":93,"column":21}},"22":{"start":{"line":52,"column":28},"end":{"line":52,"column":46}},"23":{"start":{"line":53,"column":28},"end":{"line":53,"column":46}},"24":{"start":{"line":54,"column":28},"end":{"line":54,"column":79}},"25":{"start":{"line":57,"column":28},"end":{"line":57,"column":50}},"26":{"start":{"line":58,"column":28},"end":{"line":58,"column":50}},"27":{"start":{"line":59,"column":28},"end":{"line":59,"column":71}},"28":{"start":{"line":61,"column":28},"end":{"line":64,"column":29}},"29":{"start":{"line":62,"column":32},"end":{"line":62,"column":51}},"30":{"start":{"line":63,"column":32},"end":{"line":63,"column":38}},"31":{"start":{"line":66,"column":28},"end":{"line":66,"column":46}},"32":{"start":{"line":67,"column":28},"end":{"line":67,"column":72}},"33":{"start":{"line":70,"column":28},"end":{"line":70,"column":50}},"34":{"start":{"line":71,"column":28},"end":{"line":71,"column":51}},"35":{"start":{"line":73,"column":28},"end":{"line":73,"column":51}},"36":{"start":{"line":73,"column":41},"end":{"line":73,"column":51}},"37":{"start":{"line":74,"column":28},"end":{"line":74,"column":47}},"38":{"start":{"line":75,"column":28},"end":{"line":75,"column":34}},"39":{"start":{"line":78,"column":28},"end":{"line":78,"column":67}},"40":{"start":{"line":81,"column":28},"end":{"line":81,"column":47}},"41":{"start":{"line":82,"column":28},"end":{"line":82,"column":34}},"42":{"start":{"line":85,"column":28},"end":{"line":85,"column":47}},"43":{"start":{"line":86,"column":28},"end":{"line":86,"column":63}},"44":{"start":{"line":88,"column":28},"end":{"line":88,"column":48}},"45":{"start":{"line":92,"column":28},"end":{"line":92,"column":51}},"46":{"start":{"line":98,"column":8},"end":{"line":100,"column":10}},"47":{"start":{"line":99,"column":12},"end":{"line":99,"column":48}}},"fnMap":{"0":{"name":"getReceipt","decl":{"start":{"line":10,"column":26},"end":{"line":10,"column":36}},"loc":{"start":{"line":10,"column":70},"end":{"line":25,"column":1}},"line":10},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":24},"end":{"line":11,"column":25}},"loc":{"start":{"line":11,"column":51},"end":{"line":24,"column":5}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":18,"column":15},"end":{"line":18,"column":16}},"loc":{"start":{"line":18,"column":36},"end":{"line":23,"column":9}},"line":18},"3":{"name":"makeTransfer","decl":{"start":{"line":27,"column":28},"end":{"line":27,"column":40}},"loc":{"start":{"line":27,"column":65},"end":{"line":41,"column":1}},"line":27},"4":{"name":"(anonymous_4)","decl":{"start":{"line":28,"column":24},"end":{"line":28,"column":25}},"loc":{"start":{"line":28,"column":51},"end":{"line":40,"column":5}},"line":28},"5":{"name":"(anonymous_5)","decl":{"start":{"line":34,"column":15},"end":{"line":34,"column":16}},"loc":{"start":{"line":34,"column":37},"end":{"line":39,"column":9}},"line":34},"6":{"name":"transfer","decl":{"start":{"line":43,"column":24},"end":{"line":43,"column":32}},"loc":{"start":{"line":43,"column":74},"end":{"line":102,"column":1}},"line":43},"7":{"name":"(anonymous_7)","decl":{"start":{"line":44,"column":24},"end":{"line":44,"column":25}},"loc":{"start":{"line":44,"column":36},"end":{"line":101,"column":5}},"line":44},"8":{"name":"_callee","decl":{"start":{"line":45,"column":86},"end":{"line":45,"column":93}},"loc":{"start":{"line":45,"column":111},"end":{"line":96,"column":9}},"line":45},"9":{"name":"_callee$","decl":{"start":{"line":48,"column":53},"end":{"line":48,"column":61}},"loc":{"start":{"line":48,"column":72},"end":{"line":95,"column":13}},"line":48},"10":{"name":"(anonymous_10)","decl":{"start":{"line":98,"column":15},"end":{"line":98,"column":16}},"loc":{"start":{"line":98,"column":34},"end":{"line":100,"column":9}},"line":98}},"branchMap":{"0":{"loc":{"start":{"line":21,"column":12},"end":{"line":21,"column":33}},"type":"if","locations":[{"start":{"line":21,"column":12},"end":{"line":21,"column":33}},{"start":{"line":21,"column":12},"end":{"line":21,"column":33}}],"line":21},"1":{"loc":{"start":{"line":37,"column":12},"end":{"line":37,"column":33}},"type":"if","locations":[{"start":{"line":37,"column":12},"end":{"line":37,"column":33}},{"start":{"line":37,"column":12},"end":{"line":37,"column":33}}],"line":37},"2":{"loc":{"start":{"line":50,"column":20},"end":{"line":93,"column":21}},"type":"switch","locations":[{"start":{"line":51,"column":24},"end":{"line":54,"column":79}},{"start":{"line":56,"column":24},"end":{"line":67,"column":72}},{"start":{"line":69,"column":24},"end":{"line":75,"column":34}},{"start":{"line":77,"column":24},"end":{"line":78,"column":67}},{"start":{"line":80,"column":24},"end":{"line":82,"column":34}},{"start":{"line":84,"column":24},"end":{"line":88,"column":48}},{"start":{"line":90,"column":24},"end":{"line":90,"column":32}},{"start":{"line":91,"column":24},"end":{"line":92,"column":51}}],"line":50},"3":{"loc":{"start":{"line":61,"column":28},"end":{"line":64,"column":29}},"type":"if","locations":[{"start":{"line":61,"column":28},"end":{"line":64,"column":29}},{"start":{"line":61,"column":28},"end":{"line":64,"column":29}}],"line":61},"4":{"loc":{"start":{"line":61,"column":34},"end":{"line":61,"column":58}},"type":"binary-expr","locations":[{"start":{"line":61,"column":34},"end":{"line":61,"column":40}},{"start":{"line":61,"column":44},"end":{"line":61,"column":58}}],"line":61},"5":{"loc":{"start":{"line":73,"column":28},"end":{"line":73,"column":51}},"type":"if","locations":[{"start":{"line":73,"column":28},"end":{"line":73,"column":51}},{"start":{"line":73,"column":28},"end":{"line":73,"column":51}}],"line":73}},"s":{"0":1,"1":1,"2":1,"3":2,"4":2,"5":2,"6":2,"7":0,"8":2,"9":1,"10":2,"11":2,"12":2,"13":2,"14":0,"15":2,"16":1,"17":2,"18":2,"19":2,"20":6,"21":10,"22":2,"23":2,"24":2,"25":2,"26":2,"27":2,"28":2,"29":0,"30":0,"31":2,"32":2,"33":2,"34":2,"35":2,"36":2,"37":2,"38":2,"39":0,"40":2,"41":2,"42":0,"43":0,"44":0,"45":2,"46":2,"47":2},"f":{"0":2,"1":2,"2":2,"3":2,"4":2,"5":2,"6":2,"7":2,"8":2,"9":6,"10":2},"b":{"0":[0,2],"1":[0,2],"2":[2,2,2,0,2,0,2,2],"3":[0,2],"4":[2,2],"5":[2,0]},"inputSourceMap":{"version":3,"sources":["src/api/modules/transfer.js"],"names":["request","secret","process","env","PAYSTACK_SECRET","getReceipt","name","account_number","bank_code","resolve","reject","post","set","send","currency","end","err","body","makeTransfer","recipient_code","amount","recipient","transfer","status","data","Error"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;;AAEA,IAAMC,aAAa,SAAbA,UAAa,CAACC,IAAD,EAAOC,cAAP,EAAuBC,SAAvB;AAAA,WAAqC,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACrFV,gBACKW,IADL,8CAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACF,oBAAQ,OADN;AAEFP,sBAFE;AAGFC,0CAHE;AAIFC,gCAJE;AAKFM,sBAAU;AALR,SAHV,EAUKC,GAVL,CAUS,UAACC,GAAD,QAAmB;AAAA,gBAAXC,IAAW,QAAXA,IAAW;;AACpB,gBAAID,GAAJ,EAASN,OAAOM,GAAP;AACTP,oBAAQQ,IAAR;AACH,SAbL;AAcH,KAfuD,CAArC;AAAA,CAAnB;;AAiBA,IAAMC,eAAe,SAAfA,YAAe,CAACC,cAAD,EAAiBC,MAAjB;AAAA,WAA4B,aAAY,UAACX,OAAD,EAAUC,MAAV,EAAqB;AAC9EV,gBACKW,IADL,qCAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACF,sBAAU,SADR;AAEFO,0BAFE;AAGFC,uBAAWF,cAHT;AAIFL,sBAAU;AAJR,SAHV,EASKC,GATL,CASS,UAACC,GAAD,SAAmB;AAAA,gBAAXC,IAAW,SAAXA,IAAW;;AACpB,gBAAID,GAAJ,EAASN,OAAOM,GAAP;AACTP,oBAAQQ,IAAR;AACH,SAZL;AAaH,KAdgD,CAA5B;AAAA,CAArB;;AAgBA,IAAMK,WAAW,SAAXA,QAAW,CAAChB,IAAD,EAAOC,cAAP,EAAuBC,SAAvB,EAAkCY,MAAlC;AAAA,WAA6C;AAAA,6EAAY,iBAAOX,OAAP,EAAgBC,MAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAEdL,WAAWC,IAAX,EAAiBC,cAAjB,EAAiCC,SAAjC,CAFc;;AAAA;AAAA;AAE1De,kCAF0D,SAE1DA,MAF0D;AAE1CJ,0CAF0C,SAElDK,IAFkD,CAE1CL,cAF0C;;AAAA,kCAI9DI,UAAUJ,cAJoD;AAAA;AAAA;AAAA;;AAAA;AAAA,mCAKrCD,aAAaC,cAAb,EAA6BC,MAA7B,CALqC;;AAAA;AAAA;AAKtDG,mCALsD,SAKtDA,MALsD;;AAM9D,gCAAIA,OAAJ,EAAYd;AANkD;AAAA;;AAAA;AAQ9DC,mCAAO,IAAIe,KAAJ,CAAU,mBAAV,CAAP;;AAR8D;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAWlEf;;AAXkE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAZ;;AAAA;AAAA;AAAA;AAAA,QAA7C;AAAA,CAAjB;;AAeA,eAAeY,QAAf","file":"transfer.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nconst secret = process.env.PAYSTACK_SECRET;\n\nconst getReceipt = (name, account_number, bank_code) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/transferrecipient`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            \"type\": \"nuban\",\n            name,\n            account_number,\n            bank_code,\n            currency: 'NGN'\n        })\n        .end((err, { body }) => {\n            if (err) reject(err);\n            resolve(body);\n        });\n})\n\nconst makeTransfer = (recipient_code, amount) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/transfer`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            \"source\": \"balance\",\n            amount,\n            recipient: recipient_code,\n            currency: 'NGN'\n        })\n        .end((err, { body }) => {\n            if (err) reject(err);\n            resolve(body);\n        });\n});\n\nconst transfer = (name, account_number, bank_code, amount) => new Promise(async (resolve, reject) => {\n    try {\n        const { status, data: { recipient_code  } } = await getReceipt(name, account_number, bank_code);\n \n        if (status && recipient_code) {\n            const { status } = await makeTransfer(recipient_code, amount);\n            if (status) resolve();\n        } else {\n            reject(new Error('No recipient_code'));\n        }\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport default transfer;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"f76e26f270b7080bab441a32803d9666a0dd38d0"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.controller.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":15,"column":13},"end":{"line":15,"column":40}},"2":{"start":{"line":19,"column":19},"end":{"line":19,"column":102}},"3":{"start":{"line":20,"column":24},"end":{"line":20,"column":32}},"4":{"start":{"line":21,"column":20},"end":{"line":21,"column":35}},"5":{"start":{"line":22,"column":29},"end":{"line":22,"column":43}},"6":{"start":{"line":23,"column":24},"end":{"line":23,"column":60}},"7":{"start":{"line":24,"column":21},"end":{"line":24,"column":42}},"8":{"start":{"line":25,"column":19},"end":{"line":25,"column":38}},"9":{"start":{"line":26,"column":27},"end":{"line":26,"column":54}},"10":{"start":{"line":27,"column":36},"end":{"line":27,"column":59}},"11":{"start":{"line":28,"column":25},"end":{"line":28,"column":57}},"12":{"start":{"line":29,"column":24},"end":{"line":29,"column":55}},"13":{"start":{"line":30,"column":20},"end":{"line":30,"column":47}},"14":{"start":{"line":33,"column":8},"end":{"line":87,"column":9}},"15":{"start":{"line":34,"column":12},"end":{"line":84,"column":17}},"16":{"start":{"line":35,"column":27},"end":{"line":79,"column":19}},"17":{"start":{"line":36,"column":20},"end":{"line":78,"column":50}},"18":{"start":{"line":37,"column":24},"end":{"line":77,"column":25}},"19":{"start":{"line":38,"column":28},"end":{"line":76,"column":29}},"20":{"start":{"line":40,"column":36},"end":{"line":43,"column":37}},"21":{"start":{"line":41,"column":40},"end":{"line":41,"column":58}},"22":{"start":{"line":42,"column":40},"end":{"line":42,"column":46}},"23":{"start":{"line":45,"column":36},"end":{"line":45,"column":53}},"24":{"start":{"line":46,"column":36},"end":{"line":46,"column":135}},"25":{"start":{"line":49,"column":36},"end":{"line":49,"column":54}},"26":{"start":{"line":50,"column":36},"end":{"line":50,"column":54}},"27":{"start":{"line":51,"column":36},"end":{"line":51,"column":157}},"28":{"start":{"line":54,"column":36},"end":{"line":54,"column":54}},"29":{"start":{"line":55,"column":36},"end":{"line":55,"column":184}},"30":{"start":{"line":58,"column":36},"end":{"line":58,"column":55}},"31":{"start":{"line":59,"column":36},"end":{"line":59,"column":133}},"32":{"start":{"line":62,"column":36},"end":{"line":62,"column":76}},"33":{"start":{"line":63,"column":36},"end":{"line":63,"column":55}},"34":{"start":{"line":64,"column":36},"end":{"line":64,"column":42}},"35":{"start":{"line":67,"column":36},"end":{"line":67,"column":55}},"36":{"start":{"line":68,"column":36},"end":{"line":68,"column":71}},"37":{"start":{"line":70,"column":36},"end":{"line":70,"column":61}},"38":{"start":{"line":71,"column":36},"end":{"line":71,"column":154}},"39":{"start":{"line":75,"column":36},"end":{"line":75,"column":59}},"40":{"start":{"line":81,"column":16},"end":{"line":83,"column":18}},"41":{"start":{"line":82,"column":20},"end":{"line":82,"column":55}},"42":{"start":{"line":86,"column":12},"end":{"line":86,"column":53}},"43":{"start":{"line":90,"column":17},"end":{"line":90,"column":37}},"44":{"start":{"line":91,"column":8},"end":{"line":94,"column":11}},"45":{"start":{"line":92,"column":12},"end":{"line":92,"column":88}},"46":{"start":{"line":92,"column":21},"end":{"line":92,"column":88}},"47":{"start":{"line":93,"column":12},"end":{"line":93,"column":63}}},"fnMap":{"0":{"name":"createOne","decl":{"start":{"line":18,"column":24},"end":{"line":18,"column":33}},"loc":{"start":{"line":18,"column":44},"end":{"line":88,"column":5}},"line":18},"1":{"name":"(anonymous_1)","decl":{"start":{"line":34,"column":119},"end":{"line":34,"column":120}},"loc":{"start":{"line":34,"column":131},"end":{"line":84,"column":13}},"line":34},"2":{"name":"_callee","decl":{"start":{"line":35,"column":93},"end":{"line":35,"column":100}},"loc":{"start":{"line":35,"column":111},"end":{"line":79,"column":17}},"line":35},"3":{"name":"_callee$","decl":{"start":{"line":36,"column":61},"end":{"line":36,"column":69}},"loc":{"start":{"line":36,"column":80},"end":{"line":78,"column":21}},"line":36},"4":{"name":"(anonymous_4)","decl":{"start":{"line":81,"column":23},"end":{"line":81,"column":24}},"loc":{"start":{"line":81,"column":42},"end":{"line":83,"column":17}},"line":81},"5":{"name":"getOne","decl":{"start":{"line":89,"column":21},"end":{"line":89,"column":27}},"loc":{"start":{"line":89,"column":38},"end":{"line":95,"column":5}},"line":89},"6":{"name":"(anonymous_6)","decl":{"start":{"line":91,"column":48},"end":{"line":91,"column":49}},"loc":{"start":{"line":91,"column":68},"end":{"line":94,"column":9}},"line":91}},"branchMap":{"0":{"loc":{"start":{"line":33,"column":8},"end":{"line":87,"column":9}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":87,"column":9}},{"start":{"line":33,"column":8},"end":{"line":87,"column":9}}],"line":33},"1":{"loc":{"start":{"line":33,"column":12},"end":{"line":33,"column":94}},"type":"binary-expr","locations":[{"start":{"line":33,"column":12},"end":{"line":33,"column":56}},{"start":{"line":33,"column":60},"end":{"line":33,"column":86}},{"start":{"line":33,"column":90},"end":{"line":33,"column":94}}],"line":33},"2":{"loc":{"start":{"line":38,"column":28},"end":{"line":76,"column":29}},"type":"switch","locations":[{"start":{"line":39,"column":32},"end":{"line":46,"column":135}},{"start":{"line":48,"column":32},"end":{"line":51,"column":157}},{"start":{"line":53,"column":32},"end":{"line":55,"column":184}},{"start":{"line":57,"column":32},"end":{"line":59,"column":133}},{"start":{"line":61,"column":32},"end":{"line":64,"column":42}},{"start":{"line":66,"column":32},"end":{"line":71,"column":154}},{"start":{"line":73,"column":32},"end":{"line":73,"column":40}},{"start":{"line":74,"column":32},"end":{"line":75,"column":59}}],"line":38},"3":{"loc":{"start":{"line":40,"column":36},"end":{"line":43,"column":37}},"type":"if","locations":[{"start":{"line":40,"column":36},"end":{"line":43,"column":37}},{"start":{"line":40,"column":36},"end":{"line":43,"column":37}}],"line":40},"4":{"loc":{"start":{"line":92,"column":12},"end":{"line":92,"column":88}},"type":"if","locations":[{"start":{"line":92,"column":12},"end":{"line":92,"column":88}},{"start":{"line":92,"column":12},"end":{"line":92,"column":88}}],"line":92}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":4,"19":6,"20":1,"21":1,"22":1,"23":0,"24":0,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":1,"35":0,"36":0,"37":0,"38":0,"39":1,"40":1,"41":1,"42":0,"43":1,"44":1,"45":1,"46":0,"47":1},"f":{"0":1,"1":1,"2":1,"3":4,"4":1,"5":1,"6":1},"b":{"0":[1,0],"1":[1,1,1],"2":[1,1,1,1,1,0,1,1],"3":[1,0],"4":[0,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.controller.js"],"names":["crypto","PaymentModel","InvoiceModel","mailer","generateController","Transfer","secret","process","env","PAYSTACK_SECRET","createOne","req","res","hash","createHmac","update","body","digest","event","data","reference","transaction","amount","paid","invoice_code","customer","first_name","last_name","email","headers","findOneAndUpdate","$set","status","new","err","doc","console","log","send","error","Error","create","customerEmail","marchantEmail","invoiceId","_id","sendReceiptMail","success","message","getOne","id","params","findOne"],"mappings":";;;;;;;AAAA,OAAOA,MAAP,MAAmB,QAAnB;AACA,OAAOC,YAAP,MAAyB,iBAAzB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAO,KAAKC,MAAZ,MAAwB,sBAAxB;AACA,OAAOC,kBAAP,MAA+B,kCAA/B;AACA,OAAOC,QAAP,MAAqB,wBAArB;;AAEA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;;AAEA,eAAeL,mBAAmBH,YAAnB,EAAiC;AAC5CS,eAAW,mBAACC,GAAD,EAAMC,GAAN,EAAc;AACrB,YAAMC,OAAOb,OAAOc,UAAP,CAAkB,QAAlB,EAA4BR,MAA5B,EAAoCS,MAApC,CAA2C,gBAAeJ,IAAIK,IAAnB,CAA3C,EAAqEC,MAArE,CAA4E,KAA5E,CAAb;AADqB,wBAE2GN,IAAIK,IAF/G;AAAA,YAEbE,KAFa,aAEbA,KAFa;AAAA,uCAENC,IAFM;AAAA,YAEiBC,SAFjB,kBAEEC,WAFF,CAEiBD,SAFjB;AAAA,YAE8BE,MAF9B,kBAE8BA,MAF9B;AAAA,YAEsCC,IAFtC,kBAEsCA,IAFtC;AAAA,YAE4CC,YAF5C,kBAE4CA,YAF5C;AAAA,mDAE0DC,QAF1D;AAAA,YAEsEC,UAFtE,yBAEsEA,UAFtE;AAAA,YAEkFC,SAFlF,yBAEkFA,SAFlF;AAAA,YAE6FC,KAF7F,yBAE6FA,KAF7F;;;AAIrB,YAAIf,SAASF,IAAIkB,OAAJ,CAAY,sBAAZ,CAAT,IAAgDX,UAAU,gBAA1D,IAA8EK,IAAlF,EAAwF;AACpFrB,yBAAa4B,gBAAb,CAA8B,EAAEN,0BAAF,EAA9B,EAAgD,EAAEO,MAAM,EAAEC,QAAQ,MAAV,EAAR,EAAhD,EAA8E,EAAEC,KAAK,IAAP,EAA9E;AAAA,oFAA6F,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,yCACrFD,GADqF;AAAA;AAAA;AAAA;;AAErFE,4CAAQC,GAAR,CAAYH,GAAZ;AAFqF,qEAG9EtB,IAAIoB,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,OAAO,IAAIC,KAAJ,CAAUD,KAAV,CAAT,EAA2BP,QAAQ,KAAnC,EAArB,CAH8E;;AAAA;AAAA;AAAA;AAAA,2CAO/E3B,SAAS8B,IAAI,cAAJ,CAAT,EAA8BA,IAAI,uBAAJ,CAA9B,EAA4DA,IAAI,kBAAJ,CAA5D,EAAqFA,IAAI,gBAAJ,IAAwB,GAA7G,CAP+E;;AAAA;AAAA;AAAA,2CAQ/ElC,aAAawC,MAAb,CAAoB,EAAEC,eAAed,KAAjB,EAAwBe,eAAeR,IAAI,eAAJ,CAAvC,EAA6Df,oBAA7D,EAAwEE,cAAxE,EAAgFsB,WAAWT,IAAIU,GAA/F,EAApB,CAR+E;;AAAA;AAAA;AAAA,2CAS/E1C,OAAO2C,eAAP,CAA0BpB,UAA1B,SAAwCC,SAAxC,EAAqDC,KAArD,EAA4DO,IAAI,eAAJ,CAA5D,EAAkFb,MAAlF,CAT+E;;AAAA;AAUrFV,wCAAIoB,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAES,SAAS,IAAX,EAArB;AAVqF;AAAA;;AAAA;AAAA;AAAA;;AAYrFX,4CAAQC,GAAR;AAZqF,qEAa9EzB,IAAIoB,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,OAAO,EAAES,SAAS,qBAAX,EAAT,EAA6CD,SAAS,KAAtD,EAArB,CAb8E;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,iBAA7F;;AAAA;AAAA;AAAA;AAAA;AAgBH,SAjBD,MAiBO;AACHnC,gBAAIoB,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAES,SAAS,KAAX,EAArB;AACH;AACJ,KAzB2C;AA0B5CE,YAAQ,gBAACtC,GAAD,EAAMC,GAAN,EAAc;AAClB,YAAIsC,KAAKvC,IAAIwC,MAAJ,CAAWP,SAApB;AACA3C,qBAAamD,OAAb,CAAqB,EAAER,WAAWM,EAAb,EAArB,EAAwC,UAAUhB,GAAV,EAAeC,GAAf,EAAoB;AACxD,gBAAID,GAAJ,EAAStB,IAAIoB,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAES,SAAS,KAAX,EAAkBR,oBAAYL,GAAZ,CAAlB,EAArB;AACTtB,gBAAIoB,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAES,SAAS,IAAX,EAAiB5B,MAAMgB,GAAvB,EAArB;AACH,SAHD;AAIH;AAhC2C,CAAjC,CAAf","file":"payment.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import crypto from 'crypto';\nimport PaymentModel from './payment.model';\nimport InvoiceModel from '../invoice/invoice.model';\nimport * as mailer from '../../modules/mailer';\nimport generateController from '../../modules/generateController';\nimport Transfer from '../../modules/transfer';\n\nconst secret = process.env.PAYSTACK_SECRET;\n\nexport default generateController(PaymentModel, {\n    createOne: (req, res) => {\n        const hash = crypto.createHmac('sha512', secret).update(JSON.stringify(req.body)).digest('hex');\n        const { event, data: { transaction: { reference }, amount, paid, invoice_code, customer: { first_name, last_name, email } } } = req.body;\n\n        if (hash === req.headers['x-paystack-signature'] && event === 'invoice.update' && paid) {\n            InvoiceModel.findOneAndUpdate({ invoice_code }, { $set :{ status: 'paid' } }, { new: true }, async (err, doc) => {\n                if (err) {\n                    console.log(err);\n                    return res.status(400).send({ error: new Error(error), status: false });\n                }\n\n                try {\n                    await Transfer(doc['marchantName'], doc['marchantAccountNumber'], doc['marchantBankCode'], doc['deliveryAmount'] * 100);\n                    await PaymentModel.create({ customerEmail: email, marchantEmail: doc['marchantEmail'], reference, amount, invoiceId: doc._id });\n                    await mailer.sendReceiptMail(`${first_name} ${last_name}`, email, doc['marchantEmail'], amount);\n                    res.status(200).send({ success: true });\n                } catch (err) {\n                    console.log(err);\n                    return res.status(400).send({ error: { message: 'Could not send mail' }, success: false });\n                }\n            })\n        } else {\n            res.status(400).send({ success: false });\n        }\n    },\n    getOne: (req, res) => {\n        var id = req.params.invoiceId;\n        PaymentModel.findOne({ invoiceId: id }, function (err, doc) {\n            if (err) res.status(401).send({ success: false, error: { ...err } });\n            res.status(200).send({ success: true, data: doc });\n        });\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"c087ad28d010420bb483bcb89e8772c33a6d7961"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.route.js","statementMap":{"0":{"start":{"line":4,"column":13},"end":{"line":4,"column":29}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":52}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":58}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.route.js"],"names":["express","PaymentController","Router","param","findByParam","route","post","createOne","get","getOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;;AAEA,IAAMC,SAASF,QAAQE,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,MAAb,EAAqBF,kBAAkBG,WAAvC;;AAEAF,OAAOG,KAAP,CAAa,GAAb,EACKC,IADL,CACUL,kBAAkBM,SAD5B;;AAGAL,OAAOG,KAAP,CAAa,aAAb,EACKG,GADL,CACSP,kBAAkBQ,MAD3B;;AAGA,eAAeP,MAAf","file":"payment.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport PaymentController from './payment.controller';\n\nconst Router = express.Router();\n\nRouter.param('/:id', PaymentController.findByParam);\n\nRouter.route('/')\n    .post(PaymentController.createOne);\n\nRouter.route('/:invoiceId')\n    .get(PaymentController.getOne);\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"bff3eb91f1d9edf483dc6a5e0a347972d7729f9d"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.route.js","statementMap":{"0":{"start":{"line":3,"column":13},"end":{"line":3,"column":29}},"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":58}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":92}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.route.js"],"names":["express","DisputeController","Router","param","getInvoiceId","route","post","createOne","get","getOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;AACA,IAAMC,SAASF,QAAQE,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,WAAb,EAA0BF,kBAAkBG,YAA5C;;AAEAF,OAAOG,KAAP,CAAa,aAAb,EACKC,IADL,CACUL,kBAAkBM,SAD5B,EAEKC,GAFL,CAESP,kBAAkBQ,MAF3B;;AAIA,eAAeP,MAAf","file":"dispute.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport DisputeController from './dispute.controller';\nconst Router = express.Router();\n\nRouter.param('invoiceId', DisputeController.getInvoiceId);\n\nRouter.route('/:invoiceId')\n    .post(DisputeController.createOne)\n    .get(DisputeController.getOne);\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"1a94a95238012cbf38920e457e966864e29338fd"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/confirm/confirm.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/confirm/confirm.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":11,"column":20},"end":{"line":11,"column":36}},"2":{"start":{"line":13,"column":0},"end":{"line":13,"column":65}},"3":{"start":{"line":14,"column":0},"end":{"line":64,"column":3}},"4":{"start":{"line":15,"column":20},"end":{"line":15,"column":40}},"5":{"start":{"line":16,"column":17},"end":{"line":16,"column":60}},"6":{"start":{"line":17,"column":20},"end":{"line":17,"column":38}},"7":{"start":{"line":19,"column":4},"end":{"line":19,"column":134}},"8":{"start":{"line":19,"column":46},"end":{"line":19,"column":134}},"9":{"start":{"line":21,"column":4},"end":{"line":63,"column":9}},"10":{"start":{"line":22,"column":19},"end":{"line":58,"column":11}},"11":{"start":{"line":23,"column":12},"end":{"line":57,"column":41}},"12":{"start":{"line":24,"column":16},"end":{"line":56,"column":17}},"13":{"start":{"line":25,"column":20},"end":{"line":55,"column":21}},"14":{"start":{"line":27,"column":28},"end":{"line":27,"column":94}},"15":{"start":{"line":27,"column":39},"end":{"line":27,"column":94}},"16":{"start":{"line":29,"column":28},"end":{"line":32,"column":29}},"17":{"start":{"line":30,"column":32},"end":{"line":30,"column":51}},"18":{"start":{"line":31,"column":32},"end":{"line":31,"column":38}},"19":{"start":{"line":34,"column":28},"end":{"line":34,"column":46}},"20":{"start":{"line":35,"column":28},"end":{"line":35,"column":46}},"21":{"start":{"line":36,"column":28},"end":{"line":36,"column":153}},"22":{"start":{"line":39,"column":28},"end":{"line":39,"column":47}},"23":{"start":{"line":40,"column":28},"end":{"line":40,"column":34}},"24":{"start":{"line":43,"column":28},"end":{"line":43,"column":46}},"25":{"start":{"line":44,"column":28},"end":{"line":44,"column":63}},"26":{"start":{"line":46,"column":28},"end":{"line":46,"column":87}},"27":{"start":{"line":50,"column":28},"end":{"line":50,"column":80}},"28":{"start":{"line":54,"column":28},"end":{"line":54,"column":51}},"29":{"start":{"line":60,"column":8},"end":{"line":62,"column":10}},"30":{"start":{"line":61,"column":12},"end":{"line":61,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":40},"end":{"line":14,"column":41}},"loc":{"start":{"line":14,"column":60},"end":{"line":64,"column":1}},"line":14},"1":{"name":"(anonymous_1)","decl":{"start":{"line":21,"column":99},"end":{"line":21,"column":100}},"loc":{"start":{"line":21,"column":111},"end":{"line":63,"column":5}},"line":21},"2":{"name":"_callee","decl":{"start":{"line":22,"column":85},"end":{"line":22,"column":92}},"loc":{"start":{"line":22,"column":106},"end":{"line":58,"column":9}},"line":22},"3":{"name":"_callee$","decl":{"start":{"line":23,"column":53},"end":{"line":23,"column":61}},"loc":{"start":{"line":23,"column":72},"end":{"line":57,"column":13}},"line":23},"4":{"name":"(anonymous_4)","decl":{"start":{"line":60,"column":15},"end":{"line":60,"column":16}},"loc":{"start":{"line":60,"column":34},"end":{"line":62,"column":9}},"line":60}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":17},"end":{"line":16,"column":60}},"type":"cond-expr","locations":[{"start":{"line":16,"column":37},"end":{"line":16,"column":47}},{"start":{"line":16,"column":50},"end":{"line":16,"column":60}}],"line":16},"1":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":134}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":134}},{"start":{"line":19,"column":4},"end":{"line":19,"column":134}}],"line":19},"2":{"loc":{"start":{"line":25,"column":20},"end":{"line":55,"column":21}},"type":"switch","locations":[{"start":{"line":26,"column":24},"end":{"line":36,"column":153}},{"start":{"line":38,"column":24},"end":{"line":40,"column":34}},{"start":{"line":42,"column":24},"end":{"line":46,"column":87}},{"start":{"line":48,"column":24},"end":{"line":50,"column":80}},{"start":{"line":52,"column":24},"end":{"line":52,"column":32}},{"start":{"line":53,"column":24},"end":{"line":54,"column":51}}],"line":25},"3":{"loc":{"start":{"line":27,"column":28},"end":{"line":27,"column":94}},"type":"if","locations":[{"start":{"line":27,"column":28},"end":{"line":27,"column":94}},{"start":{"line":27,"column":28},"end":{"line":27,"column":94}}],"line":27},"4":{"loc":{"start":{"line":29,"column":28},"end":{"line":32,"column":29}},"type":"if","locations":[{"start":{"line":29,"column":28},"end":{"line":32,"column":29}},{"start":{"line":29,"column":28},"end":{"line":32,"column":29}}],"line":29}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":3,"7":3,"8":1,"9":2,"10":2,"11":2,"12":3,"13":5,"14":2,"15":0,"16":2,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":0,"25":0,"26":0,"27":2,"28":2,"29":2,"30":2},"f":{"0":3,"1":2,"2":2,"3":3,"4":2},"b":{"0":[2,1],"1":[1,2],"2":[2,1,0,2,2,2],"3":[0,2],"4":[1,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/confirm/confirm.route.js"],"names":["express","InvoiceModel","Transfer","DisputeController","ConfirmRouter","Router","param","getInvoiceId","route","post","req","res","invoiceId","params","status","body","accepted","emailCode","invoice","verifyCode","send","success","error","Error","findOneAndUpdate","_id","$set","new","data","err"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,QAAP,MAAqB,wBAArB;AACA,OAAOC,iBAAP,MAA8B,+BAA9B;;AAEA,IAAMC,gBAAgBJ,QAAQK,MAAR,EAAtB;;AAEAD,cAAcE,KAAd,CAAoB,WAApB,EAAiCH,kBAAkBI,YAAnD;AACAH,cAAcI,KAAd,CAAoB,aAApB,EACKC,IADL,CACU,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChB,QAAMC,YAAYF,IAAIG,MAAJ,CAAWD,SAA7B;AACA,QAAME,SAASJ,IAAIK,IAAJ,CAASC,QAAT,GAAoB,UAApB,GAAiC,UAAhD;AACA,QAAMC,YAAYP,IAAIK,IAAJ,CAASE,SAA3B;;AAEA,QAAIP,IAAIQ,OAAJ,CAAYC,UAAZ,KAA2BF,SAA/B,EAA0C,OAAON,IAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,OAAO,IAAIC,KAAJ,CAAU,oBAAV,CAAzB,EAArB,CAAP;;AAE1CtB,iBAAauB,gBAAb,CAA8B,EAAEC,KAAKb,SAAP,EAA9B,EAAkD,EAAEc,MAAM,EAAEZ,cAAF,EAAR,EAAlD,EAAwE,EAACa,KAAK,IAAN,EAAxE;AAAA,4EAAqF,iBAAOL,KAAP,EAAcM,IAAd;AAAA;AAAA;AAAA;AAAA;AACjF,gCAAIN,KAAJ,EAAWX,IAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,YAAlB,EAArB;;AADsE,kCAG7ER,WAAW,UAHkE;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mCAKnEZ,SAAS0B,KAAK,cAAL,CAAT,EAA+BA,KAAK,uBAAL,CAA/B,EAA8DA,KAAK,kBAAL,CAA9D,EAAwFA,KAAK,gBAAL,IAAyB,GAAjH,CALmE;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAOzEjB,gCAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBQ,gBAAlB,EAArB;;AAPyE;;AAWjFlB,gCAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,IAAX,EAAiBO,UAAjB,EAArB;;AAXiF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAArF;;AAAA;AAAA;AAAA;AAAA;AAaH,CArBL;;AAwBA,eAAexB,aAAf","file":"confirm.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport InvoiceModel from '../invoice/invoice.model';\nimport Transfer from '../../modules/transfer';\nimport DisputeController from '../dispute/dispute.controller';\n\nconst ConfirmRouter = express.Router();\n\nConfirmRouter.param('invoiceId', DisputeController.getInvoiceId);\nConfirmRouter.route('/:invoiceId')\n    .post((req, res) => {\n        const invoiceId = req.params.invoiceId;\n        const status = req.body.accepted ? 'accepted' : 'rejected';\n        const emailCode = req.body.emailCode;\n\n        if (req.invoice.verifyCode !== emailCode) return res.status(400).send({ success: false, error: new Error('Wrong invoice code') });\n\n        InvoiceModel.findOneAndUpdate({ _id: invoiceId }, { $set: { status } }, {new: true}, async (error, data) => {\n            if (error) res.status(400).send({ success: false, error });\n\n            if (status === \"accepted\") {\n                try {\n                    await Transfer(data['marchantName'], data['marchantAccountNumber'], data['marchantBankCode'], data['purchaseAmount'] * 100);\n                } catch(err) {\n                    res.status(400).send({ success: false, err });\n                }\n            }\n\n            res.status(200).send({ success: true, data });\n        });\n    });\n\n\nexport default ConfirmRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"a8cc8d6e84237b628fe93f73eb6e1efdf88d6f58"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/banks/banks.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/banks/banks.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":8,"column":13},"end":{"line":8,"column":40}},"2":{"start":{"line":9,"column":13},"end":{"line":9,"column":29}},"3":{"start":{"line":11,"column":0},"end":{"line":35,"column":5}},"4":{"start":{"line":12,"column":15},"end":{"line":30,"column":7}},"5":{"start":{"line":13,"column":8},"end":{"line":29,"column":27}},"6":{"start":{"line":14,"column":12},"end":{"line":28,"column":13}},"7":{"start":{"line":15,"column":16},"end":{"line":27,"column":17}},"8":{"start":{"line":17,"column":24},"end":{"line":22,"column":27}},"9":{"start":{"line":18,"column":39},"end":{"line":18,"column":54}},"10":{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},"11":{"start":{"line":20,"column":37},"end":{"line":20,"column":88}},"12":{"start":{"line":21,"column":28},"end":{"line":21,"column":68}},"13":{"start":{"line":26,"column":24},"end":{"line":26,"column":47}},"14":{"start":{"line":32,"column":4},"end":{"line":34,"column":6}},"15":{"start":{"line":33,"column":8},"end":{"line":33,"column":43}},"16":{"start":{"line":37,"column":0},"end":{"line":67,"column":5}},"17":{"start":{"line":38,"column":16},"end":{"line":62,"column":7}},"18":{"start":{"line":41,"column":8},"end":{"line":61,"column":28}},"19":{"start":{"line":42,"column":12},"end":{"line":60,"column":13}},"20":{"start":{"line":43,"column":16},"end":{"line":59,"column":17}},"21":{"start":{"line":45,"column":24},"end":{"line":45,"column":129}},"22":{"start":{"line":48,"column":24},"end":{"line":54,"column":27}},"23":{"start":{"line":49,"column":39},"end":{"line":49,"column":54}},"24":{"start":{"line":51,"column":28},"end":{"line":51,"column":68}},"25":{"start":{"line":53,"column":28},"end":{"line":53,"column":79}},"26":{"start":{"line":58,"column":24},"end":{"line":58,"column":48}},"27":{"start":{"line":64,"column":4},"end":{"line":66,"column":6}},"28":{"start":{"line":65,"column":8},"end":{"line":65,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":34},"end":{"line":35,"column":1}},"line":11},"1":{"name":"_callee","decl":{"start":{"line":12,"column":81},"end":{"line":12,"column":88}},"loc":{"start":{"line":12,"column":99},"end":{"line":30,"column":5}},"line":12},"2":{"name":"_callee$","decl":{"start":{"line":13,"column":49},"end":{"line":13,"column":57}},"loc":{"start":{"line":13,"column":68},"end":{"line":29,"column":9}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":153},"end":{"line":17,"column":154}},"loc":{"start":{"line":17,"column":175},"end":{"line":22,"column":25}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":32,"column":11},"end":{"line":32,"column":12}},"loc":{"start":{"line":32,"column":30},"end":{"line":34,"column":5}},"line":32},"5":{"name":"(anonymous_5)","decl":{"start":{"line":37,"column":55},"end":{"line":37,"column":56}},"loc":{"start":{"line":37,"column":67},"end":{"line":67,"column":1}},"line":37},"6":{"name":"_callee2","decl":{"start":{"line":38,"column":82},"end":{"line":38,"column":90}},"loc":{"start":{"line":38,"column":101},"end":{"line":62,"column":5}},"line":38},"7":{"name":"_callee2$","decl":{"start":{"line":41,"column":49},"end":{"line":41,"column":58}},"loc":{"start":{"line":41,"column":70},"end":{"line":61,"column":9}},"line":41},"8":{"name":"(anonymous_8)","decl":{"start":{"line":48,"column":223},"end":{"line":48,"column":224}},"loc":{"start":{"line":48,"column":240},"end":{"line":52,"column":25}},"line":48},"9":{"name":"(anonymous_9)","decl":{"start":{"line":52,"column":33},"end":{"line":52,"column":34}},"loc":{"start":{"line":52,"column":48},"end":{"line":54,"column":25}},"line":52},"10":{"name":"(anonymous_10)","decl":{"start":{"line":64,"column":11},"end":{"line":64,"column":12}},"loc":{"start":{"line":64,"column":31},"end":{"line":66,"column":5}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":15,"column":16},"end":{"line":27,"column":17}},"type":"switch","locations":[{"start":{"line":16,"column":20},"end":{"line":22,"column":27}},{"start":{"line":24,"column":20},"end":{"line":24,"column":27}},{"start":{"line":25,"column":20},"end":{"line":26,"column":47}}],"line":15},"1":{"loc":{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},"type":"if","locations":[{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},{"start":{"line":20,"column":28},"end":{"line":20,"column":88}}],"line":20},"2":{"loc":{"start":{"line":43,"column":16},"end":{"line":59,"column":17}},"type":"switch","locations":[{"start":{"line":44,"column":20},"end":{"line":54,"column":27}},{"start":{"line":56,"column":20},"end":{"line":56,"column":27}},{"start":{"line":57,"column":20},"end":{"line":58,"column":48}}],"line":43}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":0,"26":1,"27":1,"28":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":1},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/banks/banks.route.js"],"names":["request","express","secret","process","env","PAYSTACK_SECRET","Router","route","get","req","res","set","end","err","data","body","status","send","success","params","bank_code","account_number","then","catch"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;AACA,IAAMC,SAASL,QAAQK,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,GAAb,EACKC,GADL;AAAA,wEACS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AACDV,gCACKQ,GADL,iCAEKG,GAFL,CAES,cAFT,EAEyB,kBAFzB,EAGKA,GAHL,CAGS,eAHT,cAGoCT,MAHpC,EAIKU,GAJL,CAIS,UAACC,GAAD,SAA6B;AAAA,gCAAbC,IAAa,SAArBC,IAAqB,CAAbD,IAAa;;AAC9B,gCAAID,GAAJ,EAASH,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBL,QAAlB,EAArB;AACTH,gCAAIO,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAiBJ,UAAjB,EAAT;AACH,yBAPL;;AADC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAYAR,OAAOC,KAAP,CAAa,oCAAb,EACKC,GADL;AAAA,yEACS,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,sCACqCD,IAAIU,MADzC,EACOC,SADP,eACOA,SADP,EACkBC,cADlB,eACkBA,cADlB;;;AAGDrB,gCACKQ,GADL,0DACgEa,cADhE,mBAC4FD,SAD5F,EAEKT,GAFL,CAES,cAFT,EAEyB,kBAFzB,EAGKA,GAHL,CAGS,eAHT,cAGoCT,MAHpC,EAIKoB,IAJL,CAIU,iBAAwB;AAAA,gCAAbR,IAAa,SAArBC,IAAqB,CAAbD,IAAa;;AAC1BJ,gCAAIO,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAiBJ,UAAjB,EAAT;AACH,yBANL,EAOKS,KAPL,CAOW,UAACV,GAAD,EAAS;AACZH,gCAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBL,QAAlB,EAArB;AACH,yBATL;;AAHC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAiBA,eAAeP,MAAf","file":"banks.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nimport express from 'express';\nconst secret = process.env.PAYSTACK_SECRET;\nconst Router = express.Router();\n\nRouter.route('/')\n    .get(async (req, res) => {\n        request\n            .get(`https://api.paystack.co/bank`)\n            .set('Content-Type', 'application/json')\n            .set('Authorization', `Bearer ${secret}`)\n            .end((err, { body: { data } }) => {\n                if (err) res.status(400).send({ success: false, err });\n                res.send({ success: true, data });\n            });\n    });\n\nRouter.route('/verify/:bank_code/:account_number')\n    .get(async (req, res) => {\n        const { bank_code, account_number } = req.params;\n        \n        request\n            .get(`https://api.paystack.co/bank/resolve?account_number=${account_number}&bank_code=${bank_code}`)\n            .set('Content-Type', 'application/json')\n            .set('Authorization', `Bearer ${secret}`)\n            .then(({ body: { data } }) => {\n                res.send({ success: true, data })\n            })\n            .catch((err) => {\n                res.status(400).send({ success: false, err });\n            });\n    });\n\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"2dfce16ff815242d35e8f89044f5af50b04257a7"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/auth.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/auth.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":10,"column":11},"end":{"line":10,"column":34}},"2":{"start":{"line":11,"column":15},"end":{"line":11,"column":102}},"3":{"start":{"line":13,"column":16},"end":{"line":13,"column":20}},"4":{"start":{"line":15,"column":20},"end":{"line":55,"column":1}},"5":{"start":{"line":16,"column":4},"end":{"line":54,"column":9}},"6":{"start":{"line":17,"column":19},"end":{"line":49,"column":11}},"7":{"start":{"line":20,"column":12},"end":{"line":48,"column":41}},"8":{"start":{"line":21,"column":16},"end":{"line":47,"column":17}},"9":{"start":{"line":22,"column":20},"end":{"line":46,"column":21}},"10":{"start":{"line":24,"column":28},"end":{"line":24,"column":46}},"11":{"start":{"line":25,"column":28},"end":{"line":25,"column":46}},"12":{"start":{"line":26,"column":28},"end":{"line":26,"column":55}},"13":{"start":{"line":29,"column":28},"end":{"line":29,"column":50}},"14":{"start":{"line":30,"column":28},"end":{"line":30,"column":51}},"15":{"start":{"line":32,"column":28},"end":{"line":32,"column":45}},"16":{"start":{"line":33,"column":28},"end":{"line":33,"column":38}},"17":{"start":{"line":34,"column":28},"end":{"line":34,"column":47}},"18":{"start":{"line":35,"column":28},"end":{"line":35,"column":34}},"19":{"start":{"line":38,"column":28},"end":{"line":38,"column":46}},"20":{"start":{"line":39,"column":28},"end":{"line":39,"column":63}},"21":{"start":{"line":41,"column":28},"end":{"line":41,"column":48}},"22":{"start":{"line":45,"column":28},"end":{"line":45,"column":51}},"23":{"start":{"line":51,"column":8},"end":{"line":53,"column":10}},"24":{"start":{"line":52,"column":12},"end":{"line":52,"column":47}},"25":{"start":{"line":57,"column":25},"end":{"line":92,"column":1}},"26":{"start":{"line":58,"column":23},"end":{"line":58,"column":39}},"27":{"start":{"line":59,"column":24},"end":{"line":59,"column":49}},"28":{"start":{"line":61,"column":4},"end":{"line":91,"column":5}},"29":{"start":{"line":62,"column":20},"end":{"line":62,"column":53}},"30":{"start":{"line":63,"column":24},"end":{"line":63,"column":61}},"31":{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},"32":{"start":{"line":66,"column":36},"end":{"line":66,"column":52}},"33":{"start":{"line":67,"column":22},"end":{"line":67,"column":43}},"34":{"start":{"line":68,"column":22},"end":{"line":68,"column":43}},"35":{"start":{"line":69,"column":26},"end":{"line":69,"column":43}},"36":{"start":{"line":70,"column":22},"end":{"line":70,"column":33}},"37":{"start":{"line":71,"column":22},"end":{"line":71,"column":33}},"38":{"start":{"line":73,"column":36},"end":{"line":75,"column":14}},"39":{"start":{"line":74,"column":16},"end":{"line":74,"column":54}},"40":{"start":{"line":76,"column":37},"end":{"line":76,"column":73}},"41":{"start":{"line":77,"column":27},"end":{"line":77,"column":48}},"42":{"start":{"line":79,"column":29},"end":{"line":79,"column":58}},"43":{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},"44":{"start":{"line":82,"column":16},"end":{"line":82,"column":35}},"45":{"start":{"line":83,"column":16},"end":{"line":83,"column":23}},"46":{"start":{"line":84,"column":16},"end":{"line":84,"column":23}},"47":{"start":{"line":87,"column":11},"end":{"line":91,"column":5}},"48":{"start":{"line":88,"column":8},"end":{"line":88,"column":15}},"49":{"start":{"line":90,"column":8},"end":{"line":90,"column":78}}},"fnMap":{"0":{"name":"getJWT","decl":{"start":{"line":15,"column":29},"end":{"line":15,"column":35}},"loc":{"start":{"line":15,"column":38},"end":{"line":55,"column":1}},"line":15},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":24},"end":{"line":16,"column":25}},"loc":{"start":{"line":16,"column":36},"end":{"line":54,"column":5}},"line":16},"2":{"name":"_callee","decl":{"start":{"line":17,"column":85},"end":{"line":17,"column":92}},"loc":{"start":{"line":17,"column":110},"end":{"line":49,"column":9}},"line":17},"3":{"name":"_callee$","decl":{"start":{"line":20,"column":53},"end":{"line":20,"column":61}},"loc":{"start":{"line":20,"column":72},"end":{"line":48,"column":13}},"line":20},"4":{"name":"(anonymous_4)","decl":{"start":{"line":51,"column":15},"end":{"line":51,"column":16}},"loc":{"start":{"line":51,"column":34},"end":{"line":53,"column":9}},"line":51},"5":{"name":"verifyToken","decl":{"start":{"line":57,"column":34},"end":{"line":57,"column":45}},"loc":{"start":{"line":57,"column":62},"end":{"line":92,"column":1}},"line":57},"6":{"name":"(anonymous_6)","decl":{"start":{"line":73,"column":53},"end":{"line":73,"column":54}},"loc":{"start":{"line":73,"column":66},"end":{"line":75,"column":13}},"line":73}},"branchMap":{"0":{"loc":{"start":{"line":22,"column":20},"end":{"line":46,"column":21}},"type":"switch","locations":[{"start":{"line":23,"column":24},"end":{"line":26,"column":55}},{"start":{"line":28,"column":24},"end":{"line":35,"column":34}},{"start":{"line":37,"column":24},"end":{"line":41,"column":48}},{"start":{"line":43,"column":24},"end":{"line":43,"column":32}},{"start":{"line":44,"column":24},"end":{"line":45,"column":51}}],"line":22},"1":{"loc":{"start":{"line":61,"column":4},"end":{"line":91,"column":5}},"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":91,"column":5}},{"start":{"line":61,"column":4},"end":{"line":91,"column":5}}],"line":61},"2":{"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":60}},"type":"binary-expr","locations":[{"start":{"line":61,"column":8},"end":{"line":61,"column":21}},{"start":{"line":61,"column":25},"end":{"line":61,"column":60}}],"line":61},"3":{"loc":{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},{"start":{"line":65,"column":8},"end":{"line":86,"column":9}}],"line":65},"4":{"loc":{"start":{"line":74,"column":23},"end":{"line":74,"column":53}},"type":"binary-expr","locations":[{"start":{"line":74,"column":23},"end":{"line":74,"column":36}},{"start":{"line":74,"column":40},"end":{"line":74,"column":53}}],"line":74},"5":{"loc":{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},"type":"if","locations":[{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},{"start":{"line":81,"column":12},"end":{"line":85,"column":13}}],"line":81},"6":{"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":74}},"type":"binary-expr","locations":[{"start":{"line":81,"column":16},"end":{"line":81,"column":38}},{"start":{"line":81,"column":42},"end":{"line":81,"column":54}},{"start":{"line":81,"column":58},"end":{"line":81,"column":74}}],"line":81},"7":{"loc":{"start":{"line":87,"column":11},"end":{"line":91,"column":5}},"type":"if","locations":[{"start":{"line":87,"column":11},"end":{"line":91,"column":5}},{"start":{"line":87,"column":11},"end":{"line":91,"column":5}}],"line":87},"8":{"loc":{"start":{"line":87,"column":15},"end":{"line":87,"column":626}},"type":"binary-expr","locations":[{"start":{"line":87,"column":15},"end":{"line":87,"column":61}},{"start":{"line":87,"column":65},"end":{"line":87,"column":99}},{"start":{"line":87,"column":103},"end":{"line":87,"column":149}},{"start":{"line":87,"column":153},"end":{"line":87,"column":188}},{"start":{"line":87,"column":192},"end":{"line":87,"column":238}},{"start":{"line":87,"column":242},"end":{"line":87,"column":276}},{"start":{"line":87,"column":280},"end":{"line":87,"column":324}},{"start":{"line":87,"column":328},"end":{"line":87,"column":362}},{"start":{"line":87,"column":366},"end":{"line":87,"column":412}},{"start":{"line":87,"column":416},"end":{"line":87,"column":451}},{"start":{"line":87,"column":455},"end":{"line":87,"column":501}},{"start":{"line":87,"column":505},"end":{"line":87,"column":539}},{"start":{"line":87,"column":543},"end":{"line":87,"column":588}},{"start":{"line":87,"column":592},"end":{"line":87,"column":626}}],"line":87}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":3,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":0,"20":0,"21":0,"22":1,"23":1,"24":1,"25":1,"26":5,"27":5,"28":5,"29":2,"30":2,"31":2,"32":2,"33":2,"34":2,"35":2,"36":2,"37":2,"38":2,"39":4,"40":2,"41":2,"42":2,"43":2,"44":2,"45":2,"46":2,"47":3,"48":3,"49":0},"f":{"0":1,"1":1,"2":1,"3":2,"4":1,"5":5,"6":4},"b":{"0":[1,1,0,1,1],"1":[2,3],"2":[5,2],"3":[2,0],"4":[4,2],"5":[2,0],"6":[2,2,2],"7":[3,0],"8":[3,1,2,2,1,1,0,0,0,0,0,0,0,0]},"inputSourceMap":{"version":3,"sources":["src/api/modules/auth.js"],"names":["axios","jwt","aaud","process","env","COGNITO_AUD","tokenUrl","tokenKeys","getJWT","resolve","reject","get","keys","data","verifyToken","req","res","next","bearerLength","length","authorization","headers","token","slice","tokenData","decode","complete","header","kid","alg","payload","aud","exp","filter","k","matchKey","current_ts","Math","floor","Date","undefined","user","originalUrl","match","method","toLowerCase","status","send","success","error"],"mappings":"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","file":"auth.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import axios from 'axios';\nimport jwt from 'jsonwebtoken';\nconst aaud = process.env.COGNITO_AUD;\nconst tokenUrl = `https://cognito-idp.us-east-2.amazonaws.com/us-east-2_ZAwetvcgl/.well-known/jwks.json`;\n\nlet tokenKeys = null;\n\nexport const getJWT = () => new Promise(async (resolve, reject) => {\n    try {\n        const { data: { keys } } = await axios.get(tokenUrl);\n        tokenKeys  = keys;\n        resolve();\n    } catch (err) {\n        reject(err);\n    }\n});\n\nexport const verifyToken = (req, res, next) => {\n    const bearerLength = \"Bearer \".length;\n    const authorization = req.headers.authorization;\n\n    if (authorization && authorization.length > bearerLength) {\n        const token = authorization.slice(bearerLength);\n        const tokenData = jwt.decode(token, { complete: true });\n\n        if (!!tokenData) {\n            const { header: { kid, alg }, payload } = tokenData;\n            const { aud, exp } = payload;\n            const [ matchKey ] = tokenKeys.filter((k) => (k.kid === kid && k.alg === alg));\n            const current_ts = Math.floor(new Date() / 1000);\n    \n            if (matchKey !== undefined && aaud === aud && current_ts < exp) {\n                req.user = payload;\n                next();\n                return;\n            }\n        }\n    } else if (\n        req.originalUrl.match('/api/invoice') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/payment') !== null && req.method.toLowerCase() === 'post' ||\n        req.originalUrl.match('/api/payment') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/banks') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/dispute') !== null && req.method.toLowerCase() === 'post' ||\n        req.originalUrl.match('/api/dispute') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/verify') !== null && req.method.toLowerCase() === 'get'\n    ) {\n        next(); \n    } else {\n        res.status(403).send({ success: false, error: 'Invalid auth token' });\n    }\n};"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"fce3832adc31411c4c500f19b1afdfd53c8927fc"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/index.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/index.js","statementMap":{"0":{"start":{"line":11,"column":17},"end":{"line":11,"column":33}},"1":{"start":{"line":13,"column":0},"end":{"line":13,"column":39}},"2":{"start":{"line":14,"column":0},"end":{"line":14,"column":37}},"3":{"start":{"line":15,"column":0},"end":{"line":15,"column":41}},"4":{"start":{"line":16,"column":0},"end":{"line":16,"column":41}},"5":{"start":{"line":17,"column":0},"end":{"line":17,"column":53}},"6":{"start":{"line":18,"column":0},"end":{"line":18,"column":54}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/index.js"],"names":["express","VerifyRoute","InvoceRoute","PaymentRoute","DisputeRoute","ConfirmRoute","BanksRoute","verifyToken","MainRouter","Router","use"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;;AAEA,SAASC,WAAT,QAA4B,iBAA5B;;AAEA,IAAMC,aAAaR,QAAQS,MAAR,EAAnB;;AAEAD,WAAWE,GAAX,CAAe,SAAf,EAA0BT,WAA1B;AACAO,WAAWE,GAAX,CAAe,QAAf,EAAyBJ,UAAzB;AACAE,WAAWE,GAAX,CAAe,UAAf,EAA2BL,YAA3B;AACAG,WAAWE,GAAX,CAAe,UAAf,EAA2BN,YAA3B;AACAI,WAAWE,GAAX,CAAe,UAAf,EAA2BH,WAA3B,EAAwCL,WAAxC;AACAM,WAAWE,GAAX,CAAe,UAAf,EAA2BH,WAA3B,EAAwCJ,YAAxC;;AAEA,eAAeK,UAAf","file":"index.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport VerifyRoute from './verify/verify.route';\nimport InvoceRoute from './invoice/invoice.route';\nimport PaymentRoute from './payment/payment.route';\nimport DisputeRoute from './dispute/dispute.route';\nimport ConfirmRoute from './confirm/confirm.route';\nimport BanksRoute from './banks/banks.route';\n\nimport { verifyToken } from '../modules/auth';\n\nconst MainRouter = express.Router();\n\nMainRouter.use('/verify', VerifyRoute);\nMainRouter.use('/banks', BanksRoute);\nMainRouter.use('/confirm', ConfirmRoute);\nMainRouter.use('/dispute', DisputeRoute);\nMainRouter.use('/invoice', verifyToken, InvoceRoute);\nMainRouter.use('/payment', verifyToken, PaymentRoute);\n\nexport default MainRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"3a0d4da55ecc03c2ab222722d7a83c8d9718dbb3"},"/Users/Sleekvick/Projects/pipepay/server/src/config/index.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/config/index.js","statementMap":{"0":{"start":{"line":2,"column":10},"end":{"line":2,"column":30}},"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":24}},"2":{"start":{"line":6,"column":17},"end":{"line":11,"column":1}},"3":{"start":{"line":13,"column":16},"end":{"line":13,"column":18}},"4":{"start":{"line":15,"column":0},"end":{"line":25,"column":1}},"5":{"start":{"line":18,"column":8},"end":{"line":18,"column":44}},"6":{"start":{"line":19,"column":8},"end":{"line":19,"column":14}},"7":{"start":{"line":22,"column":8},"end":{"line":22,"column":45}},"8":{"start":{"line":24,"column":8},"end":{"line":24,"column":44}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":15,"column":0},"end":{"line":25,"column":1}},"type":"switch","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":23}},{"start":{"line":17,"column":4},"end":{"line":19,"column":14}},{"start":{"line":20,"column":4},"end":{"line":20,"column":16}},{"start":{"line":21,"column":4},"end":{"line":22,"column":45}},{"start":{"line":23,"column":4},"end":{"line":24,"column":44}}],"line":15}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1},"f":{},"b":{"0":[0,0,0,0,1]},"inputSourceMap":{"version":3,"sources":["src/config/index.js"],"names":["merge","env","process","NODE_ENV","console","log","baseConfig","port","db","url","envConfig","require","config"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,cAAlB;AACA,IAAMC,MAAMC,QAAQD,GAAR,CAAYE,QAAxB;;AAEAC,QAAQC,GAAR,CAAY,KAAZ,EAAmBJ,GAAnB;;AAEA,IAAMK,aAAa;AACfC,UAAM,IADS;AAEfC,QAAI;AACAC,aAAK;AADL;AAFW,CAAnB;;AAOA,IAAIC,YAAY,EAAhB;;AAEA,QAAQT,GAAR;AACI,SAAK,aAAL;AACA,SAAK,KAAL;AACIS,oBAAYC,QAAQ,OAAR,EAAiBC,MAA7B;AACA;AACJ,SAAK,MAAL;AACA,SAAK,YAAL;AACIF,oBAAYC,QAAQ,QAAR,EAAkBC,MAA9B;AACJ;AACIF,oBAAYC,QAAQ,OAAR,EAAiBC,MAA7B;AATR;;AAYA,eAAeZ,MAAMM,UAAN,EAAkBI,SAAlB,CAAf","file":"index.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import merge from 'lodash.merge';\nconst env = process.env.NODE_ENV\n\nconsole.log('env', env);\n\nconst baseConfig = {\n    port: 3000,\n    db: {\n        url: ''\n    }\n}\n\nlet envConfig = {}\n\nswitch (env) {\n    case 'development':\n    case 'dev':\n        envConfig = require('./dev').config\n        break;\n    case 'prod':\n    case 'production':\n        envConfig = require('./prod').config\n    default:\n        envConfig = require('./dev').config \n}\n\nexport default merge(baseConfig, envConfig)"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"12b98bce8cc8749db5861f0b1c175fec28356b2a"},"/Users/Sleekvick/Projects/pipepay/server/src/config/dev.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/config/dev.js","statementMap":{"0":{"start":{"line":1,"column":15},"end":{"line":1,"column":34}},"1":{"start":{"line":2,"column":15},"end":{"line":2,"column":38}},"2":{"start":{"line":4,"column":20},"end":{"line":8,"column":1}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/config/dev.js"],"names":["username","process","env","DB_USER","password","DB_PASSWORD","config","db","url"],"mappings":"AAAA,IAAMA,WAAWC,QAAQC,GAAR,CAAYC,OAA7B;AACA,IAAMC,WAAWH,QAAQC,GAAR,CAAYG,WAA7B;;AAEA,OAAO,IAAMC,SAAS;AAClBC,QAAI;AACAC;AADA;AADc,CAAf","file":"dev.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["const username = process.env.DB_USER;\nconst password = process.env.DB_PASSWORD;\n\nexport const config = {\n    db: {\n        url: `mongodb://localhost:27017/pipepay`\n    }\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"7fd446ce6880388639c06c2698ea81f288331135"},"/Users/Sleekvick/Projects/pipepay/server/src/db.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/db.js","statementMap":{"0":{"start":{"line":4,"column":0},"end":{"line":4,"column":34}},"1":{"start":{"line":6,"column":21},"end":{"line":10,"column":1}},"2":{"start":{"line":7,"column":17},"end":{"line":7,"column":94}},"3":{"start":{"line":9,"column":4},"end":{"line":9,"column":70}}},"fnMap":{"0":{"name":"connect","decl":{"start":{"line":6,"column":30},"end":{"line":6,"column":37}},"loc":{"start":{"line":6,"column":40},"end":{"line":10,"column":1}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":94}},"type":"cond-expr","locations":[{"start":{"line":7,"column":70},"end":{"line":7,"column":82}},{"start":{"line":7,"column":85},"end":{"line":7,"column":94}}],"line":7},"1":{"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":67}},"type":"binary-expr","locations":[{"start":{"line":7,"column":17},"end":{"line":7,"column":37}},{"start":{"line":7,"column":41},"end":{"line":7,"column":67}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{"0":[0,1],"1":[1,0]},"inputSourceMap":{"version":3,"sources":["src/db.js"],"names":["mongoose","appConfig","Promise","global","connect","config","db","url","useNewUrlParser"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;AACA,OAAOC,SAAP,MAAsB,UAAtB;;AAEAD,SAASE,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,OAAO,IAAME,UAAU,SAAVA,OAAU,GAAwB;AAAA,QAAvBC,MAAuB,uEAAdJ,SAAc;;AAC3C,WAAOD,SAASI,OAAT,CAAiBC,OAAOC,EAAP,CAAUC,GAA3B,EAAgC,EAAEC,iBAAiB,IAAnB,EAAhC,CAAP;AACH,CAFM","file":"db.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose'\nimport appConfig from './config'\n\nmongoose.Promise = global.Promise\n\nexport const connect = (config = appConfig) => {\n    return mongoose.connect(config.db.url, { useNewUrlParser: true });\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"16ad6e924b87568ea46f15e9dda6e9bad4f67d09"},"/Users/Sleekvick/Projects/pipepay/server/src/server.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/server.js","statementMap":{"0":{"start":{"line":7,"column":10},"end":{"line":7,"column":19}},"1":{"start":{"line":9,"column":0},"end":{"line":9,"column":9}},"2":{"start":{"line":10,"column":0},"end":{"line":10,"column":21}},"3":{"start":{"line":12,"column":0},"end":{"line":16,"column":3}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":51}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":97}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":11}},"7":{"start":{"line":18,"column":0},"end":{"line":20,"column":3}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":35}},"9":{"start":{"line":22,"column":0},"end":{"line":22,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":8},"end":{"line":12,"column":9}},"loc":{"start":{"line":12,"column":34},"end":{"line":16,"column":1}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":18,"column":16},"end":{"line":18,"column":17}},"loc":{"start":{"line":18,"column":31},"end":{"line":20,"column":1}},"line":18}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":13,"5":13,"6":13,"7":1,"8":0,"9":1},"f":{"0":13,"1":0},"b":{},"inputSourceMap":{"version":3,"sources":["src/server.js"],"names":["express","setupMiddleware","MainRouter","connect","getJWT","app","use","req","res","next","header","catch","err","console","error"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,eAAP,MAA4B,cAA5B;AACA,OAAOC,UAAP,MAAuB,iBAAvB;AACA,SAASC,OAAT,QAAwB,MAAxB;AACA,SAASC,MAAT,QAAuB,oBAAvB;;AAEA,IAAMC,MAAML,SAAZ;;AAEAI;AACAH,gBAAgBI,GAAhB;;AAEAA,IAAIC,GAAJ,CAAQ,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC7BD,QAAIE,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;AACAF,QAAIE,MAAJ,CAAW,8BAAX,EAA2C,gDAA3C;AACAD;AACH,CAJD;;AAOAN,UAAUQ,KAAV,CAAgB,UAACC,GAAD,EAAS;AACrBC,YAAQC,KAAR,CAAc,UAAd,EAA0BF,GAA1B;AACH,CAFD;;AAIAP,IAAIC,GAAJ,CAAQ,MAAR,EAAgBJ,UAAhB;;AAEA,eAAeG,GAAf","file":"server.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport setupMiddleware from './middleware';\nimport MainRouter from './api/resources';\nimport { connect } from './db';\nimport { getJWT } from './api/modules/auth';\n\nconst app = express();\n\ngetJWT();\nsetupMiddleware(app);\n\napp.use(function(req, res, next) {\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Content-Type, Accept\");\n    next();\n});\n\n  \nconnect().catch((err) => {\n    console.error('DB error', err);\n});\n\napp.use('/api', MainRouter);\n\nexport default app;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"4b54c3419e1a6546ab1e2f8c8742feccc3dabd31"},"/Users/Sleekvick/Projects/pipepay/server/src/test-helpers/auth.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/test-helpers/auth.js","statementMap":{"0":{"start":{"line":10,"column":11},"end":{"line":10,"column":34}},"1":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}},"2":{"start":{"line":14,"column":25},"end":{"line":28,"column":1}},"3":{"start":{"line":15,"column":14},"end":{"line":15,"column":39}},"4":{"start":{"line":16,"column":2},"end":{"line":27,"column":5}},"5":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"6":{"start":{"line":18,"column":6},"end":{"line":18,"column":23}},"7":{"start":{"line":20,"column":4},"end":{"line":26,"column":7}},"8":{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},"9":{"start":{"line":22,"column":8},"end":{"line":22,"column":20}},"10":{"start":{"line":24,"column":8},"end":{"line":24,"column":18}},"11":{"start":{"line":30,"column":20},"end":{"line":34,"column":1}},"12":{"start":{"line":31,"column":2},"end":{"line":33,"column":5}},"13":{"start":{"line":32,"column":4},"end":{"line":32,"column":64}},"14":{"start":{"line":36,"column":22},"end":{"line":39,"column":2}},"15":{"start":{"line":41,"column":20},"end":{"line":61,"column":1}},"16":{"start":{"line":42,"column":2},"end":{"line":60,"column":5}},"17":{"start":{"line":43,"column":29},"end":{"line":46,"column":5}},"18":{"start":{"line":48,"column":19},"end":{"line":51,"column":5}},"19":{"start":{"line":53,"column":22},"end":{"line":53,"column":47}},"20":{"start":{"line":54,"column":32},"end":{"line":54,"column":77}},"21":{"start":{"line":56,"column":4},"end":{"line":59,"column":7}}},"fnMap":{"0":{"name":"removeModel","decl":{"start":{"line":14,"column":34},"end":{"line":14,"column":45}},"loc":{"start":{"line":14,"column":57},"end":{"line":28,"column":1}},"line":14},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":22},"end":{"line":16,"column":23}},"loc":{"start":{"line":16,"column":49},"end":{"line":27,"column":3}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":17},"end":{"line":20,"column":18}},"loc":{"start":{"line":20,"column":32},"end":{"line":26,"column":5}},"line":20},"3":{"name":"dropDb","decl":{"start":{"line":30,"column":29},"end":{"line":30,"column":35}},"loc":{"start":{"line":30,"column":38},"end":{"line":34,"column":1}},"line":30},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":73},"end":{"line":31,"column":74}},"loc":{"start":{"line":31,"column":85},"end":{"line":33,"column":3}},"line":31},"5":{"name":"signin","decl":{"start":{"line":41,"column":29},"end":{"line":41,"column":35}},"loc":{"start":{"line":41,"column":56},"end":{"line":61,"column":1}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":42,"column":22},"end":{"line":42,"column":23}},"loc":{"start":{"line":42,"column":49},"end":{"line":60,"column":3}},"line":42}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},{"start":{"line":17,"column":4},"end":{"line":19,"column":5}}],"line":17},"1":{"loc":{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},"type":"if","locations":[{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},{"start":{"line":21,"column":6},"end":{"line":25,"column":7}}],"line":21}},"s":{"0":1,"1":1,"2":1,"3":3,"4":3,"5":3,"6":0,"7":3,"8":3,"9":0,"10":3,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1},"f":{"0":3,"1":3,"2":3,"3":1,"4":1,"5":1,"6":1},"b":{"0":[0,3],"1":[0,3]},"inputSourceMap":{"version":3,"sources":["src/test-helpers/auth.js"],"names":["AuthenticationDetails","CognitoUserPool","CognitoUser","mongoose","config","aaud","process","env","COGNITO_AUD","Promise","global","removeModel","modelName","model","resolve","reject","remove","err","dropDb","connect","db","url","useNewUrlParser","then","all","modelNames","map","userPool","UserPoolId","ClientId","signin","Username","Password","authenticationData","userData","Pool","cognitoUser","authenticationDetails","authenticateUser","onSuccess","onFailure"],"mappings":";AAAA,OAAO,wCAAP;AACA,OAAO,wCAAP;AACA,OAAO,wCAAP;;AAEA,SAASA,qBAAT,EAAgCC,eAAhC,EAAiDC,WAAjD,QAAoE,4BAApE;;AAEA,OAAOC,QAAP,MAAqB,UAArB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,IAAMC,OAAOC,QAAQC,GAAR,CAAYC,WAAzB;;AAEAL,SAASM,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,OAAO,IAAME,cAAc,SAAdA,WAAc,CAACC,SAAD,EAAe;AACxC,MAAMC,QAAQV,SAASU,KAAT,CAAeD,SAAf,CAAd;AACA,SAAO,aAAY,UAACE,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAI,CAACF,KAAL,EAAY;AACV,aAAOC,SAAP;AACD;AACDD,UAAMG,MAAN,CAAa,UAACC,GAAD,EAAS;AACpB,UAAIA,GAAJ,EAAS;AACPF,eAAOE,GAAP;AACD,OAFD,MAEO;AACLH;AACD;AACF,KAND;AAOD,GAXM,CAAP;AAYD,CAdM;;AAgBP,OAAO,IAAMI,SAAS,SAATA,MAAS,GAAM;AAC1B,SAAOf,SAASgB,OAAT,CAAiBf,OAAOgB,EAAP,CAAUC,GAA3B,EAAgC,EAAEC,iBAAiB,IAAnB,EAAhC,EAA2DC,IAA3D,CAAgE;AAAA,WAAM,SAAQC,GAAR,CAAYrB,SAASsB,UAAT,GAAsBC,GAAtB,CAA0Bf,WAA1B,CAAZ,CAAN;AAAA,GAAhE,CAAP;AACD,CAFM;;AAIP,OAAO,IAAMgB,WAAW,IAAI1B,eAAJ,CAAoB;AAC1C2B,cAAY,qBAD8B;AAE1CC,YAAUxB;AAFgC,CAApB,CAAjB;;AAKP,OAAO,IAAMyB,SAAS,SAATA,MAAS,CAACC,QAAD,EAAWC,QAAX;AAAA,SAAwB,aAAY,UAAClB,OAAD,EAAUC,MAAV,EAAqB;AAC7E,QAAIkB,qBAAqB;AACvBF,wBADuB;AAEvBC;AAFuB,KAAzB;;AAKA,QAAIE,WAAW;AACbH,wBADa;AAEbI,YAAMR;AAFO,KAAf;;AAKA,QAAMS,cAAc,IAAIlC,WAAJ,CAAgBgC,QAAhB,CAApB;AACA,QAAIG,wBAAwB,IAAIrC,qBAAJ,CAA0BiC,kBAA1B,CAA5B;;AAEAG,gBAAYE,gBAAZ,CAA6BD,qBAA7B,EAAoD;AAClDE,iBAAWzB,OADuC;AAElD0B,iBAAWzB;AAFuC,KAApD;AAID,GAlB6C,CAAxB;AAAA,CAAf","file":"auth.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import '../api/resources/dispute/dispute.model'\nimport '../api/resources/invoice/invoice.model'\nimport '../api/resources/payment/payment.model'\n\nimport { AuthenticationDetails, CognitoUserPool, CognitoUser } from 'amazon-cognito-identity-js';\n\nimport mongoose from 'mongoose'\nimport config from '../config'\nconst aaud = process.env.COGNITO_AUD;\n\nmongoose.Promise = global.Promise\n\nexport const removeModel = (modelName) => {\n  const model = mongoose.model(modelName)\n  return new Promise((resolve, reject) => {\n    if (!model) {\n      return resolve()\n    }\n    model.remove((err) => {\n      if (err) {\n        reject(err)\n      } else {\n        resolve()\n      }\n    })\n  })\n}\n\nexport const dropDb = () => {\n  return mongoose.connect(config.db.url, { useNewUrlParser: true }).then(() => Promise.all(mongoose.modelNames().map(removeModel)))\n}\n\nexport const userPool = new CognitoUserPool({\n  UserPoolId: 'us-east-2_ZAwetvcgl',\n  ClientId: aaud\n});\n\nexport const signin = (Username, Password) => new Promise((resolve, reject) => {\n  let authenticationData = {\n    Username,\n    Password\n  };\n\n  let userData = {\n    Username,\n    Pool: userPool   \n  }\n\n  const cognitoUser = new CognitoUser(userData);\n  let authenticationDetails = new AuthenticationDetails(authenticationData);\n\n  cognitoUser.authenticateUser(authenticationDetails, {\n    onSuccess: resolve,\n    onFailure: reject\n  });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"0fd5e5af5555499341b1949e56d82fa8a4594af5"},"/Users/Sleekvick/Projects/pipepay/server/src/server.spec.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/server.spec.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":15,"column":15},"end":{"line":15,"column":40}},"2":{"start":{"line":16,"column":15},"end":{"line":16,"column":40}},"3":{"start":{"line":17,"column":13},"end":{"line":17,"column":40}},"4":{"start":{"line":18,"column":11},"end":{"line":18,"column":33}},"5":{"start":{"line":19,"column":13},"end":{"line":19,"column":24}},"6":{"start":{"line":21,"column":0},"end":{"line":21,"column":19}},"7":{"start":{"line":22,"column":0},"end":{"line":22,"column":46}},"8":{"start":{"line":24,"column":0},"end":{"line":24,"column":9}},"9":{"start":{"line":26,"column":0},"end":{"line":227,"column":3}},"10":{"start":{"line":28,"column":16},"end":{"line":28,"column":22}},"11":{"start":{"line":29,"column":15},"end":{"line":29,"column":21}},"12":{"start":{"line":30,"column":20},"end":{"line":30,"column":30}},"13":{"start":{"line":31,"column":20},"end":{"line":31,"column":24}},"14":{"start":{"line":32,"column":23},"end":{"line":32,"column":27}},"15":{"start":{"line":33,"column":25},"end":{"line":33,"column":29}},"16":{"start":{"line":35,"column":4},"end":{"line":72,"column":9}},"17":{"start":{"line":37,"column":8},"end":{"line":71,"column":37}},"18":{"start":{"line":38,"column":12},"end":{"line":70,"column":13}},"19":{"start":{"line":39,"column":16},"end":{"line":69,"column":17}},"20":{"start":{"line":41,"column":24},"end":{"line":41,"column":42}},"21":{"start":{"line":42,"column":24},"end":{"line":42,"column":42}},"22":{"start":{"line":43,"column":24},"end":{"line":43,"column":58}},"23":{"start":{"line":46,"column":24},"end":{"line":46,"column":64}},"24":{"start":{"line":48,"column":24},"end":{"line":57,"column":27}},"25":{"start":{"line":49,"column":28},"end":{"line":49,"column":56}},"26":{"start":{"line":49,"column":37},"end":{"line":49,"column":56}},"27":{"start":{"line":51,"column":28},"end":{"line":54,"column":29}},"28":{"start":{"line":52,"column":32},"end":{"line":52,"column":74}},"29":{"start":{"line":53,"column":32},"end":{"line":53,"column":67}},"30":{"start":{"line":56,"column":28},"end":{"line":56,"column":65}},"31":{"start":{"line":58,"column":24},"end":{"line":58,"column":43}},"32":{"start":{"line":59,"column":24},"end":{"line":59,"column":30}},"33":{"start":{"line":62,"column":24},"end":{"line":62,"column":42}},"34":{"start":{"line":63,"column":24},"end":{"line":63,"column":59}},"35":{"start":{"line":64,"column":24},"end":{"line":64,"column":42}},"36":{"start":{"line":68,"column":24},"end":{"line":68,"column":47}},"37":{"start":{"line":74,"column":4},"end":{"line":94,"column":7}},"38":{"start":{"line":75,"column":8},"end":{"line":93,"column":11}},"39":{"start":{"line":88,"column":12},"end":{"line":88,"column":54}},"40":{"start":{"line":89,"column":12},"end":{"line":89,"column":42}},"41":{"start":{"line":90,"column":12},"end":{"line":90,"column":70}},"42":{"start":{"line":91,"column":12},"end":{"line":91,"column":55}},"43":{"start":{"line":92,"column":12},"end":{"line":92,"column":19}},"44":{"start":{"line":96,"column":4},"end":{"line":103,"column":7}},"45":{"start":{"line":97,"column":8},"end":{"line":102,"column":11}},"46":{"start":{"line":98,"column":12},"end":{"line":98,"column":61}},"47":{"start":{"line":99,"column":12},"end":{"line":99,"column":65}},"48":{"start":{"line":100,"column":12},"end":{"line":100,"column":55}},"49":{"start":{"line":101,"column":12},"end":{"line":101,"column":19}},"50":{"start":{"line":105,"column":4},"end":{"line":132,"column":7}},"51":{"start":{"line":106,"column":22},"end":{"line":122,"column":9}},"52":{"start":{"line":124,"column":19},"end":{"line":124,"column":101}},"53":{"start":{"line":126,"column":8},"end":{"line":131,"column":11}},"54":{"start":{"line":129,"column":12},"end":{"line":129,"column":48}},"55":{"start":{"line":130,"column":12},"end":{"line":130,"column":19}},"56":{"start":{"line":134,"column":4},"end":{"line":140,"column":7}},"57":{"start":{"line":135,"column":8},"end":{"line":139,"column":11}},"58":{"start":{"line":136,"column":12},"end":{"line":136,"column":67}},"59":{"start":{"line":137,"column":12},"end":{"line":137,"column":55}},"60":{"start":{"line":138,"column":12},"end":{"line":138,"column":19}},"61":{"start":{"line":142,"column":4},"end":{"line":147,"column":7}},"62":{"start":{"line":143,"column":8},"end":{"line":146,"column":11}},"63":{"start":{"line":144,"column":12},"end":{"line":144,"column":55}},"64":{"start":{"line":145,"column":12},"end":{"line":145,"column":19}},"65":{"start":{"line":149,"column":4},"end":{"line":156,"column":7}},"66":{"start":{"line":150,"column":8},"end":{"line":155,"column":11}},"67":{"start":{"line":153,"column":12},"end":{"line":153,"column":56}},"68":{"start":{"line":154,"column":12},"end":{"line":154,"column":19}},"69":{"start":{"line":158,"column":4},"end":{"line":167,"column":7}},"70":{"start":{"line":159,"column":8},"end":{"line":166,"column":11}},"71":{"start":{"line":163,"column":12},"end":{"line":163,"column":65}},"72":{"start":{"line":164,"column":12},"end":{"line":164,"column":55}},"73":{"start":{"line":165,"column":12},"end":{"line":165,"column":19}},"74":{"start":{"line":169,"column":4},"end":{"line":178,"column":7}},"75":{"start":{"line":170,"column":8},"end":{"line":177,"column":11}},"76":{"start":{"line":174,"column":12},"end":{"line":174,"column":65}},"77":{"start":{"line":175,"column":12},"end":{"line":175,"column":55}},"78":{"start":{"line":176,"column":12},"end":{"line":176,"column":19}},"79":{"start":{"line":180,"column":4},"end":{"line":187,"column":7}},"80":{"start":{"line":181,"column":8},"end":{"line":186,"column":11}},"81":{"start":{"line":182,"column":12},"end":{"line":182,"column":51}},"82":{"start":{"line":183,"column":12},"end":{"line":183,"column":62}},"83":{"start":{"line":184,"column":12},"end":{"line":184,"column":55}},"84":{"start":{"line":185,"column":12},"end":{"line":185,"column":19}},"85":{"start":{"line":189,"column":4},"end":{"line":195,"column":7}},"86":{"start":{"line":190,"column":8},"end":{"line":194,"column":11}},"87":{"start":{"line":191,"column":12},"end":{"line":191,"column":69}},"88":{"start":{"line":192,"column":12},"end":{"line":192,"column":55}},"89":{"start":{"line":193,"column":12},"end":{"line":193,"column":19}},"90":{"start":{"line":197,"column":4},"end":{"line":209,"column":7}},"91":{"start":{"line":198,"column":8},"end":{"line":208,"column":11}},"92":{"start":{"line":205,"column":12},"end":{"line":205,"column":60}},"93":{"start":{"line":206,"column":12},"end":{"line":206,"column":55}},"94":{"start":{"line":207,"column":12},"end":{"line":207,"column":19}},"95":{"start":{"line":211,"column":4},"end":{"line":217,"column":7}},"96":{"start":{"line":212,"column":8},"end":{"line":216,"column":11}},"97":{"start":{"line":213,"column":12},"end":{"line":213,"column":58}},"98":{"start":{"line":214,"column":12},"end":{"line":214,"column":55}},"99":{"start":{"line":215,"column":12},"end":{"line":215,"column":19}},"100":{"start":{"line":219,"column":4},"end":{"line":226,"column":7}},"101":{"start":{"line":220,"column":8},"end":{"line":225,"column":11}},"102":{"start":{"line":223,"column":12},"end":{"line":223,"column":55}},"103":{"start":{"line":224,"column":12},"end":{"line":224,"column":19}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":26,"column":30},"end":{"line":26,"column":31}},"loc":{"start":{"line":26,"column":42},"end":{"line":227,"column":1}},"line":26},"1":{"name":"_callee","decl":{"start":{"line":35,"column":82},"end":{"line":35,"column":89}},"loc":{"start":{"line":35,"column":92},"end":{"line":72,"column":5}},"line":35},"2":{"name":"_callee$","decl":{"start":{"line":37,"column":49},"end":{"line":37,"column":57}},"loc":{"start":{"line":37,"column":68},"end":{"line":71,"column":9}},"line":37},"3":{"name":"(anonymous_3)","decl":{"start":{"line":48,"column":47},"end":{"line":48,"column":48}},"loc":{"start":{"line":48,"column":70},"end":{"line":57,"column":25}},"line":48},"4":{"name":"(anonymous_4)","decl":{"start":{"line":74,"column":25},"end":{"line":74,"column":26}},"loc":{"start":{"line":74,"column":41},"end":{"line":94,"column":5}},"line":74},"5":{"name":"(anonymous_5)","decl":{"start":{"line":87,"column":15},"end":{"line":87,"column":16}},"loc":{"start":{"line":87,"column":35},"end":{"line":93,"column":9}},"line":87},"6":{"name":"(anonymous_6)","decl":{"start":{"line":96,"column":26},"end":{"line":96,"column":27}},"loc":{"start":{"line":96,"column":42},"end":{"line":103,"column":5}},"line":96},"7":{"name":"(anonymous_7)","decl":{"start":{"line":97,"column":63},"end":{"line":97,"column":64}},"loc":{"start":{"line":97,"column":83},"end":{"line":102,"column":9}},"line":97},"8":{"name":"(anonymous_8)","decl":{"start":{"line":105,"column":25},"end":{"line":105,"column":26}},"loc":{"start":{"line":105,"column":41},"end":{"line":132,"column":5}},"line":105},"9":{"name":"(anonymous_9)","decl":{"start":{"line":128,"column":29},"end":{"line":128,"column":30}},"loc":{"start":{"line":128,"column":49},"end":{"line":131,"column":9}},"line":128},"10":{"name":"(anonymous_10)","decl":{"start":{"line":134,"column":22},"end":{"line":134,"column":23}},"loc":{"start":{"line":134,"column":38},"end":{"line":140,"column":5}},"line":134},"11":{"name":"(anonymous_11)","decl":{"start":{"line":135,"column":63},"end":{"line":135,"column":64}},"loc":{"start":{"line":135,"column":83},"end":{"line":139,"column":9}},"line":135},"12":{"name":"(anonymous_12)","decl":{"start":{"line":142,"column":41},"end":{"line":142,"column":42}},"loc":{"start":{"line":142,"column":57},"end":{"line":147,"column":5}},"line":142},"13":{"name":"(anonymous_13)","decl":{"start":{"line":143,"column":62},"end":{"line":143,"column":63}},"loc":{"start":{"line":143,"column":82},"end":{"line":146,"column":9}},"line":143},"14":{"name":"(anonymous_14)","decl":{"start":{"line":149,"column":44},"end":{"line":149,"column":45}},"loc":{"start":{"line":149,"column":60},"end":{"line":156,"column":5}},"line":149},"15":{"name":"(anonymous_15)","decl":{"start":{"line":152,"column":15},"end":{"line":152,"column":16}},"loc":{"start":{"line":152,"column":35},"end":{"line":155,"column":9}},"line":152},"16":{"name":"(anonymous_16)","decl":{"start":{"line":158,"column":36},"end":{"line":158,"column":37}},"loc":{"start":{"line":158,"column":52},"end":{"line":167,"column":5}},"line":158},"17":{"name":"(anonymous_17)","decl":{"start":{"line":162,"column":15},"end":{"line":162,"column":16}},"loc":{"start":{"line":162,"column":35},"end":{"line":166,"column":9}},"line":162},"18":{"name":"(anonymous_18)","decl":{"start":{"line":169,"column":36},"end":{"line":169,"column":37}},"loc":{"start":{"line":169,"column":52},"end":{"line":178,"column":5}},"line":169},"19":{"name":"(anonymous_19)","decl":{"start":{"line":173,"column":15},"end":{"line":173,"column":16}},"loc":{"start":{"line":173,"column":35},"end":{"line":177,"column":9}},"line":173},"20":{"name":"(anonymous_20)","decl":{"start":{"line":180,"column":28},"end":{"line":180,"column":29}},"loc":{"start":{"line":180,"column":44},"end":{"line":187,"column":5}},"line":180},"21":{"name":"(anonymous_21)","decl":{"start":{"line":181,"column":49},"end":{"line":181,"column":50}},"loc":{"start":{"line":181,"column":69},"end":{"line":186,"column":9}},"line":181},"22":{"name":"(anonymous_22)","decl":{"start":{"line":189,"column":33},"end":{"line":189,"column":34}},"loc":{"start":{"line":189,"column":49},"end":{"line":195,"column":5}},"line":189},"23":{"name":"(anonymous_23)","decl":{"start":{"line":190,"column":89},"end":{"line":190,"column":90}},"loc":{"start":{"line":190,"column":109},"end":{"line":194,"column":9}},"line":190},"24":{"name":"(anonymous_24)","decl":{"start":{"line":197,"column":25},"end":{"line":197,"column":26}},"loc":{"start":{"line":197,"column":41},"end":{"line":209,"column":5}},"line":197},"25":{"name":"(anonymous_25)","decl":{"start":{"line":204,"column":15},"end":{"line":204,"column":16}},"loc":{"start":{"line":204,"column":35},"end":{"line":208,"column":9}},"line":204},"26":{"name":"(anonymous_26)","decl":{"start":{"line":211,"column":22},"end":{"line":211,"column":23}},"loc":{"start":{"line":211,"column":38},"end":{"line":217,"column":5}},"line":211},"27":{"name":"(anonymous_27)","decl":{"start":{"line":212,"column":63},"end":{"line":212,"column":64}},"loc":{"start":{"line":212,"column":83},"end":{"line":216,"column":9}},"line":212},"28":{"name":"(anonymous_28)","decl":{"start":{"line":219,"column":25},"end":{"line":219,"column":26}},"loc":{"start":{"line":219,"column":41},"end":{"line":226,"column":5}},"line":219},"29":{"name":"(anonymous_29)","decl":{"start":{"line":222,"column":15},"end":{"line":222,"column":16}},"loc":{"start":{"line":222,"column":35},"end":{"line":225,"column":9}},"line":222}},"branchMap":{"0":{"loc":{"start":{"line":39,"column":16},"end":{"line":69,"column":17}},"type":"switch","locations":[{"start":{"line":40,"column":20},"end":{"line":43,"column":58}},{"start":{"line":45,"column":20},"end":{"line":59,"column":30}},{"start":{"line":61,"column":20},"end":{"line":64,"column":42}},{"start":{"line":66,"column":20},"end":{"line":66,"column":28}},{"start":{"line":67,"column":20},"end":{"line":68,"column":47}}],"line":39},"1":{"loc":{"start":{"line":49,"column":28},"end":{"line":49,"column":56}},"type":"if","locations":[{"start":{"line":49,"column":28},"end":{"line":49,"column":56}},{"start":{"line":49,"column":28},"end":{"line":49,"column":56}}],"line":49},"2":{"loc":{"start":{"line":51,"column":28},"end":{"line":54,"column":29}},"type":"if","locations":[{"start":{"line":51,"column":28},"end":{"line":54,"column":29}},{"start":{"line":51,"column":28},"end":{"line":54,"column":29}}],"line":51},"3":{"loc":{"start":{"line":51,"column":32},"end":{"line":51,"column":58}},"type":"binary-expr","locations":[{"start":{"line":51,"column":32},"end":{"line":51,"column":38}},{"start":{"line":51,"column":42},"end":{"line":51,"column":58}}],"line":51}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":2,"19":3,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":1,"58":1,"59":1,"60":1,"61":1,"62":1,"63":1,"64":1,"65":1,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":1,"79":1,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":1,"88":1,"89":1,"90":1,"91":1,"92":1,"93":1,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":1,"101":1,"102":1,"103":1},"f":{"0":1,"1":1,"2":2,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1},"b":{"0":[1,1,0,1,1],"1":[0,1],"2":[1,0],"3":[1,1]},"inputSourceMap":{"version":3,"sources":["src/server.spec.js"],"names":["chai","chaiHttp","axios","MockAdapter","crypto","app","signin","userPool","dropDb","username","process","env","TEST_USERNAME","password","TEST_PASSWORD","secret","PAYSTACK_SECRET","mock","expect","use","global","fetch","require","describe","token","user","emailCode","invoiceId","invoice_code","accessBankCode","it","cognitoUser","getCurrentUser","getSession","err","result","console","error","isValid","getIdToken","getJwtToken","payload","to","have","property","done","request","post","set","send","description","deliveryAmount","purchaseAmount","customerName","customerEmail","customerPhone","marchantName","marchantAccountNumber","marchantBankCode","end","res","body","data","_id","be","success","equal","get","payment","event","paid","status","amount","transaction","reference","customer","first_name","last_name","email","hash","createHmac","update","digest","accepted","code","length","greaterThan","haveOwnProperty","marchantEmail","category","from","reason","delete"],"mappings":"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","file":"server.spec.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import chai from 'chai';\nimport chaiHttp from 'chai-http';\nimport axios from 'axios';\nimport MockAdapter from 'axios-mock-adapter';\nimport crypto from 'crypto';\nimport app from './server';\nimport { signin, userPool, dropDb } from './test-helpers/auth';\n\nconst username = process.env.TEST_USERNAME;\nconst password = process.env.TEST_PASSWORD;\nconst secret = process.env.PAYSTACK_SECRET;\nconst mock = new MockAdapter(axios);\nconst expect = chai.expect;\n\nchai.use(chaiHttp);\nglobal.fetch = require('node-fetch-polyfill');\n\ndropDb();\n\ndescribe('Server Operations', () => {\n    \n    let token;\n    let user;\n    let emailCode = 'AXYZ0000';\n    let invoiceId = null;\n    let invoice_code = null;\n    let accessBankCode = null;\n\n    it('Login', async () => {\n        try {\n            await signin(username, password);\n            const cognitoUser = userPool.getCurrentUser();    \n            cognitoUser.getSession((err, result) => {\n                if (err) console.error(err);\n\n                if (result && result.isValid()) {\n                    token = result.getIdToken().getJwtToken();\n                    user = result.getIdToken().payload;\n                }\n\n                expect(user).to.have.property('sub');\n            });\n        } catch (err) {\n            throw err;\n        }\n    });\n\n\n    it('create invoice', (done) => {\n        chai.request(app)\n        .post('/api/invoice')\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .send({\n            description: \"This is an invoice\",\n            deliveryAmount: 500,\n            purchaseAmount: 5000,\n            customerName: 'Victor Nwaokocha',\n            customerEmail: 'vnwaokocha@gmail.com',\n            customerPhone: '09098612833',\n            marchantName: 'Emeka Chukwu',\n            marchantAccountNumber: user['custom:account_number'],\n            marchantBankCode: user['custom:bank_code']\n        })\n        .end((err, res) => {\n            invoice_code = res.body.data.invoice_code;\n            invoiceId = res.body.data._id;\n            expect(res.body.data).to.be.have.property('invoice_code');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n\n    it('retrive invoice', (done) => {\n        chai.request(app)\n        .get('/api/invoice/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.data._id).to.be.equal(invoiceId);\n            expect(res.body.data).to.have.property('totalPrice');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('create payment', (done) => {\n        const payment = {\n            event: 'invoice.update',\n            data: {\n                paid: true,\n                status: \"success\",\n                amount: 200000,\n                invoice_code,\n                transaction: {\n                    reference: \"1234\",\n                },\n                customer: { \n                    first_name: 'Victor',\n                    last_name: 'Nwaokocha',\n                    email: 'nvonweb@outlook.com',\n                } \n            }\n        };\n        \n        const hash = crypto.createHmac('sha512', secret).update(JSON.stringify(payment)).digest('hex');\n\n        chai.request(app)\n        .post('/api/payment')\n        .set({\n            'X-Paystack-Signature': hash\n        })\n        .send(payment)\n        .end((err, res) => {\n            expect(res.status).to.be.equal(200);\n            done();\n        });\n\n    });\n\n    it('get payment', (done) => {\n        chai.request(app)\n        .get('/api/payment/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.data.invoiceId).to.be.equal(invoiceId);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('send customer verifcation mail', (done) => {\n        chai.request(app)\n        .get('/api/verify/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('do not confirm without email code', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            accepted: true\n        })\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(false);\n            done();\n        });\n    });\n\n    it('confirm payment::accepted', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            emailCode,\n            accepted: true\n        })\n        .end((err, res) => {\n            expect(res.body.data.status).to.be.equal(\"accepted\");\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('confirm payment::rejected', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            emailCode,\n            accepted: false\n        })\n        .end((err, res) => {\n            expect(res.body.data.status).to.be.equal(\"rejected\");\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('get list of banks', (done) => {\n        chai.request(app)\n        .get('/api/banks/')\n        .end((err, res) => {\n            accessBankCode = res.body.data[0].code;\n            expect(res.body.data.length).to.be.greaterThan(2);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('confirm account number', (done) => {\n        chai.request(app)\n        .get(`/api/banks/verify/${accessBankCode}/0695257934`)\n        .end((err, res) => {\n            expect(res.body.data).to.haveOwnProperty('account_name');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    })\n    \n    it('create dispute', (done) => {\n        chai.request(app)\n        .post(`/api/dispute/${invoiceId}`)\n        .send({\n            customerEmail: 'nvonweb@outlook.com',\n            marchantEmail: 'vnwaokocha@gmail.com',\n            category: '',\n            from: 'marchant',\n            reason: 'I don\\'t want anymore'\n        })\n        .end((err, res) => {\n            expect(res.body.data).to.haveOwnProperty('_id');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('get dispute', (done) => {\n        chai.request(app)\n        .get(`/api/dispute/${invoiceId}`)\n        .end((err, res) => {\n            expect(res.body.data.status).to.equal('open');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('delete invoice', (done) => {\n        chai.request(app)\n        .delete('/api/invoice/'+invoiceId)\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"ae2ab4b044250fa4e453985593879ad89afb2ef4"}}