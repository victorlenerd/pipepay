{"/Users/Sleekvick/Projects/pipepay/server/src/middleware.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/middleware.js","statementMap":{"0":{"start":{"line":4,"column":26},"end":{"line":8,"column":1}},"1":{"start":{"line":5,"column":4},"end":{"line":5,"column":22}},"2":{"start":{"line":6,"column":4},"end":{"line":6,"column":55}},"3":{"start":{"line":7,"column":4},"end":{"line":7,"column":31}}},"fnMap":{"0":{"name":"setGlobalMiddleware","decl":{"start":{"line":4,"column":35},"end":{"line":4,"column":54}},"loc":{"start":{"line":4,"column":60},"end":{"line":8,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"sources":["src/middleware.js"],"names":["bodyParser","morgan","setGlobalMiddleware","app","use","urlencoded","extended","json"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,aAAvB;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AAEA,IAAMC,sBAAsB,SAAtBA,mBAAsB,MAAO;AAC/BC,QAAIC,GAAJ,CAAQH,QAAR;AACAE,QAAIC,GAAJ,CAAQJ,WAAWK,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAH,QAAIC,GAAJ,CAAQJ,WAAWO,IAAX,EAAR;AACH,CAJD;;AAMA,eAAeL,mBAAf","file":"middleware.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import bodyParser from 'body-parser';\nimport morgan from 'morgan';\n\nconst setGlobalMiddleware = app => {\n    app.use(morgan());\n    app.use(bodyParser.urlencoded({ extended: true }))\n    app.use(bodyParser.json())\n}\n\nexport default setGlobalMiddleware;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"29cee4da1d88e554e3027715d8cf64866613745b"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":10,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.model.js"],"names":["mongoose","DisputeSchema","Schema","customerEmail","String","marchantEmail","reason","category","invoiceId","type","unique","status","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,mBAAeC,MADuB;AAEtCC,mBAAeD,MAFuB;AAGtCE,YAAQF,MAH8B;AAItCG,cAAUH,MAJ4B;AAKtCI,eAAW,EAAEC,MAAML,MAAR,EAAgBM,QAAQ,IAAxB,EAL2B;AAMtCC,YAAQP;AAN8B,CAApB,CAAtB;;AASA,eAAeJ,SAASY,KAAT,CAAe,SAAf,EAA0BX,aAA1B,CAAf","file":"dispute.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst DisputeSchema = new mongoose.Schema({\n    customerEmail: String,\n    marchantEmail: String,\n    reason: String,\n    category: String,\n    invoiceId: { type: String, unique: true },\n    status: String\n});\n\nexport default mongoose.model('Dispute', DisputeSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"ecc94fdcf9c361bd1e864265af4cbbe614244138"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":13,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.model.js"],"names":["mongoose","InvoiceSchema","Schema","userId","String","description","deliveryAmount","Number","purchaseAmount","customerName","customerEmail","marchantEmail","verifyCode","status","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,YAAQC,MAD8B;AAEtCC,iBAAaD,MAFyB;AAGtCE,oBAAgBC,MAHsB;AAItCC,oBAAgBD,MAJsB;AAKtCE,kBAAcL,MALwB;AAMtCM,mBAAeN,MANuB;AAOtCO,mBAAeP,MAPuB;AAQtCQ,gBAAYR,MAR0B;AAStCS,YAAQT;AAT8B,CAApB,CAAtB;;AAYA,eAAeJ,SAASc,KAAT,CAAe,SAAf,EAA0Bb,aAA1B,CAAf","file":"invoice.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst InvoiceSchema = new mongoose.Schema({\n    userId: String,\n    description: String,\n    deliveryAmount: Number,\n    purchaseAmount: Number,\n    customerName: String,\n    customerEmail: String,\n    marchantEmail: String,\n    verifyCode: String,\n    status: String\n});\n\nexport default mongoose.model('Invoice', InvoiceSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"383db2363afeca488b0665d6b968f68534b2bb6c"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/generateController.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/generateController.js","statementMap":{"0":{"start":{"line":4,"column":21},"end":{"line":49,"column":5}},"1":{"start":{"line":6,"column":12},"end":{"line":10,"column":15}},"2":{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},"3":{"start":{"line":7,"column":25},"end":{"line":7,"column":99}},"4":{"start":{"line":8,"column":16},"end":{"line":8,"column":35}},"5":{"start":{"line":9,"column":16},"end":{"line":9,"column":23}},"6":{"start":{"line":13,"column":23},"end":{"line":13,"column":31}},"7":{"start":{"line":14,"column":12},"end":{"line":14,"column":38}},"8":{"start":{"line":15,"column":12},"end":{"line":18,"column":15}},"9":{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},"10":{"start":{"line":16,"column":25},"end":{"line":16,"column":92}},"11":{"start":{"line":17,"column":16},"end":{"line":17,"column":67}},"12":{"start":{"line":21,"column":21},"end":{"line":21,"column":30}},"13":{"start":{"line":22,"column":12},"end":{"line":25,"column":15}},"14":{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},"15":{"start":{"line":23,"column":25},"end":{"line":23,"column":92}},"16":{"start":{"line":24,"column":16},"end":{"line":24,"column":56}},"17":{"start":{"line":28,"column":12},"end":{"line":31,"column":15}},"18":{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},"19":{"start":{"line":29,"column":25},"end":{"line":29,"column":92}},"20":{"start":{"line":30,"column":16},"end":{"line":30,"column":68}},"21":{"start":{"line":34,"column":21},"end":{"line":34,"column":30}},"22":{"start":{"line":35,"column":12},"end":{"line":38,"column":15}},"23":{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},"24":{"start":{"line":36,"column":25},"end":{"line":36,"column":92}},"25":{"start":{"line":37,"column":16},"end":{"line":37,"column":71}},"26":{"start":{"line":41,"column":21},"end":{"line":41,"column":30}},"27":{"start":{"line":42,"column":23},"end":{"line":42,"column":31}},"28":{"start":{"line":43,"column":12},"end":{"line":47,"column":15}},"29":{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},"30":{"start":{"line":44,"column":25},"end":{"line":44,"column":92}},"31":{"start":{"line":45,"column":30},"end":{"line":45,"column":59}},"32":{"start":{"line":46,"column":16},"end":{"line":46,"column":71}},"33":{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},"34":{"start":{"line":52,"column":8},"end":{"line":52,"column":23}},"35":{"start":{"line":55,"column":4},"end":{"line":55,"column":53}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":15},"end":{"line":3,"column":16}},"loc":{"start":{"line":3,"column":43},"end":{"line":56,"column":1}},"line":3},"1":{"name":"findByParam","decl":{"start":{"line":5,"column":30},"end":{"line":5,"column":41}},"loc":{"start":{"line":5,"column":62},"end":{"line":11,"column":9}},"line":5},"2":{"name":"(anonymous_2)","decl":{"start":{"line":6,"column":31},"end":{"line":6,"column":32}},"loc":{"start":{"line":6,"column":51},"end":{"line":10,"column":13}},"line":6},"3":{"name":"createOne","decl":{"start":{"line":12,"column":28},"end":{"line":12,"column":37}},"loc":{"start":{"line":12,"column":48},"end":{"line":19,"column":9}},"line":12},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":31},"end":{"line":15,"column":32}},"loc":{"start":{"line":15,"column":51},"end":{"line":18,"column":13}},"line":15},"5":{"name":"deleteOne","decl":{"start":{"line":20,"column":28},"end":{"line":20,"column":37}},"loc":{"start":{"line":20,"column":48},"end":{"line":26,"column":9}},"line":20},"6":{"name":"(anonymous_6)","decl":{"start":{"line":22,"column":41},"end":{"line":22,"column":42}},"loc":{"start":{"line":22,"column":61},"end":{"line":25,"column":13}},"line":22},"7":{"name":"getAll","decl":{"start":{"line":27,"column":25},"end":{"line":27,"column":31}},"loc":{"start":{"line":27,"column":42},"end":{"line":32,"column":9}},"line":27},"8":{"name":"(anonymous_8)","decl":{"start":{"line":28,"column":27},"end":{"line":28,"column":28}},"loc":{"start":{"line":28,"column":48},"end":{"line":31,"column":13}},"line":28},"9":{"name":"getOne","decl":{"start":{"line":33,"column":25},"end":{"line":33,"column":31}},"loc":{"start":{"line":33,"column":42},"end":{"line":39,"column":9}},"line":33},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":36},"end":{"line":35,"column":37}},"loc":{"start":{"line":35,"column":57},"end":{"line":38,"column":13}},"line":35},"11":{"name":"updateOne","decl":{"start":{"line":40,"column":28},"end":{"line":40,"column":37}},"loc":{"start":{"line":40,"column":48},"end":{"line":48,"column":9}},"line":40},"12":{"name":"(anonymous_12)","decl":{"start":{"line":43,"column":54},"end":{"line":43,"column":55}},"loc":{"start":{"line":43,"column":74},"end":{"line":47,"column":13}},"line":43}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},"type":"if","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},{"start":{"line":7,"column":16},"end":{"line":7,"column":99}}],"line":7},"1":{"loc":{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},"type":"if","locations":[{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},{"start":{"line":16,"column":16},"end":{"line":16,"column":92}}],"line":16},"2":{"loc":{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},"type":"if","locations":[{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},{"start":{"line":23,"column":16},"end":{"line":23,"column":92}}],"line":23},"3":{"loc":{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},"type":"if","locations":[{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},{"start":{"line":29,"column":16},"end":{"line":29,"column":92}}],"line":29},"4":{"loc":{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},"type":"if","locations":[{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},{"start":{"line":36,"column":16},"end":{"line":36,"column":92}}],"line":36},"5":{"loc":{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},"type":"if","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},{"start":{"line":44,"column":16},"end":{"line":44,"column":92}}],"line":44},"6":{"loc":{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},{"start":{"line":51,"column":4},"end":{"line":53,"column":5}}],"line":51}},"s":{"0":3,"1":2,"2":2,"3":0,"4":2,"5":2,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":1,"22":1,"23":1,"24":0,"25":1,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":3,"34":0,"35":3},"f":{"0":3,"1":2,"2":2,"3":0,"4":0,"5":1,"6":1,"7":0,"8":0,"9":1,"10":1,"11":0,"12":0},"b":{"0":[0,2],"1":[0,0],"2":[0,1],"3":[0,0],"4":[0,1],"5":[0,0],"6":[0,3]},"inputSourceMap":{"version":3,"sources":["src/api/modules/generateController.js"],"names":["model","overrides","controller","findByParam","req","res","next","id","findById","err","doc","status","send","success","error","message","docId","createOne","body","userId","user","create","data","deleteOne","_id","getAll","find","docs","getOne","updateOne","findOneAndUpdate","updated"],"mappings":"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","file":"generateController.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["export default function (model, overrides) {\n    var controller = {\n        findByParam: function (req, res, next, id) {\n            model.findById(id, function (err, doc) {\n                if (err) res.status(404).send({ success: false, error: { message: \"Not found\" } });\n                req.docId = doc.id;\n                next();\n            });\n        },\n        createOne: function (req, res) {\n            var body = req.body;\n            body.userId = req.user.id;\n            model.create(body, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });\n                res.status(200).send({ success: true, data: doc });\n            });\n        },\n        deleteOne: function (req, res) {\n            var id = req.docId;\n            model.deleteOne({ _id: id }, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true });\n            });\n        },\n        getAll: function (req, res) {\n            model.find({}, function (err, docs) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true, data: docs });\n            });\n        },\n        getOne: function (req, res) {\n            var id = req.docId;\n            model.find({ _id: id }, function (err, docs) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true, data: docs[0] });\n            });\n        },\n        updateOne: function (req, res) {\n            var id = req.docId;\n            var body = req.body;\n            model.findOneAndUpdate({ _id: id }, body, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                var updated = Object.assign({}, body, doc);\n                res.status(200).send({ success: true, data: updated });\n            });\n        }\n    };\n\n    if (!overrides) {\n        overrides = {}\n    }\n\n    return Object.assign({}, controller, overrides);\n};"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"c7631bddd9b0416ea7b10a2286b419bc28f8c545"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/mailer.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/mailer.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":10,"column":17},"end":{"line":10,"column":39}},"2":{"start":{"line":11,"column":20},"end":{"line":11,"column":45}},"3":{"start":{"line":13,"column":18},"end":{"line":21,"column":2}},"4":{"start":{"line":23,"column":11},"end":{"line":23,"column":43}},"5":{"start":{"line":25,"column":29},"end":{"line":45,"column":1}},"6":{"start":{"line":26,"column":24},"end":{"line":26,"column":42}},"7":{"start":{"line":27,"column":25},"end":{"line":27,"column":44}},"8":{"start":{"line":28,"column":25},"end":{"line":28,"column":44}},"9":{"start":{"line":29,"column":4},"end":{"line":44,"column":7}},"10":{"start":{"line":30,"column":26},"end":{"line":35,"column":9}},"11":{"start":{"line":37,"column":8},"end":{"line":43,"column":11}},"12":{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},"13":{"start":{"line":39,"column":16},"end":{"line":39,"column":48}},"14":{"start":{"line":42,"column":12},"end":{"line":42,"column":26}},"15":{"start":{"line":47,"column":13},"end":{"line":57,"column":1}},"16":{"start":{"line":48,"column":4},"end":{"line":56,"column":7}},"17":{"start":{"line":49,"column":8},"end":{"line":55,"column":11}},"18":{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},"19":{"start":{"line":51,"column":16},"end":{"line":51,"column":48}},"20":{"start":{"line":54,"column":12},"end":{"line":54,"column":26}},"21":{"start":{"line":59,"column":29},"end":{"line":99,"column":1}},"22":{"start":{"line":60,"column":4},"end":{"line":98,"column":9}},"23":{"start":{"line":61,"column":20},"end":{"line":93,"column":11}},"24":{"start":{"line":63,"column":12},"end":{"line":92,"column":41}},"25":{"start":{"line":64,"column":16},"end":{"line":91,"column":17}},"26":{"start":{"line":65,"column":20},"end":{"line":90,"column":21}},"27":{"start":{"line":67,"column":28},"end":{"line":71,"column":30}},"28":{"start":{"line":72,"column":28},"end":{"line":72,"column":46}},"29":{"start":{"line":73,"column":28},"end":{"line":73,"column":46}},"30":{"start":{"line":74,"column":28},"end":{"line":74,"column":164}},"31":{"start":{"line":77,"column":28},"end":{"line":77,"column":38}},"32":{"start":{"line":78,"column":28},"end":{"line":78,"column":47}},"33":{"start":{"line":79,"column":28},"end":{"line":79,"column":34}},"34":{"start":{"line":82,"column":28},"end":{"line":82,"column":46}},"35":{"start":{"line":83,"column":28},"end":{"line":83,"column":63}},"36":{"start":{"line":85,"column":28},"end":{"line":85,"column":48}},"37":{"start":{"line":89,"column":28},"end":{"line":89,"column":51}},"38":{"start":{"line":95,"column":8},"end":{"line":97,"column":10}},"39":{"start":{"line":96,"column":12},"end":{"line":96,"column":48}},"40":{"start":{"line":101,"column":30},"end":{"line":103,"column":1}},"41":{"start":{"line":102,"column":4},"end":{"line":102,"column":54}},"42":{"start":{"line":105,"column":29},"end":{"line":145,"column":1}},"43":{"start":{"line":106,"column":23},"end":{"line":106,"column":115}},"44":{"start":{"line":107,"column":4},"end":{"line":144,"column":9}},"45":{"start":{"line":108,"column":20},"end":{"line":139,"column":11}},"46":{"start":{"line":110,"column":12},"end":{"line":138,"column":42}},"47":{"start":{"line":111,"column":16},"end":{"line":137,"column":17}},"48":{"start":{"line":112,"column":20},"end":{"line":136,"column":21}},"49":{"start":{"line":114,"column":28},"end":{"line":117,"column":30}},"50":{"start":{"line":118,"column":28},"end":{"line":118,"column":47}},"51":{"start":{"line":119,"column":28},"end":{"line":119,"column":47}},"52":{"start":{"line":120,"column":28},"end":{"line":120,"column":329}},"53":{"start":{"line":123,"column":28},"end":{"line":123,"column":38}},"54":{"start":{"line":124,"column":28},"end":{"line":124,"column":48}},"55":{"start":{"line":125,"column":28},"end":{"line":125,"column":34}},"56":{"start":{"line":128,"column":28},"end":{"line":128,"column":47}},"57":{"start":{"line":129,"column":28},"end":{"line":129,"column":65}},"58":{"start":{"line":131,"column":28},"end":{"line":131,"column":49}},"59":{"start":{"line":135,"column":28},"end":{"line":135,"column":52}},"60":{"start":{"line":141,"column":8},"end":{"line":143,"column":10}},"61":{"start":{"line":142,"column":12},"end":{"line":142,"column":48}},"62":{"start":{"line":147,"column":43},"end":{"line":187,"column":1}},"63":{"start":{"line":148,"column":4},"end":{"line":186,"column":9}},"64":{"start":{"line":149,"column":20},"end":{"line":181,"column":11}},"65":{"start":{"line":151,"column":12},"end":{"line":180,"column":42}},"66":{"start":{"line":152,"column":16},"end":{"line":179,"column":17}},"67":{"start":{"line":153,"column":20},"end":{"line":178,"column":21}},"68":{"start":{"line":155,"column":28},"end":{"line":159,"column":30}},"69":{"start":{"line":160,"column":28},"end":{"line":160,"column":47}},"70":{"start":{"line":161,"column":28},"end":{"line":161,"column":47}},"71":{"start":{"line":162,"column":28},"end":{"line":162,"column":91}},"72":{"start":{"line":165,"column":28},"end":{"line":165,"column":38}},"73":{"start":{"line":166,"column":28},"end":{"line":166,"column":48}},"74":{"start":{"line":167,"column":28},"end":{"line":167,"column":34}},"75":{"start":{"line":170,"column":28},"end":{"line":170,"column":47}},"76":{"start":{"line":171,"column":28},"end":{"line":171,"column":65}},"77":{"start":{"line":173,"column":28},"end":{"line":173,"column":49}},"78":{"start":{"line":177,"column":28},"end":{"line":177,"column":52}},"79":{"start":{"line":183,"column":8},"end":{"line":185,"column":10}},"80":{"start":{"line":184,"column":12},"end":{"line":184,"column":48}}},"fnMap":{"0":{"name":"sendInvoiceMail","decl":{"start":{"line":25,"column":38},"end":{"line":25,"column":53}},"loc":{"start":{"line":25,"column":60},"end":{"line":45,"column":1}},"line":25},"1":{"name":"(anonymous_1)","decl":{"start":{"line":29,"column":24},"end":{"line":29,"column":25}},"loc":{"start":{"line":29,"column":51},"end":{"line":44,"column":5}},"line":29},"2":{"name":"(anonymous_2)","decl":{"start":{"line":37,"column":42},"end":{"line":37,"column":43}},"loc":{"start":{"line":37,"column":65},"end":{"line":43,"column":9}},"line":37},"3":{"name":"sendTo","decl":{"start":{"line":47,"column":22},"end":{"line":47,"column":28}},"loc":{"start":{"line":47,"column":41},"end":{"line":57,"column":1}},"line":47},"4":{"name":"(anonymous_4)","decl":{"start":{"line":48,"column":24},"end":{"line":48,"column":25}},"loc":{"start":{"line":48,"column":51},"end":{"line":56,"column":5}},"line":48},"5":{"name":"(anonymous_5)","decl":{"start":{"line":49,"column":41},"end":{"line":49,"column":42}},"loc":{"start":{"line":49,"column":64},"end":{"line":55,"column":9}},"line":49},"6":{"name":"sendReceiptMail","decl":{"start":{"line":59,"column":38},"end":{"line":59,"column":53}},"loc":{"start":{"line":59,"column":106},"end":{"line":99,"column":1}},"line":59},"7":{"name":"(anonymous_7)","decl":{"start":{"line":60,"column":24},"end":{"line":60,"column":25}},"loc":{"start":{"line":60,"column":36},"end":{"line":98,"column":5}},"line":60},"8":{"name":"_callee","decl":{"start":{"line":61,"column":86},"end":{"line":61,"column":93}},"loc":{"start":{"line":61,"column":111},"end":{"line":93,"column":9}},"line":61},"9":{"name":"_callee$","decl":{"start":{"line":63,"column":53},"end":{"line":63,"column":61}},"loc":{"start":{"line":63,"column":72},"end":{"line":92,"column":13}},"line":63},"10":{"name":"(anonymous_10)","decl":{"start":{"line":95,"column":15},"end":{"line":95,"column":16}},"loc":{"start":{"line":95,"column":34},"end":{"line":97,"column":9}},"line":95},"11":{"name":"sendTransferMail","decl":{"start":{"line":101,"column":39},"end":{"line":101,"column":55}},"loc":{"start":{"line":101,"column":86},"end":{"line":103,"column":1}},"line":101},"12":{"name":"(anonymous_12)","decl":{"start":{"line":102,"column":24},"end":{"line":102,"column":25}},"loc":{"start":{"line":102,"column":50},"end":{"line":102,"column":52}},"line":102},"13":{"name":"sendDisputeMail","decl":{"start":{"line":105,"column":38},"end":{"line":105,"column":53}},"loc":{"start":{"line":105,"column":106},"end":{"line":145,"column":1}},"line":105},"14":{"name":"(anonymous_14)","decl":{"start":{"line":107,"column":24},"end":{"line":107,"column":25}},"loc":{"start":{"line":107,"column":36},"end":{"line":144,"column":5}},"line":107},"15":{"name":"_callee2","decl":{"start":{"line":108,"column":86},"end":{"line":108,"column":94}},"loc":{"start":{"line":108,"column":112},"end":{"line":139,"column":9}},"line":108},"16":{"name":"_callee2$","decl":{"start":{"line":110,"column":53},"end":{"line":110,"column":62}},"loc":{"start":{"line":110,"column":74},"end":{"line":138,"column":13}},"line":110},"17":{"name":"(anonymous_17)","decl":{"start":{"line":141,"column":15},"end":{"line":141,"column":16}},"loc":{"start":{"line":141,"column":35},"end":{"line":143,"column":9}},"line":141},"18":{"name":"sendCustormerVerificationCode","decl":{"start":{"line":147,"column":52},"end":{"line":147,"column":81}},"loc":{"start":{"line":147,"column":103},"end":{"line":187,"column":1}},"line":147},"19":{"name":"(anonymous_19)","decl":{"start":{"line":148,"column":24},"end":{"line":148,"column":25}},"loc":{"start":{"line":148,"column":36},"end":{"line":186,"column":5}},"line":148},"20":{"name":"_callee3","decl":{"start":{"line":149,"column":86},"end":{"line":149,"column":94}},"loc":{"start":{"line":149,"column":112},"end":{"line":181,"column":9}},"line":149},"21":{"name":"_callee3$","decl":{"start":{"line":151,"column":53},"end":{"line":151,"column":62}},"loc":{"start":{"line":151,"column":74},"end":{"line":180,"column":13}},"line":151},"22":{"name":"(anonymous_22)","decl":{"start":{"line":183,"column":15},"end":{"line":183,"column":16}},"loc":{"start":{"line":183,"column":35},"end":{"line":185,"column":9}},"line":183}},"branchMap":{"0":{"loc":{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},"type":"if","locations":[{"start":{"line":38,"column":12},"end":{"line":40,"column":13}},{"start":{"line":38,"column":12},"end":{"line":40,"column":13}}],"line":38},"1":{"loc":{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},"type":"if","locations":[{"start":{"line":50,"column":12},"end":{"line":52,"column":13}},{"start":{"line":50,"column":12},"end":{"line":52,"column":13}}],"line":50},"2":{"loc":{"start":{"line":65,"column":20},"end":{"line":90,"column":21}},"type":"switch","locations":[{"start":{"line":66,"column":24},"end":{"line":74,"column":164}},{"start":{"line":76,"column":24},"end":{"line":79,"column":34}},{"start":{"line":81,"column":24},"end":{"line":85,"column":48}},{"start":{"line":87,"column":24},"end":{"line":87,"column":32}},{"start":{"line":88,"column":24},"end":{"line":89,"column":51}}],"line":65},"3":{"loc":{"start":{"line":106,"column":23},"end":{"line":106,"column":115}},"type":"cond-expr","locations":[{"start":{"line":106,"column":76},"end":{"line":106,"column":88}},{"start":{"line":106,"column":91},"end":{"line":106,"column":115}}],"line":106},"4":{"loc":{"start":{"line":106,"column":23},"end":{"line":106,"column":73}},"type":"binary-expr","locations":[{"start":{"line":106,"column":23},"end":{"line":106,"column":43}},{"start":{"line":106,"column":47},"end":{"line":106,"column":73}}],"line":106},"5":{"loc":{"start":{"line":112,"column":20},"end":{"line":136,"column":21}},"type":"switch","locations":[{"start":{"line":113,"column":24},"end":{"line":120,"column":329}},{"start":{"line":122,"column":24},"end":{"line":125,"column":34}},{"start":{"line":127,"column":24},"end":{"line":131,"column":49}},{"start":{"line":133,"column":24},"end":{"line":133,"column":32}},{"start":{"line":134,"column":24},"end":{"line":135,"column":52}}],"line":112},"6":{"loc":{"start":{"line":153,"column":20},"end":{"line":178,"column":21}},"type":"switch","locations":[{"start":{"line":154,"column":24},"end":{"line":162,"column":91}},{"start":{"line":164,"column":24},"end":{"line":167,"column":34}},{"start":{"line":169,"column":24},"end":{"line":173,"column":49}},{"start":{"line":175,"column":24},"end":{"line":175,"column":32}},{"start":{"line":176,"column":24},"end":{"line":177,"column":52}}],"line":153}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":0,"14":1,"15":1,"16":5,"17":5,"18":5,"19":0,"20":5,"21":1,"22":1,"23":1,"24":1,"25":2,"26":3,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":0,"35":0,"36":0,"37":1,"38":1,"39":1,"40":1,"41":0,"42":1,"43":1,"44":1,"45":1,"46":1,"47":2,"48":3,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":0,"57":0,"58":0,"59":1,"60":1,"61":1,"62":1,"63":1,"64":1,"65":1,"66":2,"67":3,"68":1,"69":1,"70":1,"71":1,"72":1,"73":1,"74":1,"75":0,"76":0,"77":0,"78":1,"79":1,"80":1},"f":{"0":1,"1":1,"2":1,"3":5,"4":5,"5":5,"6":1,"7":1,"8":1,"9":2,"10":1,"11":0,"12":0,"13":1,"14":1,"15":1,"16":2,"17":1,"18":1,"19":1,"20":1,"21":2,"22":1},"b":{"0":[0,1],"1":[0,5],"2":[1,1,0,1,1],"3":[0,1],"4":[1,0],"5":[1,1,0,1,1],"6":[1,1,0,1,1]},"inputSourceMap":{"version":3,"sources":["src/api/modules/mailer.js"],"names":["nodemailer","ZOHO_EMAIL","process","env","ZOHO_PASSWORD","transporter","createTransport","host","port","secure","auth","user","pass","from","sendInvoiceMail","customerEmail","deliveryAmount","purchaseAmount","resolve","reject","mailOptions","to","subject","text","sendMail","error","info","Error","sendTo","mailOption","sendReceiptMail","customerName","marchantEmail","amount","all","sendTransferMail","esolve","sendDisputeMail","reason","supportEmail","sendCustormerVerificationCode","code"],"mappings":"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","file":"mailer.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import nodemailer from 'nodemailer';\n\nconst ZOHO_EMAIL = process.env.ZOHO_EMAIL;\nconst ZOHO_PASSWORD = process.env.ZOHO_PASSWORD;\n\nconst transporter = nodemailer.createTransport({\n    host: 'smtp.zoho.com',\n    port: 465,\n    secure: true,\n    auth: {\n        user: ZOHO_EMAIL,\n        pass: ZOHO_PASSWORD\n    }\n});\n\nconst from = 'Pipepay <hello@pipepay.africa>';\n\nexport const sendInvoiceMail = ({ customerEmail, deliveryAmount, purchaseAmount }) => new Promise((resolve, reject) => {\n    let mailOptions = {\n        from,\n        to: customerEmail,\n        subject: 'Your Invoice Is Ready',\n        text: `Your invoice is worth ${deliveryAmount+purchaseAmount}`,\n    };\n\n    transporter.sendMail(mailOptions, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n\n        resolve(info);\n    });\n});\n\nconst sendTo = (mailOption) => new Promise((resolve, reject) => {\n    transporter.sendMail(mailOption, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n\n        resolve(info);\n    });\n});\n\nexport const sendReceiptMail = (customerName, customerEmail, marchantEmail, amount) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Your Receipt Is Ready',\n        text: `${customerName} made payment of ${amount}`,\n    };\n\n\n    try {\n        await Promise.all([\n            sendTo({ ...mailOption, to: customerEmail }),\n            sendTo({ ...mailOption, to: marchantEmail })\n        ]);\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendTransferMail = (customerEmail, marchantEmail) => new Promise((esolve, reject) => {\n\n});\n\nexport const sendDisputeMail = (marchantEmail, customerEmail, customerName, reason, supportEmail = 'support@pipepay.africa') => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Payment Dispute',\n    };\n\n    try {\n        await Promise.all([\n            sendTo({ ...mailOption, to: customerEmail,  text: 'Your dispute has been received, you will hear from our support rep soon.' }),\n            sendTo({ ...mailOption, to: marchantEmail, text: `New dispute from ${customerName} reason being that: \"${reason}\"` })\n        ]);\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendCustormerVerificationCode = (customerEmail, code) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Invoice Mail Verification',\n        text: `Your invoice verfication code is ${code}`\n    };\n\n    try {\n        await sendTo({ ...mailOption, to: customerEmail });\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"b076d17c90877ad864f61dedd22d9a28dd86d60b"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.controller.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":11,"column":24},"end":{"line":105,"column":2}},"2":{"start":{"line":13,"column":18},"end":{"line":13,"column":38}},"3":{"start":{"line":15,"column":8},"end":{"line":19,"column":11}},"4":{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},"5":{"start":{"line":16,"column":21},"end":{"line":16,"column":123}},"6":{"start":{"line":17,"column":12},"end":{"line":17,"column":30}},"7":{"start":{"line":18,"column":12},"end":{"line":18,"column":19}},"8":{"start":{"line":22,"column":19},"end":{"line":22,"column":27}},"9":{"start":{"line":23,"column":27},"end":{"line":23,"column":38}},"10":{"start":{"line":24,"column":28},"end":{"line":24,"column":54}},"11":{"start":{"line":25,"column":28},"end":{"line":25,"column":54}},"12":{"start":{"line":26,"column":27},"end":{"line":26,"column":52}},"13":{"start":{"line":27,"column":18},"end":{"line":27,"column":34}},"14":{"start":{"line":29,"column":8},"end":{"line":29,"column":29}},"15":{"start":{"line":30,"column":8},"end":{"line":30,"column":29}},"16":{"start":{"line":31,"column":8},"end":{"line":72,"column":13}},"17":{"start":{"line":32,"column":23},"end":{"line":67,"column":15}},"18":{"start":{"line":33,"column":16},"end":{"line":66,"column":45}},"19":{"start":{"line":34,"column":20},"end":{"line":65,"column":21}},"20":{"start":{"line":35,"column":24},"end":{"line":64,"column":25}},"21":{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},"22":{"start":{"line":38,"column":36},"end":{"line":38,"column":54}},"23":{"start":{"line":39,"column":36},"end":{"line":39,"column":42}},"24":{"start":{"line":42,"column":32},"end":{"line":42,"column":159}},"25":{"start":{"line":45,"column":32},"end":{"line":45,"column":50}},"26":{"start":{"line":46,"column":32},"end":{"line":46,"column":50}},"27":{"start":{"line":47,"column":32},"end":{"line":47,"column":112}},"28":{"start":{"line":50,"column":32},"end":{"line":50,"column":71}},"29":{"start":{"line":51,"column":32},"end":{"line":51,"column":51}},"30":{"start":{"line":52,"column":32},"end":{"line":52,"column":38}},"31":{"start":{"line":55,"column":32},"end":{"line":55,"column":50}},"32":{"start":{"line":56,"column":32},"end":{"line":56,"column":67}},"33":{"start":{"line":58,"column":32},"end":{"line":58,"column":64}},"34":{"start":{"line":59,"column":32},"end":{"line":59,"column":150}},"35":{"start":{"line":63,"column":32},"end":{"line":63,"column":55}},"36":{"start":{"line":69,"column":12},"end":{"line":71,"column":14}},"37":{"start":{"line":70,"column":16},"end":{"line":70,"column":51}},"38":{"start":{"line":75,"column":24},"end":{"line":75,"column":44}},"39":{"start":{"line":76,"column":8},"end":{"line":103,"column":13}},"40":{"start":{"line":77,"column":24},"end":{"line":98,"column":15}},"41":{"start":{"line":78,"column":16},"end":{"line":97,"column":36}},"42":{"start":{"line":79,"column":20},"end":{"line":96,"column":21}},"43":{"start":{"line":80,"column":24},"end":{"line":95,"column":25}},"44":{"start":{"line":82,"column":32},"end":{"line":85,"column":33}},"45":{"start":{"line":83,"column":36},"end":{"line":83,"column":55}},"46":{"start":{"line":84,"column":36},"end":{"line":84,"column":42}},"47":{"start":{"line":87,"column":32},"end":{"line":87,"column":144}},"48":{"start":{"line":90,"column":32},"end":{"line":90,"column":71}},"49":{"start":{"line":94,"column":32},"end":{"line":94,"column":56}},"50":{"start":{"line":100,"column":12},"end":{"line":102,"column":14}},"51":{"start":{"line":101,"column":16},"end":{"line":101,"column":52}}},"fnMap":{"0":{"name":"getInvoiceId","decl":{"start":{"line":12,"column":27},"end":{"line":12,"column":39}},"loc":{"start":{"line":12,"column":56},"end":{"line":20,"column":5}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":43},"end":{"line":15,"column":44}},"loc":{"start":{"line":15,"column":63},"end":{"line":19,"column":9}},"line":15},"2":{"name":"createOne","decl":{"start":{"line":21,"column":24},"end":{"line":21,"column":33}},"loc":{"start":{"line":21,"column":44},"end":{"line":73,"column":5}},"line":21},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":34},"end":{"line":31,"column":35}},"loc":{"start":{"line":31,"column":46},"end":{"line":72,"column":9}},"line":31},"4":{"name":"_callee","decl":{"start":{"line":32,"column":89},"end":{"line":32,"column":96}},"loc":{"start":{"line":32,"column":107},"end":{"line":67,"column":13}},"line":32},"5":{"name":"_callee$","decl":{"start":{"line":33,"column":57},"end":{"line":33,"column":65}},"loc":{"start":{"line":33,"column":76},"end":{"line":66,"column":17}},"line":33},"6":{"name":"(anonymous_6)","decl":{"start":{"line":69,"column":19},"end":{"line":69,"column":20}},"loc":{"start":{"line":69,"column":38},"end":{"line":71,"column":13}},"line":69},"7":{"name":"getOne","decl":{"start":{"line":74,"column":21},"end":{"line":74,"column":27}},"loc":{"start":{"line":74,"column":38},"end":{"line":104,"column":5}},"line":74},"8":{"name":"(anonymous_8)","decl":{"start":{"line":76,"column":55},"end":{"line":76,"column":56}},"loc":{"start":{"line":76,"column":67},"end":{"line":103,"column":9}},"line":76},"9":{"name":"_callee2","decl":{"start":{"line":77,"column":90},"end":{"line":77,"column":98}},"loc":{"start":{"line":77,"column":109},"end":{"line":98,"column":13}},"line":77},"10":{"name":"_callee2$","decl":{"start":{"line":78,"column":57},"end":{"line":78,"column":66}},"loc":{"start":{"line":78,"column":78},"end":{"line":97,"column":17}},"line":78},"11":{"name":"(anonymous_11)","decl":{"start":{"line":100,"column":19},"end":{"line":100,"column":20}},"loc":{"start":{"line":100,"column":39},"end":{"line":102,"column":13}},"line":100}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},"type":"if","locations":[{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},{"start":{"line":16,"column":12},"end":{"line":16,"column":123}}],"line":16},"1":{"loc":{"start":{"line":35,"column":24},"end":{"line":64,"column":25}},"type":"switch","locations":[{"start":{"line":36,"column":28},"end":{"line":42,"column":159}},{"start":{"line":44,"column":28},"end":{"line":47,"column":112}},{"start":{"line":49,"column":28},"end":{"line":52,"column":38}},{"start":{"line":54,"column":28},"end":{"line":59,"column":150}},{"start":{"line":61,"column":28},"end":{"line":61,"column":36}},{"start":{"line":62,"column":28},"end":{"line":63,"column":55}}],"line":35},"2":{"loc":{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},"type":"if","locations":[{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},{"start":{"line":37,"column":32},"end":{"line":40,"column":33}}],"line":37},"3":{"loc":{"start":{"line":80,"column":24},"end":{"line":95,"column":25}},"type":"switch","locations":[{"start":{"line":81,"column":28},"end":{"line":87,"column":144}},{"start":{"line":89,"column":28},"end":{"line":90,"column":71}},{"start":{"line":92,"column":28},"end":{"line":92,"column":35}},{"start":{"line":93,"column":28},"end":{"line":94,"column":56}}],"line":80},"4":{"loc":{"start":{"line":82,"column":32},"end":{"line":85,"column":33}},"type":"if","locations":[{"start":{"line":82,"column":32},"end":{"line":85,"column":33}},{"start":{"line":82,"column":32},"end":{"line":85,"column":33}}],"line":82}},"s":{"0":1,"1":1,"2":6,"3":6,"4":6,"5":0,"6":6,"7":6,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":2,"20":4,"21":1,"22":1,"23":1,"24":0,"25":1,"26":1,"27":1,"28":1,"29":1,"30":1,"31":0,"32":0,"33":0,"34":0,"35":1,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":2,"44":1,"45":1,"46":1,"47":0,"48":1,"49":1,"50":1,"51":1},"f":{"0":6,"1":6,"2":1,"3":1,"4":1,"5":2,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1},"b":{"0":[0,6],"1":[1,1,1,0,1,1],"2":[1,0],"3":[1,1,1,1],"4":[1,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.controller.js"],"names":["DisputeModel","InvoiceModel","generateController","sendDisputeMail","DisputeController","getInvoiceId","req","res","next","_id","params","invoiceId","findOne","err","doc","status","send","error","message","success","invoice","createOne","body","marchantEmail","customerEmail","customerName","create","reason","data","console","log","getOne"],"mappings":";;;;;AAAA,OAAOA,YAAP,MAAyB,iBAAzB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,kBAAP,MAA+B,kCAA/B;AACA,SAASC,eAAT,QAAgC,sBAAhC;;AAEA,IAAMC,oBAAoBF,mBAAmBF,YAAnB,EAAiC;AACvDK,kBAAc,sBAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9B,YAAMC,MAAMH,IAAII,MAAJ,CAAWC,SAAvB;;AAEAV,qBAAaW,OAAb,CAAqB,EAAEH,QAAF,EAArB,EAA8B,UAACI,GAAD,EAAMC,GAAN,EAAc;AACxC,gBAAID,GAAJ,EAAS,OAAON,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,gCAAX,EAAT,EAAwDC,SAAS,KAAjE,EAArB,CAAP;AACTb,gBAAIc,OAAJ,GAAcN,GAAd;AACAN;AACH,SAJD;AAKH,KATsD;AAUvDa,eAAW,mBAACf,GAAD,EAAMC,GAAN,EAAc;AACrB,YAAMe,OAAOhB,IAAIgB,IAAjB;AADqB,2BAEuChB,IAAIc,OAF3C;AAAA,YAEbG,aAFa,gBAEbA,aAFa;AAAA,YAEEC,aAFF,gBAEEA,aAFF;AAAA,YAEiBC,YAFjB,gBAEiBA,YAFjB;AAAA,YAE+BhB,GAF/B,gBAE+BA,GAF/B;;AAGrBa,aAAKP,MAAL,GAAc,MAAd;AACAO,aAAKX,SAAL,GAAiBF,GAAjB;AACAT,qBAAa0B,MAAb,CAAoBJ,IAApB;AAAA,gFAA0B,iBAAOT,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,qCAClBD,GADkB;AAAA;AAAA;AAAA;;AAAA,iEACNN,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,8BAAX,EAAT,EAAsDC,SAAS,KAA/D,EAArB,CADM;;AAAA;AAAA;AAAA;AAAA,uCAIZhB,gBAAgBoB,aAAhB,EAA+BC,aAA/B,EAA8CC,YAA9C,EAA4DH,KAAKK,MAAjE,CAJY;;AAAA;AAKlBpB,oCAAIS,IAAJ,CAAS,EAAEY,MAAMd,GAAR,EAAaK,SAAS,IAAtB,EAAT;AALkB;AAAA;;AAAA;AAAA;AAAA;;AAOlBU,wCAAQC,GAAR,CAAY,KAAZ;AAPkB,iEAQXvB,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,qBAAX,EAAT,EAA6CC,SAAS,KAAtD,EAArB,CARW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAA1B;;AAAA;AAAA;AAAA;AAAA;AAWH,KA1BsD;AA2BvDY,YAAQ,gBAACzB,GAAD,EAAMC,GAAN,EAAc;AAClB,YAAMI,YAAYL,IAAII,MAAJ,CAAWC,SAA7B;AACAX,qBAAaY,OAAb,CAAqB,EAAED,oBAAF,EAArB;AAAA,iFAAoC,kBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,qCAC5BD,GAD4B;AAAA;AAAA;AAAA;;AAAA,kEAChBN,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,cAAX,EAAT,EAAsCC,SAAS,KAA/C,EAArB,CADgB;;AAAA;AAEhCZ,oCAAIS,IAAJ,CAAS,EAAEY,MAAMd,GAAR,EAAaK,SAAS,IAAtB,EAAT;;AAFgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAApC;;AAAA;AAAA;AAAA;AAAA;AAIH;AAjCsD,CAAjC,CAA1B;;AAoCA,eAAef,iBAAf","file":"dispute.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import DisputeModel from './dispute.model';\nimport InvoiceModel from '../invoice/invoice.model';\nimport generateController from '../../modules/generateController';\nimport { sendDisputeMail } from '../../modules/mailer';\n\nconst DisputeController = generateController(DisputeModel, {\n    getInvoiceId: (req, res, next) => {\n        const _id = req.params.invoiceId;\n\n        InvoiceModel.findOne({ _id }, (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Invoice with id does not exits' }, success: false });\n            req.invoice = doc;\n            next()\n        });\n    },\n    createOne: (req, res) => {\n        const body = req.body;\n        const { marchantEmail, customerEmail, customerName, _id } = req.invoice;\n        body.status = \"open\";\n        body.invoiceId = _id;\n        DisputeModel.create(body, async (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Could not create the dispute' }, success: false });\n\n            try {\n                await sendDisputeMail(marchantEmail, customerEmail, customerName, body.reason);\n                res.send({ data: doc, success: true });\n            } catch (err) {\n                console.log('err', err);\n                return res.status(400).send({ error: { message: 'Could not send mail' }, success: false });\n            }\n        });\n    },\n    getOne: (req, res) => {\n        const invoiceId = req.params.invoiceId;\n        DisputeModel.findOne({ invoiceId }, async (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Find dispute' }, success: false });\n            res.send({ data: doc, success: true });\n        });\n    }\n});\n\nexport default DisputeController;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"4244ef744c2913c5053eb6ebb2d05bf34d934113"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/verify/verify.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/verify/verify.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":10,"column":13},"end":{"line":10,"column":29}},"2":{"start":{"line":12,"column":0},"end":{"line":12,"column":58}},"3":{"start":{"line":14,"column":0},"end":{"line":49,"column":5}},"4":{"start":{"line":15,"column":15},"end":{"line":44,"column":7}},"5":{"start":{"line":18,"column":8},"end":{"line":43,"column":37}},"6":{"start":{"line":19,"column":12},"end":{"line":42,"column":13}},"7":{"start":{"line":20,"column":16},"end":{"line":41,"column":17}},"8":{"start":{"line":22,"column":24},"end":{"line":22,"column":133}},"9":{"start":{"line":23,"column":24},"end":{"line":23,"column":42}},"10":{"start":{"line":24,"column":24},"end":{"line":24,"column":42}},"11":{"start":{"line":25,"column":24},"end":{"line":25,"column":88}},"12":{"start":{"line":28,"column":24},"end":{"line":28,"column":52}},"13":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"14":{"start":{"line":30,"column":24},"end":{"line":30,"column":30}},"15":{"start":{"line":33,"column":24},"end":{"line":33,"column":42}},"16":{"start":{"line":34,"column":24},"end":{"line":34,"column":59}},"17":{"start":{"line":36,"column":24},"end":{"line":36,"column":84}},"18":{"start":{"line":40,"column":24},"end":{"line":40,"column":47}},"19":{"start":{"line":46,"column":4},"end":{"line":48,"column":6}},"20":{"start":{"line":47,"column":8},"end":{"line":47,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":32},"end":{"line":14,"column":33}},"loc":{"start":{"line":14,"column":44},"end":{"line":49,"column":1}},"line":14},"1":{"name":"_callee","decl":{"start":{"line":15,"column":81},"end":{"line":15,"column":88}},"loc":{"start":{"line":15,"column":99},"end":{"line":44,"column":5}},"line":15},"2":{"name":"_callee$","decl":{"start":{"line":18,"column":49},"end":{"line":18,"column":57}},"loc":{"start":{"line":18,"column":68},"end":{"line":43,"column":9}},"line":18},"3":{"name":"(anonymous_3)","decl":{"start":{"line":46,"column":11},"end":{"line":46,"column":12}},"loc":{"start":{"line":46,"column":30},"end":{"line":48,"column":5}},"line":46}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":16},"end":{"line":41,"column":17}},"type":"switch","locations":[{"start":{"line":21,"column":20},"end":{"line":25,"column":88}},{"start":{"line":27,"column":20},"end":{"line":30,"column":30}},{"start":{"line":32,"column":20},"end":{"line":36,"column":84}},{"start":{"line":38,"column":20},"end":{"line":38,"column":28}},{"start":{"line":39,"column":20},"end":{"line":40,"column":47}}],"line":20}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":2,"7":3,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":0,"16":0,"17":0,"18":1,"19":1,"20":1},"f":{"0":1,"1":1,"2":2,"3":1},"b":{"0":[1,1,0,1,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/verify/verify.route.js"],"names":["express","DisputeController","sendCustormerVerificationCode","Router","param","getInvoiceId","route","get","req","res","invoice","customerEmail","verifyCode","send","success","status","error"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,+BAA9B;AACA,SAASC,6BAAT,QAA8C,sBAA9C;;AAEA,IAAMC,SAASH,QAAQG,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,WAAb,EAA0BH,kBAAkBI,YAA5C;;AAEAF,OAAOG,KAAP,CAAa,aAAb,EACKC,GADL;AAAA,wEACS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uCACqCD,IAAIE,OADzC,EACOC,aADP,gBACOA,aADP,EACsBC,UADtB,gBACsBA,UADtB;AAAA;AAAA;AAAA,+BAISV,8BAA8BS,aAA9B,EAA6CC,UAA7C,CAJT;;AAAA;AAKGH,4BAAII,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAT;AALH;AAAA;;AAAA;AAAA;AAAA;;AAOGL,4BAAIM,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB,EAAEE,QAAQ,KAAV,EAAiBC,kBAAjB,EAArB;;AAPH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAYA,eAAeb,MAAf","file":"verify.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport DisputeController from '../dispute/dispute.controller';\nimport { sendCustormerVerificationCode } from '../../modules/mailer';\n\nconst Router = express.Router();\n\nRouter.param('invoiceId', DisputeController.getInvoiceId);\n\nRouter.route('/:invoiceId')\n    .get(async (req, res) => {\n        const { customerEmail, verifyCode } = req.invoice;\n\n        try {\n            await sendCustormerVerificationCode(customerEmail, verifyCode);\n            res.send({ success: true });\n        } catch (error) {\n            res.status(400).send({ status: false, error });\n        }\n    });\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"3e3ed174ba3cd9b8a308e49b5f7e7635103460b0"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/recode.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/recode.js","statementMap":{"0":{"start":{"line":1,"column":18},"end":{"line":4,"column":1}},"1":{"start":{"line":2,"column":16},"end":{"line":2,"column":44}},"2":{"start":{"line":3,"column":4},"end":{"line":3,"column":66}},"3":{"start":{"line":6,"column":16},"end":{"line":8,"column":1}},"4":{"start":{"line":7,"column":4},"end":{"line":7,"column":41}},"5":{"start":{"line":11,"column":4},"end":{"line":11,"column":104}}},"fnMap":{"0":{"name":"randomAlpha","decl":{"start":{"line":1,"column":27},"end":{"line":1,"column":38}},"loc":{"start":{"line":1,"column":41},"end":{"line":4,"column":1}},"line":1},"1":{"name":"randomNum","decl":{"start":{"line":6,"column":25},"end":{"line":6,"column":34}},"loc":{"start":{"line":6,"column":37},"end":{"line":8,"column":1}},"line":6},"2":{"name":"(anonymous_2)","decl":{"start":{"line":10,"column":16},"end":{"line":10,"column":17}},"loc":{"start":{"line":10,"column":28},"end":{"line":12,"column":1}},"line":10}},"branchMap":{},"s":{"0":1,"1":0,"2":0,"3":1,"4":0,"5":0},"f":{"0":0,"1":0,"2":0},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/modules/recode.js"],"names":["randomAlpha","alpha","charAt","Math","floor","random","length","randomNum"],"mappings":"AAAA,IAAMA,cAAc,SAAdA,WAAc,GAAM;AACtB,QAAMC,QAAQ,4BAAd;AACA,WAAOA,MAAMC,MAAN,CAAaC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgBJ,MAAMK,MAAjC,CAAb,CAAP;AACH,CAHD;;AAKA,IAAMC,YAAY,SAAZA,SAAY,GAAM;AACpB,WAAOJ,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,CAA3B,CAAP;AACH,CAFD;;AAIA,gBAAe,YAAM;AACjB,gBAAUL,aAAV,GAA0BO,WAA1B,GAAwCP,aAAxC,GAAwDO,WAAxD,GAAsEP,aAAtE,GAAsFO,WAAtF;AACH,CAFD","file":"recode.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["const randomAlpha = () => {\n    const alpha = 'abcdefghijklmnopqrstuvwxyz';\n    return alpha.charAt(Math.floor(Math.random() * alpha.length));\n};\n\nconst randomNum = () => {\n    return Math.floor(Math.random() * 9);\n};\n\nexport default () => {\n    return `${randomAlpha()}${randomNum()}${randomAlpha()}${randomNum()}${randomAlpha()}${randomNum()}`\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"eabd92c8955dc2b091f1fe39f37be52b6aa75689"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.controller.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":13,"column":19},"end":{"line":13,"column":27}},"2":{"start":{"line":14,"column":8},"end":{"line":14,"column":34}},"3":{"start":{"line":15,"column":8},"end":{"line":15,"column":44}},"4":{"start":{"line":16,"column":8},"end":{"line":16,"column":29}},"5":{"start":{"line":17,"column":8},"end":{"line":17,"column":85}},"6":{"start":{"line":19,"column":8},"end":{"line":63,"column":13}},"7":{"start":{"line":20,"column":23},"end":{"line":58,"column":15}},"8":{"start":{"line":21,"column":16},"end":{"line":57,"column":45}},"9":{"start":{"line":22,"column":20},"end":{"line":56,"column":21}},"10":{"start":{"line":23,"column":24},"end":{"line":55,"column":25}},"11":{"start":{"line":25,"column":32},"end":{"line":28,"column":33}},"12":{"start":{"line":26,"column":36},"end":{"line":26,"column":54}},"13":{"start":{"line":27,"column":36},"end":{"line":27,"column":42}},"14":{"start":{"line":30,"column":32},"end":{"line":30,"column":159}},"15":{"start":{"line":33,"column":32},"end":{"line":33,"column":50}},"16":{"start":{"line":35,"column":32},"end":{"line":35,"column":54}},"17":{"start":{"line":36,"column":32},"end":{"line":36,"column":50}},"18":{"start":{"line":37,"column":32},"end":{"line":37,"column":67}},"19":{"start":{"line":40,"column":32},"end":{"line":40,"column":51}},"20":{"start":{"line":41,"column":32},"end":{"line":41,"column":38}},"21":{"start":{"line":44,"column":32},"end":{"line":44,"column":50}},"22":{"start":{"line":45,"column":32},"end":{"line":45,"column":67}},"23":{"start":{"line":46,"column":32},"end":{"line":46,"column":150}},"24":{"start":{"line":50,"column":32},"end":{"line":50,"column":71}},"25":{"start":{"line":54,"column":32},"end":{"line":54,"column":55}},"26":{"start":{"line":60,"column":12},"end":{"line":62,"column":14}},"27":{"start":{"line":61,"column":16},"end":{"line":61,"column":51}}},"fnMap":{"0":{"name":"createOne","decl":{"start":{"line":12,"column":24},"end":{"line":12,"column":33}},"loc":{"start":{"line":12,"column":44},"end":{"line":64,"column":5}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":19,"column":34},"end":{"line":19,"column":35}},"loc":{"start":{"line":19,"column":46},"end":{"line":63,"column":9}},"line":19},"2":{"name":"_callee","decl":{"start":{"line":20,"column":89},"end":{"line":20,"column":96}},"loc":{"start":{"line":20,"column":107},"end":{"line":58,"column":13}},"line":20},"3":{"name":"_callee$","decl":{"start":{"line":21,"column":57},"end":{"line":21,"column":65}},"loc":{"start":{"line":21,"column":76},"end":{"line":57,"column":17}},"line":21},"4":{"name":"(anonymous_4)","decl":{"start":{"line":60,"column":19},"end":{"line":60,"column":20}},"loc":{"start":{"line":60,"column":38},"end":{"line":62,"column":13}},"line":60}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":26},"end":{"line":17,"column":84}},"type":"cond-expr","locations":[{"start":{"line":17,"column":63},"end":{"line":17,"column":73}},{"start":{"line":17,"column":76},"end":{"line":17,"column":84}}],"line":17},"1":{"loc":{"start":{"line":23,"column":24},"end":{"line":55,"column":25}},"type":"switch","locations":[{"start":{"line":24,"column":28},"end":{"line":30,"column":159}},{"start":{"line":32,"column":28},"end":{"line":37,"column":67}},{"start":{"line":39,"column":28},"end":{"line":41,"column":38}},{"start":{"line":43,"column":28},"end":{"line":46,"column":150}},{"start":{"line":48,"column":28},"end":{"line":50,"column":71}},{"start":{"line":52,"column":28},"end":{"line":52,"column":36}},{"start":{"line":53,"column":28},"end":{"line":54,"column":55}}],"line":23},"2":{"loc":{"start":{"line":25,"column":32},"end":{"line":28,"column":33}},"type":"if","locations":[{"start":{"line":25,"column":32},"end":{"line":28,"column":33}},{"start":{"line":25,"column":32},"end":{"line":28,"column":33}}],"line":25}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":2,"10":4,"11":1,"12":1,"13":1,"14":0,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1},"f":{"0":1,"1":1,"2":1,"3":2,"4":1},"b":{"0":[1,0],"1":[1,1,1,0,1,1,1],"2":[1,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.controller.js"],"names":["InvoiceModel","mailer","recode","generateController","createOne","req","res","body","userId","user","id","marchantEmail","email","status","verifyCode","process","env","NODE_ENV","create","err","doc","send","error","message","success","sendInvoiceMail","data"],"mappings":";;;;;AAAA,OAAOA,YAAP,MAAyB,iBAAzB;AACA,OAAO,KAAKC,MAAZ,MAAwB,sBAAxB;AACA,OAAOC,MAAP,MAAmB,sBAAnB;AACA,OAAOC,kBAAP,MAA+B,kCAA/B;;AAGA,eAAeA,mBAAmBH,YAAnB,EAAiC;AAC5CI,eAAW,mBAACC,GAAD,EAAMC,GAAN,EAAc;AACrB,YAAIC,OAAOF,IAAIE,IAAf;AACAA,aAAKC,MAAL,GAAcH,IAAII,IAAJ,CAASC,EAAvB;AACAH,aAAKI,aAAL,GAAqBN,IAAII,IAAJ,CAASG,KAA9B;AACAL,aAAKM,MAAL,GAAc,MAAd;AACAN,aAAKO,UAAL,GAAkBC,QAAQC,GAAR,CAAYC,QAAZ,KAAyB,SAAzB,GAAqC,UAArC,GAAkDf,QAApE;;AAEAF,qBAAakB,MAAb,CAAoBX,IAApB;AAAA,gFAA0B,iBAAOY,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,qCAClBD,GADkB;AAAA;AAAA;AAAA;;AAAA,iEACNb,IAAIO,MAAJ,CAAW,GAAX,EAAgBQ,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,8BAAX,EAAT,EAAsDC,SAAS,KAA/D,EAArB,CADM;;AAAA;AAAA;;AAIlB,uCAAOJ,IAAIN,UAAX;AAJkB;AAAA,uCAKZb,OAAOwB,eAAP,CAAuBL,GAAvB,CALY;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA,iEAOXd,IAAIO,MAAJ,CAAW,GAAX,EAAgBQ,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,qBAAX,EAAT,EAA6CC,SAAS,KAAtD,EAArB,CAPW;;AAAA;;AAUtBlB,oCAAIe,IAAJ,CAAS,EAAEK,MAAMN,GAAR,EAAaI,SAAS,IAAtB,EAAT;;AAVsB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAA1B;;AAAA;AAAA;AAAA;AAAA;AAYH;AApB2C,CAAjC,CAAf","file":"invoice.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import InvoiceModel from './invoice.model';\nimport * as mailer from '../../modules/mailer';\nimport recode from '../../modules/recode';\nimport generateController from '../../modules/generateController';\n\n\nexport default generateController(InvoiceModel, {\n    createOne: (req, res) => {\n        var body = req.body;\n        body.userId = req.user.id;\n        body.marchantEmail = req.user.email;\n        body.status = \"sent\";\n        body.verifyCode = process.env.NODE_ENV === 'testing' ? 'AXYZ0000' : recode();\n        \n        InvoiceModel.create(body, async (err, doc) => {\n            if (err) return res.status(500).send({ error: { message: 'Could not create the invoice' }, success: false });\n\n            try {\n                delete doc.verifyCode;\n                await mailer.sendInvoiceMail(doc);\n            } catch (err) {\n                return res.status(500).send({ error: { message: 'Could not send mail' }, success: false });\n            }\n            \n            res.send({ data: doc, success: true });\n        });\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"d2d005397bb527d1d6779e28f464dcd50baa2721"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.route.js","statementMap":{"0":{"start":{"line":4,"column":20},"end":{"line":4,"column":36}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":57}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":59}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":94}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.route.js"],"names":["express","InvoiceController","InvoiceRouter","Router","param","findByParam","route","post","createOne","get","getOne","delete","deleteOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;;AAEA,IAAMC,gBAAgBF,QAAQG,MAAR,EAAtB;;AAEAD,cAAcE,KAAd,CAAoB,IAApB,EAA0BH,kBAAkBI,WAA5C;;AAEAH,cAAcI,KAAd,CAAoB,GAApB,EACKC,IADL,CACUN,kBAAkBO,SAD5B;;AAGAN,cAAcI,KAAd,CAAoB,MAApB,EACKG,GADL,CACSR,kBAAkBS,MAD3B,EAEKC,MAFL,CAEYV,kBAAkBW,SAF9B;;AAIA,eAAeV,aAAf","file":"invoice.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport InvoiceController from './invoice.controller';\n\nconst InvoiceRouter = express.Router();\n\nInvoiceRouter.param('id', InvoiceController.findByParam);\n\nInvoiceRouter.route('/')\n    .post(InvoiceController.createOne);\n\nInvoiceRouter.route('/:id')\n    .get(InvoiceController.getOne)\n    .delete(InvoiceController.deleteOne);\n\nexport default InvoiceRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"973b2e6590768c65707300b1a223369f43b7fa35"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":9,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.model.js"],"names":["mongoose","PaymentSchema","Schema","marchantEmail","String","customerEmail","amount","Number","invoiceId","reference","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,mBAAeC,MADuB;AAEtCC,mBAAeD,MAFuB;AAGtCE,YAAQC,MAH8B;AAItCC,eAAWJ,MAJ2B;AAKtCK,eAAWL;AAL2B,CAApB,CAAtB;;AAQA,eAAeJ,SAASU,KAAT,CAAe,SAAf,EAA0BT,aAA1B,CAAf","file":"payment.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst PaymentSchema = new mongoose.Schema({\n    marchantEmail: String,\n    customerEmail: String,\n    amount: Number,\n    invoiceId: String,\n    reference: String\n});\n\nexport default mongoose.model('Payment', PaymentSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"9e15a13fd93cf962a8c5c8090d8e6bb47055ee25"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.controller.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":14,"column":13},"end":{"line":14,"column":40}},"2":{"start":{"line":18,"column":19},"end":{"line":18,"column":102}},"3":{"start":{"line":19,"column":24},"end":{"line":19,"column":32}},"4":{"start":{"line":20,"column":20},"end":{"line":20,"column":35}},"5":{"start":{"line":21,"column":29},"end":{"line":21,"column":43}},"6":{"start":{"line":22,"column":24},"end":{"line":22,"column":48}},"7":{"start":{"line":23,"column":21},"end":{"line":23,"column":42}},"8":{"start":{"line":24,"column":36},"end":{"line":24,"column":59}},"9":{"start":{"line":25,"column":25},"end":{"line":25,"column":57}},"10":{"start":{"line":26,"column":24},"end":{"line":26,"column":55}},"11":{"start":{"line":27,"column":20},"end":{"line":27,"column":47}},"12":{"start":{"line":28,"column":37},"end":{"line":28,"column":67}},"13":{"start":{"line":29,"column":28},"end":{"line":29,"column":64}},"14":{"start":{"line":30,"column":24},"end":{"line":30,"column":56}},"15":{"start":{"line":33,"column":8},"end":{"line":80,"column":9}},"16":{"start":{"line":34,"column":12},"end":{"line":77,"column":15}},"17":{"start":{"line":35,"column":16},"end":{"line":35,"column":97}},"18":{"start":{"line":35,"column":25},"end":{"line":35,"column":97}},"19":{"start":{"line":37,"column":16},"end":{"line":76,"column":21}},"20":{"start":{"line":38,"column":31},"end":{"line":71,"column":23}},"21":{"start":{"line":39,"column":24},"end":{"line":70,"column":53}},"22":{"start":{"line":40,"column":28},"end":{"line":69,"column":29}},"23":{"start":{"line":41,"column":32},"end":{"line":68,"column":33}},"24":{"start":{"line":43,"column":40},"end":{"line":46,"column":41}},"25":{"start":{"line":44,"column":44},"end":{"line":44,"column":62}},"26":{"start":{"line":45,"column":44},"end":{"line":45,"column":50}},"27":{"start":{"line":48,"column":40},"end":{"line":48,"column":139}},"28":{"start":{"line":51,"column":40},"end":{"line":51,"column":58}},"29":{"start":{"line":52,"column":40},"end":{"line":52,"column":58}},"30":{"start":{"line":53,"column":40},"end":{"line":53,"column":130}},"31":{"start":{"line":56,"column":40},"end":{"line":56,"column":80}},"32":{"start":{"line":57,"column":40},"end":{"line":57,"column":59}},"33":{"start":{"line":58,"column":40},"end":{"line":58,"column":46}},"34":{"start":{"line":61,"column":40},"end":{"line":61,"column":58}},"35":{"start":{"line":62,"column":40},"end":{"line":62,"column":75}},"36":{"start":{"line":63,"column":40},"end":{"line":63,"column":158}},"37":{"start":{"line":67,"column":40},"end":{"line":67,"column":63}},"38":{"start":{"line":73,"column":20},"end":{"line":75,"column":22}},"39":{"start":{"line":74,"column":24},"end":{"line":74,"column":59}},"40":{"start":{"line":79,"column":12},"end":{"line":79,"column":53}},"41":{"start":{"line":83,"column":17},"end":{"line":83,"column":37}},"42":{"start":{"line":84,"column":8},"end":{"line":87,"column":11}},"43":{"start":{"line":85,"column":12},"end":{"line":85,"column":88}},"44":{"start":{"line":85,"column":21},"end":{"line":85,"column":88}},"45":{"start":{"line":86,"column":12},"end":{"line":86,"column":63}}},"fnMap":{"0":{"name":"createOne","decl":{"start":{"line":17,"column":24},"end":{"line":17,"column":33}},"loc":{"start":{"line":17,"column":44},"end":{"line":81,"column":5}},"line":17},"1":{"name":"(anonymous_1)","decl":{"start":{"line":34,"column":148},"end":{"line":34,"column":149}},"loc":{"start":{"line":34,"column":163},"end":{"line":77,"column":13}},"line":34},"2":{"name":"(anonymous_2)","decl":{"start":{"line":37,"column":79},"end":{"line":37,"column":80}},"loc":{"start":{"line":37,"column":91},"end":{"line":76,"column":17}},"line":37},"3":{"name":"_callee","decl":{"start":{"line":38,"column":97},"end":{"line":38,"column":104}},"loc":{"start":{"line":38,"column":110},"end":{"line":71,"column":21}},"line":38},"4":{"name":"_callee$","decl":{"start":{"line":39,"column":65},"end":{"line":39,"column":73}},"loc":{"start":{"line":39,"column":84},"end":{"line":70,"column":25}},"line":39},"5":{"name":"(anonymous_5)","decl":{"start":{"line":73,"column":27},"end":{"line":73,"column":28}},"loc":{"start":{"line":73,"column":41},"end":{"line":75,"column":21}},"line":73},"6":{"name":"getOne","decl":{"start":{"line":82,"column":21},"end":{"line":82,"column":27}},"loc":{"start":{"line":82,"column":38},"end":{"line":88,"column":5}},"line":82},"7":{"name":"(anonymous_7)","decl":{"start":{"line":84,"column":48},"end":{"line":84,"column":49}},"loc":{"start":{"line":84,"column":68},"end":{"line":87,"column":9}},"line":84}},"branchMap":{"0":{"loc":{"start":{"line":33,"column":8},"end":{"line":80,"column":9}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":80,"column":9}},{"start":{"line":33,"column":8},"end":{"line":80,"column":9}}],"line":33},"1":{"loc":{"start":{"line":33,"column":12},"end":{"line":33,"column":86}},"type":"binary-expr","locations":[{"start":{"line":33,"column":12},"end":{"line":33,"column":56}},{"start":{"line":33,"column":60},"end":{"line":33,"column":86}}],"line":33},"2":{"loc":{"start":{"line":35,"column":16},"end":{"line":35,"column":97}},"type":"if","locations":[{"start":{"line":35,"column":16},"end":{"line":35,"column":97}},{"start":{"line":35,"column":16},"end":{"line":35,"column":97}}],"line":35},"3":{"loc":{"start":{"line":41,"column":32},"end":{"line":68,"column":33}},"type":"switch","locations":[{"start":{"line":42,"column":36},"end":{"line":48,"column":139}},{"start":{"line":50,"column":36},"end":{"line":53,"column":130}},{"start":{"line":55,"column":36},"end":{"line":58,"column":46}},{"start":{"line":60,"column":36},"end":{"line":63,"column":158}},{"start":{"line":65,"column":36},"end":{"line":65,"column":44}},{"start":{"line":66,"column":36},"end":{"line":67,"column":63}}],"line":41},"4":{"loc":{"start":{"line":43,"column":40},"end":{"line":46,"column":41}},"type":"if","locations":[{"start":{"line":43,"column":40},"end":{"line":46,"column":41}},{"start":{"line":43,"column":40},"end":{"line":46,"column":41}}],"line":43},"5":{"loc":{"start":{"line":85,"column":12},"end":{"line":85,"column":88}},"type":"if","locations":[{"start":{"line":85,"column":12},"end":{"line":85,"column":88}},{"start":{"line":85,"column":12},"end":{"line":85,"column":88}}],"line":85}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":0,"19":1,"20":1,"21":1,"22":2,"23":4,"24":1,"25":1,"26":1,"27":0,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":0,"35":0,"36":0,"37":1,"38":1,"39":1,"40":0,"41":1,"42":1,"43":1,"44":0,"45":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":2,"5":1,"6":1,"7":1},"b":{"0":[1,0],"1":[1,1],"2":[0,1],"3":[1,1,1,0,1,1],"4":[1,0],"5":[0,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.controller.js"],"names":["crypto","PaymentModel","InvoiceModel","mailer","generateController","secret","process","env","PAYSTACK_SECRET","createOne","req","res","hash","createHmac","update","body","digest","event","data","reference","amount","customer","first_name","last_name","email","metadata","marchantEmail","invoiceId","headers","create","customerEmail","err","status","send","error","Error","updateOne","_id","sendReceiptMail","success","message","getOne","id","params","findOne","doc"],"mappings":"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","file":"payment.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import crypto from 'crypto';\nimport PaymentModel from './payment.model';\nimport InvoiceModel from '../invoice/invoice.model';\nimport * as mailer from '../../modules/mailer';\nimport generateController from '../../modules/generateController';\n\nconst secret = process.env.PAYSTACK_SECRET;\n\nexport default generateController(PaymentModel, {\n    createOne: (req, res) => {\n        const hash = crypto.createHmac('sha512', secret).update(JSON.stringify(req.body)).digest('hex');\n        const { event, data: { reference, amount, customer: { first_name, last_name, email, metadata: { marchantEmail, invoiceId } } } } = req.body;\n\n        if (hash === req.headers['x-paystack-signature'] && event === 'charge.success') {\n            PaymentModel.create({ customerEmail: email, marchantEmail, reference, amount, invoiceId }, (err) => {\n                if (err) return res.status(500).send({ error: new Error(error), status: false });\n                \n                InvoiceModel.updateOne({ _id: invoiceId }, { status: 'paid' }, async (err) => {\n                    if (err) return res.status(500).send({ error: new Error(error), status: false });\n                    try {\n                        await mailer.sendReceiptMail(`${first_name} ${last_name}`, email, marchantEmail, amount);\n                        res.status(200).send({ success: true });\n                    } catch (err) {\n                        return res.status(500).send({ error: { message: 'Could not send mail' }, success: false });\n                    }\n                })\n            });\n        } else {\n            res.status(500).send({ success: false });\n        }\n    },\n    getOne: (req, res) => {\n        var id = req.params.invoiceId;\n        PaymentModel.findOne({ invoiceId: id }, function (err, doc) {\n            if (err) res.status(401).send({ success: false, error: { ...err } });\n            res.status(200).send({ success: true, data: doc });\n        });\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"eaddbe164c21c52440fa202d57b423aad4e88860"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.route.js","statementMap":{"0":{"start":{"line":4,"column":13},"end":{"line":4,"column":29}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":52}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":58}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.route.js"],"names":["express","PaymentController","Router","param","findByParam","route","post","createOne","get","getOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;;AAEA,IAAMC,SAASF,QAAQE,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,MAAb,EAAqBF,kBAAkBG,WAAvC;;AAEAF,OAAOG,KAAP,CAAa,GAAb,EACKC,IADL,CACUL,kBAAkBM,SAD5B;;AAGAL,OAAOG,KAAP,CAAa,aAAb,EACKG,GADL,CACSP,kBAAkBQ,MAD3B;;AAGA,eAAeP,MAAf","file":"payment.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport PaymentController from './payment.controller';\n\nconst Router = express.Router();\n\nRouter.param('/:id', PaymentController.findByParam);\n\nRouter.route('/')\n    .post(PaymentController.createOne);\n\nRouter.route('/:invoiceId')\n    .get(PaymentController.getOne);\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"bff3eb91f1d9edf483dc6a5e0a347972d7729f9d"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.route.js","statementMap":{"0":{"start":{"line":3,"column":13},"end":{"line":3,"column":29}},"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":58}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":92}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.route.js"],"names":["express","DisputeController","Router","param","getInvoiceId","route","post","createOne","get","getOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;AACA,IAAMC,SAASF,QAAQE,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,WAAb,EAA0BF,kBAAkBG,YAA5C;;AAEAF,OAAOG,KAAP,CAAa,aAAb,EACKC,IADL,CACUL,kBAAkBM,SAD5B,EAEKC,GAFL,CAESP,kBAAkBQ,MAF3B;;AAIA,eAAeP,MAAf","file":"dispute.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport DisputeController from './dispute.controller';\nconst Router = express.Router();\n\nRouter.param('invoiceId', DisputeController.getInvoiceId);\n\nRouter.route('/:invoiceId')\n    .post(DisputeController.createOne)\n    .get(DisputeController.getOne);\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"1a94a95238012cbf38920e457e966864e29338fd"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/transfer.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/transfer.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":8,"column":13},"end":{"line":8,"column":40}},"2":{"start":{"line":10,"column":17},"end":{"line":23,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":22,"column":7}},"4":{"start":{"line":12,"column":8},"end":{"line":21,"column":11}},"5":{"start":{"line":19,"column":12},"end":{"line":19,"column":33}},"6":{"start":{"line":19,"column":21},"end":{"line":19,"column":33}},"7":{"start":{"line":20,"column":12},"end":{"line":20,"column":26}},"8":{"start":{"line":25,"column":19},"end":{"line":37,"column":1}},"9":{"start":{"line":26,"column":4},"end":{"line":36,"column":7}},"10":{"start":{"line":27,"column":8},"end":{"line":35,"column":11}},"11":{"start":{"line":33,"column":12},"end":{"line":33,"column":33}},"12":{"start":{"line":33,"column":21},"end":{"line":33,"column":33}},"13":{"start":{"line":34,"column":12},"end":{"line":34,"column":26}},"14":{"start":{"line":39,"column":15},"end":{"line":115,"column":3}},"15":{"start":{"line":40,"column":15},"end":{"line":110,"column":7}},"16":{"start":{"line":41,"column":8},"end":{"line":109,"column":28}},"17":{"start":{"line":42,"column":12},"end":{"line":108,"column":13}},"18":{"start":{"line":43,"column":16},"end":{"line":107,"column":17}},"19":{"start":{"line":45,"column":24},"end":{"line":102,"column":30}},"20":{"start":{"line":46,"column":40},"end":{"line":97,"column":31}},"21":{"start":{"line":49,"column":32},"end":{"line":96,"column":62}},"22":{"start":{"line":50,"column":36},"end":{"line":95,"column":37}},"23":{"start":{"line":51,"column":40},"end":{"line":94,"column":41}},"24":{"start":{"line":53,"column":48},"end":{"line":53,"column":66}},"25":{"start":{"line":54,"column":48},"end":{"line":54,"column":66}},"26":{"start":{"line":55,"column":48},"end":{"line":55,"column":99}},"27":{"start":{"line":58,"column":48},"end":{"line":58,"column":70}},"28":{"start":{"line":59,"column":48},"end":{"line":59,"column":70}},"29":{"start":{"line":60,"column":48},"end":{"line":60,"column":91}},"30":{"start":{"line":62,"column":48},"end":{"line":65,"column":49}},"31":{"start":{"line":63,"column":52},"end":{"line":63,"column":71}},"32":{"start":{"line":64,"column":52},"end":{"line":64,"column":58}},"33":{"start":{"line":67,"column":48},"end":{"line":67,"column":66}},"34":{"start":{"line":68,"column":48},"end":{"line":68,"column":92}},"35":{"start":{"line":71,"column":48},"end":{"line":71,"column":70}},"36":{"start":{"line":72,"column":48},"end":{"line":72,"column":71}},"37":{"start":{"line":74,"column":48},"end":{"line":74,"column":71}},"38":{"start":{"line":74,"column":61},"end":{"line":74,"column":71}},"39":{"start":{"line":75,"column":48},"end":{"line":75,"column":67}},"40":{"start":{"line":76,"column":48},"end":{"line":76,"column":54}},"41":{"start":{"line":79,"column":48},"end":{"line":79,"column":87}},"42":{"start":{"line":82,"column":48},"end":{"line":82,"column":67}},"43":{"start":{"line":83,"column":48},"end":{"line":83,"column":54}},"44":{"start":{"line":86,"column":48},"end":{"line":86,"column":67}},"45":{"start":{"line":87,"column":48},"end":{"line":87,"column":83}},"46":{"start":{"line":89,"column":48},"end":{"line":89,"column":68}},"47":{"start":{"line":93,"column":48},"end":{"line":93,"column":71}},"48":{"start":{"line":99,"column":28},"end":{"line":101,"column":30}},"49":{"start":{"line":100,"column":32},"end":{"line":100,"column":68}},"50":{"start":{"line":106,"column":24},"end":{"line":106,"column":48}},"51":{"start":{"line":112,"column":4},"end":{"line":114,"column":6}},"52":{"start":{"line":113,"column":8},"end":{"line":113,"column":43}}},"fnMap":{"0":{"name":"getReceipt","decl":{"start":{"line":10,"column":26},"end":{"line":10,"column":36}},"loc":{"start":{"line":10,"column":70},"end":{"line":23,"column":1}},"line":10},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":24},"end":{"line":11,"column":25}},"loc":{"start":{"line":11,"column":51},"end":{"line":22,"column":5}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":18,"column":15},"end":{"line":18,"column":16}},"loc":{"start":{"line":18,"column":36},"end":{"line":21,"column":9}},"line":18},"3":{"name":"makeTransfer","decl":{"start":{"line":25,"column":28},"end":{"line":25,"column":40}},"loc":{"start":{"line":25,"column":65},"end":{"line":37,"column":1}},"line":25},"4":{"name":"(anonymous_4)","decl":{"start":{"line":26,"column":24},"end":{"line":26,"column":25}},"loc":{"start":{"line":26,"column":51},"end":{"line":36,"column":5}},"line":26},"5":{"name":"(anonymous_5)","decl":{"start":{"line":32,"column":15},"end":{"line":32,"column":16}},"loc":{"start":{"line":32,"column":36},"end":{"line":35,"column":9}},"line":32},"6":{"name":"(anonymous_6)","decl":{"start":{"line":39,"column":15},"end":{"line":39,"column":16}},"loc":{"start":{"line":39,"column":27},"end":{"line":115,"column":1}},"line":39},"7":{"name":"_callee2","decl":{"start":{"line":40,"column":81},"end":{"line":40,"column":89}},"loc":{"start":{"line":40,"column":131},"end":{"line":110,"column":5}},"line":40},"8":{"name":"_callee2$","decl":{"start":{"line":41,"column":49},"end":{"line":41,"column":58}},"loc":{"start":{"line":41,"column":70},"end":{"line":109,"column":9}},"line":41},"9":{"name":"(anonymous_9)","decl":{"start":{"line":45,"column":71},"end":{"line":45,"column":72}},"loc":{"start":{"line":45,"column":83},"end":{"line":102,"column":25}},"line":45},"10":{"name":"_callee","decl":{"start":{"line":46,"column":106},"end":{"line":46,"column":113}},"loc":{"start":{"line":46,"column":131},"end":{"line":97,"column":29}},"line":46},"11":{"name":"_callee$","decl":{"start":{"line":49,"column":73},"end":{"line":49,"column":81}},"loc":{"start":{"line":49,"column":92},"end":{"line":96,"column":33}},"line":49},"12":{"name":"(anonymous_12)","decl":{"start":{"line":99,"column":35},"end":{"line":99,"column":36}},"loc":{"start":{"line":99,"column":55},"end":{"line":101,"column":29}},"line":99},"13":{"name":"transfer","decl":{"start":{"line":112,"column":20},"end":{"line":112,"column":28}},"loc":{"start":{"line":112,"column":48},"end":{"line":114,"column":5}},"line":112}},"branchMap":{"0":{"loc":{"start":{"line":19,"column":12},"end":{"line":19,"column":33}},"type":"if","locations":[{"start":{"line":19,"column":12},"end":{"line":19,"column":33}},{"start":{"line":19,"column":12},"end":{"line":19,"column":33}}],"line":19},"1":{"loc":{"start":{"line":33,"column":12},"end":{"line":33,"column":33}},"type":"if","locations":[{"start":{"line":33,"column":12},"end":{"line":33,"column":33}},{"start":{"line":33,"column":12},"end":{"line":33,"column":33}}],"line":33},"2":{"loc":{"start":{"line":43,"column":16},"end":{"line":107,"column":17}},"type":"switch","locations":[{"start":{"line":44,"column":20},"end":{"line":102,"column":30}},{"start":{"line":104,"column":20},"end":{"line":104,"column":27}},{"start":{"line":105,"column":20},"end":{"line":106,"column":48}}],"line":43},"3":{"loc":{"start":{"line":51,"column":40},"end":{"line":94,"column":41}},"type":"switch","locations":[{"start":{"line":52,"column":44},"end":{"line":55,"column":99}},{"start":{"line":57,"column":44},"end":{"line":68,"column":92}},{"start":{"line":70,"column":44},"end":{"line":76,"column":54}},{"start":{"line":78,"column":44},"end":{"line":79,"column":87}},{"start":{"line":81,"column":44},"end":{"line":83,"column":54}},{"start":{"line":85,"column":44},"end":{"line":89,"column":68}},{"start":{"line":91,"column":44},"end":{"line":91,"column":52}},{"start":{"line":92,"column":44},"end":{"line":93,"column":71}}],"line":51},"4":{"loc":{"start":{"line":62,"column":48},"end":{"line":65,"column":49}},"type":"if","locations":[{"start":{"line":62,"column":48},"end":{"line":65,"column":49}},{"start":{"line":62,"column":48},"end":{"line":65,"column":49}}],"line":62},"5":{"loc":{"start":{"line":62,"column":54},"end":{"line":62,"column":78}},"type":"binary-expr","locations":[{"start":{"line":62,"column":54},"end":{"line":62,"column":60}},{"start":{"line":62,"column":64},"end":{"line":62,"column":78}}],"line":62},"6":{"loc":{"start":{"line":74,"column":48},"end":{"line":74,"column":71}},"type":"if","locations":[{"start":{"line":74,"column":48},"end":{"line":74,"column":71}},{"start":{"line":74,"column":48},"end":{"line":74,"column":71}}],"line":74}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":1,"16":1,"17":2,"18":2,"19":1,"20":1,"21":1,"22":2,"23":2,"24":1,"25":1,"26":1,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1},"f":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":1,"7":1,"8":2,"9":1,"10":1,"11":2,"12":1,"13":1},"b":{"0":[1,0],"1":[0,0],"2":[1,0,1],"3":[1,0,0,0,0,1,1,1],"4":[0,0],"5":[0,0],"6":[0,0]},"inputSourceMap":{"version":3,"sources":["src/api/modules/transfer.js"],"names":["request","secret","process","env","PAYSTACK_SECRET","getReceipt","name","account_number","bank_code","resolve","reject","post","set","send","currency","end","err","data","makeTransfer","recipient_code","amount","transfer","status","Error"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;;AAEA,IAAMC,aAAa,SAAbA,UAAa,CAACC,IAAD,EAAOC,cAAP,EAAuBC,SAAvB;AAAA,WAAqC,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACrFV,gBACKW,IADL,8CAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACF,oBAAQ,OADN;AAEFP,sBAFE;AAGFC,0CAHE;AAIFC,gCAJE;AAKFM,sBAAU;AALR,SAHV,EAUKC,GAVL,CAUS,UAACC,GAAD,EAAMC,IAAN,EAAe;AAChB,gBAAID,GAAJ,EAASN,OAAOM,GAAP;AACTP,oBAAQQ,IAAR;AACH,SAbL;AAcH,KAfuD,CAArC;AAAA,CAAnB;;AAiBA,IAAMC,eAAe,SAAfA,YAAe,CAACC,cAAD,EAAiBC,MAAjB;AAAA,WAA4B,aAAY,UAACX,OAAD,EAAUC,MAAV,EAAqB;AAC9EV,gBACKW,IADL,qCAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACF,sBAAU,SADR;AAEFO,0BAFE;AAGFD,0CAHE;AAIFL,sBAAU;AAJR,SAHV,EASKC,GATL,CASS,UAACC,GAAD,EAAMC,IAAN,EAAe;AAChB,gBAAID,GAAJ,EAASN,OAAOM,GAAP;AACTP,oBAAQQ,IAAR;AACH,SAZL;AAaH,KAdgD,CAA5B;AAAA,CAArB;;AAgBA,IAAMI;AAAA,wEAAW,kBAAOf,IAAP,EAAaC,cAAb,EAA6BC,SAA7B,EAAwCY,MAAxC;AAAA;AAAA;AAAA;AAAA;AAAA,0DAAmD;AAAA,iGAAY,iBAAOX,OAAP,EAAgBC,MAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uDAEpBL,WAAWC,IAAX,EAAiBC,cAAjB,EAAiCC,SAAjC,CAFoB;;AAAA;AAAA;AAEhEc,sDAFgE,SAEhEA,MAFgE;AAEhDH,8DAFgD,SAExDF,IAFwD,CAEhDE,cAFgD;;AAAA,sDAIpEG,UAAUH,cAJ0D;AAAA;AAAA;AAAA;;AAAA;AAAA,uDAK3CD,aAAaC,cAAb,EAA6BC,MAA7B,CAL2C;;AAAA;AAAA;AAK5DE,uDAL4D,SAK5DA,MAL4D;;AAMpE,oDAAIA,OAAJ,EAAYb;AANwD;AAAA;;AAAA;AAQpEC,uDAAO,IAAIa,KAAJ,CAAU,mBAAV,CAAP;;AARoE;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAWxEb;;AAXwE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,6BAAZ;;AAAA;AAAA;AAAA;AAAA,4BAAnD;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAX;;AAAA;AAAA;AAAA;AAAA,GAAN;;AAeA,eAAeW,QAAf","file":"transfer.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nconst secret = process.env.PAYSTACK_SECRET;\n\nconst getReceipt = (name, account_number, bank_code) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/transferrecipient`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            \"type\": \"nuban\",\n            name,\n            account_number,\n            bank_code,\n            currency: 'NGN'\n        })\n        .end((err, data) => {\n            if (err) reject(err);\n            resolve(data);\n        });\n})\n\nconst makeTransfer = (recipient_code, amount) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/transfer`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            \"source\": \"balance\",\n            amount,\n            recipient_code,\n            currency: 'NGN'\n        })\n        .end((err, data) => {\n            if (err) reject(err);\n            resolve(data);\n        });\n});\n\nconst transfer = async (name, account_number, bank_code, amount) => new Promise(async (resolve, reject) => {\n    try {\n        const { status, data: { recipient_code  } } = await getReceipt(name, account_number, bank_code);\n\n        if (status && recipient_code) {\n            const { status } = await makeTransfer(recipient_code, amount);\n            if (status) resolve();\n        } else {\n            reject(new Error('No recipient_code'));\n        }\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport default transfer;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"b0bfff6fa80bd4b60254b5edff00c2a630a99cd9"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/confirm/confirm.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/confirm/confirm.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":11,"column":20},"end":{"line":11,"column":36}},"2":{"start":{"line":13,"column":0},"end":{"line":13,"column":65}},"3":{"start":{"line":14,"column":0},"end":{"line":64,"column":3}},"4":{"start":{"line":15,"column":20},"end":{"line":15,"column":40}},"5":{"start":{"line":16,"column":17},"end":{"line":16,"column":60}},"6":{"start":{"line":17,"column":20},"end":{"line":17,"column":38}},"7":{"start":{"line":19,"column":4},"end":{"line":19,"column":134}},"8":{"start":{"line":19,"column":46},"end":{"line":19,"column":134}},"9":{"start":{"line":21,"column":4},"end":{"line":63,"column":9}},"10":{"start":{"line":22,"column":19},"end":{"line":58,"column":11}},"11":{"start":{"line":23,"column":12},"end":{"line":57,"column":41}},"12":{"start":{"line":24,"column":16},"end":{"line":56,"column":17}},"13":{"start":{"line":25,"column":20},"end":{"line":55,"column":21}},"14":{"start":{"line":27,"column":28},"end":{"line":27,"column":94}},"15":{"start":{"line":27,"column":39},"end":{"line":27,"column":94}},"16":{"start":{"line":29,"column":28},"end":{"line":32,"column":29}},"17":{"start":{"line":30,"column":32},"end":{"line":30,"column":51}},"18":{"start":{"line":31,"column":32},"end":{"line":31,"column":38}},"19":{"start":{"line":34,"column":28},"end":{"line":34,"column":46}},"20":{"start":{"line":35,"column":28},"end":{"line":35,"column":46}},"21":{"start":{"line":36,"column":28},"end":{"line":36,"column":46}},"22":{"start":{"line":39,"column":28},"end":{"line":39,"column":47}},"23":{"start":{"line":40,"column":28},"end":{"line":40,"column":34}},"24":{"start":{"line":43,"column":28},"end":{"line":43,"column":46}},"25":{"start":{"line":44,"column":28},"end":{"line":44,"column":63}},"26":{"start":{"line":46,"column":28},"end":{"line":46,"column":87}},"27":{"start":{"line":50,"column":28},"end":{"line":50,"column":80}},"28":{"start":{"line":54,"column":28},"end":{"line":54,"column":51}},"29":{"start":{"line":60,"column":8},"end":{"line":62,"column":10}},"30":{"start":{"line":61,"column":12},"end":{"line":61,"column":47}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":40},"end":{"line":14,"column":41}},"loc":{"start":{"line":14,"column":60},"end":{"line":64,"column":1}},"line":14},"1":{"name":"(anonymous_1)","decl":{"start":{"line":21,"column":99},"end":{"line":21,"column":100}},"loc":{"start":{"line":21,"column":111},"end":{"line":63,"column":5}},"line":21},"2":{"name":"_callee","decl":{"start":{"line":22,"column":85},"end":{"line":22,"column":92}},"loc":{"start":{"line":22,"column":106},"end":{"line":58,"column":9}},"line":22},"3":{"name":"_callee$","decl":{"start":{"line":23,"column":53},"end":{"line":23,"column":61}},"loc":{"start":{"line":23,"column":72},"end":{"line":57,"column":13}},"line":23},"4":{"name":"(anonymous_4)","decl":{"start":{"line":60,"column":15},"end":{"line":60,"column":16}},"loc":{"start":{"line":60,"column":34},"end":{"line":62,"column":9}},"line":60}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":17},"end":{"line":16,"column":60}},"type":"cond-expr","locations":[{"start":{"line":16,"column":37},"end":{"line":16,"column":47}},{"start":{"line":16,"column":50},"end":{"line":16,"column":60}}],"line":16},"1":{"loc":{"start":{"line":19,"column":4},"end":{"line":19,"column":134}},"type":"if","locations":[{"start":{"line":19,"column":4},"end":{"line":19,"column":134}},{"start":{"line":19,"column":4},"end":{"line":19,"column":134}}],"line":19},"2":{"loc":{"start":{"line":25,"column":20},"end":{"line":55,"column":21}},"type":"switch","locations":[{"start":{"line":26,"column":24},"end":{"line":36,"column":46}},{"start":{"line":38,"column":24},"end":{"line":40,"column":34}},{"start":{"line":42,"column":24},"end":{"line":46,"column":87}},{"start":{"line":48,"column":24},"end":{"line":50,"column":80}},{"start":{"line":52,"column":24},"end":{"line":52,"column":32}},{"start":{"line":53,"column":24},"end":{"line":54,"column":51}}],"line":25},"3":{"loc":{"start":{"line":27,"column":28},"end":{"line":27,"column":94}},"type":"if","locations":[{"start":{"line":27,"column":28},"end":{"line":27,"column":94}},{"start":{"line":27,"column":28},"end":{"line":27,"column":94}}],"line":27},"4":{"loc":{"start":{"line":29,"column":28},"end":{"line":32,"column":29}},"type":"if","locations":[{"start":{"line":29,"column":28},"end":{"line":32,"column":29}},{"start":{"line":29,"column":28},"end":{"line":32,"column":29}}],"line":29}},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":3,"7":3,"8":1,"9":2,"10":2,"11":2,"12":4,"13":5,"14":2,"15":0,"16":2,"17":1,"18":1,"19":1,"20":1,"21":1,"22":0,"23":0,"24":1,"25":1,"26":1,"27":2,"28":2,"29":2,"30":2},"f":{"0":3,"1":2,"2":2,"3":4,"4":2},"b":{"0":[2,1],"1":[1,2],"2":[2,0,1,2,1,2],"3":[0,2],"4":[1,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/confirm/confirm.route.js"],"names":["express","InvoiceModel","Transfer","DisputeController","ConfirmRouter","Router","param","getInvoiceId","route","post","req","res","invoiceId","params","status","body","accepted","emailCode","invoice","verifyCode","send","success","error","Error","findOneAndUpdate","_id","$set","new","data","err"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,QAAP,MAAqB,wBAArB;AACA,OAAOC,iBAAP,MAA8B,+BAA9B;;AAEA,IAAMC,gBAAgBJ,QAAQK,MAAR,EAAtB;;AAEAD,cAAcE,KAAd,CAAoB,WAApB,EAAiCH,kBAAkBI,YAAnD;AACAH,cAAcI,KAAd,CAAoB,aAApB,EACKC,IADL,CACU,UAACC,GAAD,EAAMC,GAAN,EAAc;AAChB,QAAMC,YAAYF,IAAIG,MAAJ,CAAWD,SAA7B;AACA,QAAME,SAASJ,IAAIK,IAAJ,CAASC,QAAT,GAAoB,UAApB,GAAiC,UAAhD;AACA,QAAMC,YAAYP,IAAIK,IAAJ,CAASE,SAA3B;;AAEA,QAAIP,IAAIQ,OAAJ,CAAYC,UAAZ,KAA2BF,SAA/B,EAA0C,OAAON,IAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,OAAO,IAAIC,KAAJ,CAAU,oBAAV,CAAzB,EAArB,CAAP;;AAE1CtB,iBAAauB,gBAAb,CAA8B,EAAEC,KAAKb,SAAP,EAA9B,EAAkD,EAAEc,MAAM,EAAEZ,cAAF,EAAR,EAAlD,EAAwE,EAACa,KAAK,IAAN,EAAxE;AAAA,4EAAqF,iBAAOL,KAAP,EAAcM,IAAd;AAAA;AAAA;AAAA;AAAA;AACjF,gCAAIN,KAAJ,EAAWX,IAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,YAAlB,EAArB;;AADsE,kCAG7ER,WAAW,UAHkE;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA,mCAKnEZ,UALmE;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAOzES,gCAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBQ,gBAAlB,EAArB;;AAPyE;;AAWjFlB,gCAAIG,MAAJ,CAAW,GAAX,EAAgBM,IAAhB,CAAqB,EAAEC,SAAS,IAAX,EAAiBO,UAAjB,EAArB;;AAXiF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAArF;;AAAA;AAAA;AAAA;AAAA;AAaH,CArBL;;AAwBA,eAAexB,aAAf","file":"confirm.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport InvoiceModel from '../invoice/invoice.model';\nimport Transfer from '../../modules/transfer';\nimport DisputeController from '../dispute/dispute.controller';\n\nconst ConfirmRouter = express.Router();\n\nConfirmRouter.param('invoiceId', DisputeController.getInvoiceId);\nConfirmRouter.route('/:invoiceId')\n    .post((req, res) => {\n        const invoiceId = req.params.invoiceId;\n        const status = req.body.accepted ? 'accepted' : 'rejected';\n        const emailCode = req.body.emailCode;\n\n        if (req.invoice.verifyCode !== emailCode) return res.status(400).send({ success: false, error: new Error('Wrong invoice code') });\n\n        InvoiceModel.findOneAndUpdate({ _id: invoiceId }, { $set: { status } }, {new: true}, async (error, data) => {\n            if (error) res.status(400).send({ success: false, error });\n            \n            if (status === \"accepted\") {\n                try {\n                    await Transfer();\n                } catch(err) {\n                    res.status(400).send({ success: false, err });\n                }\n            }\n\n            res.status(200).send({ success: true, data });\n        });\n    });\n\n\nexport default ConfirmRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"34c10a07c00c99c9a409f64ea6999747ea892963"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/banks/banks.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/banks/banks.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":8,"column":13},"end":{"line":8,"column":40}},"2":{"start":{"line":9,"column":13},"end":{"line":9,"column":29}},"3":{"start":{"line":11,"column":0},"end":{"line":35,"column":5}},"4":{"start":{"line":12,"column":15},"end":{"line":30,"column":7}},"5":{"start":{"line":13,"column":8},"end":{"line":29,"column":27}},"6":{"start":{"line":14,"column":12},"end":{"line":28,"column":13}},"7":{"start":{"line":15,"column":16},"end":{"line":27,"column":17}},"8":{"start":{"line":17,"column":24},"end":{"line":22,"column":27}},"9":{"start":{"line":18,"column":39},"end":{"line":18,"column":54}},"10":{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},"11":{"start":{"line":20,"column":37},"end":{"line":20,"column":88}},"12":{"start":{"line":21,"column":28},"end":{"line":21,"column":68}},"13":{"start":{"line":26,"column":24},"end":{"line":26,"column":47}},"14":{"start":{"line":32,"column":4},"end":{"line":34,"column":6}},"15":{"start":{"line":33,"column":8},"end":{"line":33,"column":43}},"16":{"start":{"line":37,"column":0},"end":{"line":65,"column":5}},"17":{"start":{"line":38,"column":16},"end":{"line":60,"column":7}},"18":{"start":{"line":41,"column":8},"end":{"line":59,"column":28}},"19":{"start":{"line":42,"column":12},"end":{"line":58,"column":13}},"20":{"start":{"line":43,"column":16},"end":{"line":57,"column":17}},"21":{"start":{"line":45,"column":24},"end":{"line":45,"column":129}},"22":{"start":{"line":47,"column":24},"end":{"line":52,"column":27}},"23":{"start":{"line":48,"column":39},"end":{"line":48,"column":54}},"24":{"start":{"line":50,"column":28},"end":{"line":50,"column":88}},"25":{"start":{"line":50,"column":37},"end":{"line":50,"column":88}},"26":{"start":{"line":51,"column":28},"end":{"line":51,"column":68}},"27":{"start":{"line":56,"column":24},"end":{"line":56,"column":48}},"28":{"start":{"line":62,"column":4},"end":{"line":64,"column":6}},"29":{"start":{"line":63,"column":8},"end":{"line":63,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":34},"end":{"line":35,"column":1}},"line":11},"1":{"name":"_callee","decl":{"start":{"line":12,"column":81},"end":{"line":12,"column":88}},"loc":{"start":{"line":12,"column":99},"end":{"line":30,"column":5}},"line":12},"2":{"name":"_callee$","decl":{"start":{"line":13,"column":49},"end":{"line":13,"column":57}},"loc":{"start":{"line":13,"column":68},"end":{"line":29,"column":9}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":153},"end":{"line":17,"column":154}},"loc":{"start":{"line":17,"column":175},"end":{"line":22,"column":25}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":32,"column":11},"end":{"line":32,"column":12}},"loc":{"start":{"line":32,"column":30},"end":{"line":34,"column":5}},"line":32},"5":{"name":"(anonymous_5)","decl":{"start":{"line":37,"column":55},"end":{"line":37,"column":56}},"loc":{"start":{"line":37,"column":67},"end":{"line":65,"column":1}},"line":37},"6":{"name":"_callee2","decl":{"start":{"line":38,"column":82},"end":{"line":38,"column":90}},"loc":{"start":{"line":38,"column":101},"end":{"line":60,"column":5}},"line":38},"7":{"name":"_callee2$","decl":{"start":{"line":41,"column":49},"end":{"line":41,"column":58}},"loc":{"start":{"line":41,"column":70},"end":{"line":59,"column":9}},"line":41},"8":{"name":"(anonymous_8)","decl":{"start":{"line":47,"column":222},"end":{"line":47,"column":223}},"loc":{"start":{"line":47,"column":244},"end":{"line":52,"column":25}},"line":47},"9":{"name":"(anonymous_9)","decl":{"start":{"line":62,"column":11},"end":{"line":62,"column":12}},"loc":{"start":{"line":62,"column":31},"end":{"line":64,"column":5}},"line":62}},"branchMap":{"0":{"loc":{"start":{"line":15,"column":16},"end":{"line":27,"column":17}},"type":"switch","locations":[{"start":{"line":16,"column":20},"end":{"line":22,"column":27}},{"start":{"line":24,"column":20},"end":{"line":24,"column":27}},{"start":{"line":25,"column":20},"end":{"line":26,"column":47}}],"line":15},"1":{"loc":{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},"type":"if","locations":[{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},{"start":{"line":20,"column":28},"end":{"line":20,"column":88}}],"line":20},"2":{"loc":{"start":{"line":43,"column":16},"end":{"line":57,"column":17}},"type":"switch","locations":[{"start":{"line":44,"column":20},"end":{"line":52,"column":27}},{"start":{"line":54,"column":20},"end":{"line":54,"column":27}},{"start":{"line":55,"column":20},"end":{"line":56,"column":48}}],"line":43},"3":{"loc":{"start":{"line":50,"column":28},"end":{"line":50,"column":88}},"type":"if","locations":[{"start":{"line":50,"column":28},"end":{"line":50,"column":88}},{"start":{"line":50,"column":28},"end":{"line":50,"column":88}}],"line":50}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":0,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":0,"26":1,"27":1,"28":1,"29":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1},"b":{"0":[1,1,1],"1":[0,1],"2":[1,1,1],"3":[0,1]},"inputSourceMap":{"version":3,"sources":["src/api/resources/banks/banks.route.js"],"names":["request","express","secret","process","env","PAYSTACK_SECRET","Router","route","get","req","res","set","end","err","data","body","status","send","success","params","bank_code","account_number"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;AACA,IAAMC,SAASL,QAAQK,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,GAAb,EACKC,GADL;AAAA,wEACS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AACDV,gCACKQ,GADL,iCAEKG,GAFL,CAES,cAFT,EAEyB,kBAFzB,EAGKA,GAHL,CAGS,eAHT,cAGoCT,MAHpC,EAIKU,GAJL,CAIS,UAACC,GAAD,SAA6B;AAAA,gCAAbC,IAAa,SAArBC,IAAqB,CAAbD,IAAa;;AAC9B,gCAAID,GAAJ,EAASH,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBL,QAAlB,EAArB;AACTH,gCAAIO,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAiBJ,UAAjB,EAAT;AACH,yBAPL;;AADC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAYAR,OAAOC,KAAP,CAAa,oCAAb,EACKC,GADL;AAAA,yEACS,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,sCACqCD,IAAIU,MADzC,EACOC,SADP,eACOA,SADP,EACkBC,cADlB,eACkBA,cADlB;;AAEDrB,gCACKQ,GADL,0DACgEa,cADhE,mBAC4FD,SAD5F,EAEKT,GAFL,CAES,cAFT,EAEyB,kBAFzB,EAGKA,GAHL,CAGS,eAHT,cAGoCT,MAHpC,EAIKU,GAJL,CAIS,UAACC,GAAD,SAA6B;AAAA,gCAAbC,IAAa,SAArBC,IAAqB,CAAbD,IAAa;;AAC9B,gCAAID,GAAJ,EAASH,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBL,QAAlB,EAArB;AACTH,gCAAIO,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAiBJ,UAAjB,EAAT;AACH,yBAPL;;AAFC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAcA,eAAeR,MAAf","file":"banks.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nimport express from 'express';\nconst secret = process.env.PAYSTACK_SECRET;\nconst Router = express.Router();\n\nRouter.route('/')\n    .get(async (req, res) => {\n        request\n            .get(`https://api.paystack.co/bank`)\n            .set('Content-Type', 'application/json')\n            .set('Authorization', `Bearer ${secret}`)\n            .end((err, { body: { data } }) => {\n                if (err) res.status(400).send({ success: false, err });\n                res.send({ success: true, data });\n            });\n    });\n\nRouter.route('/verify/:bank_code/:account_number')\n    .get(async (req, res) => {\n        const { bank_code, account_number } = req.params;\n        request\n            .get(`https://api.paystack.co/bank/resolve?account_number=${account_number}&bank_code=${bank_code}`)\n            .set('Content-Type', 'application/json')\n            .set('Authorization', `Bearer ${secret}`)\n            .end((err, { body: { data } }) => {\n                if (err) res.status(400).send({ success: false, err });\n                res.send({ success: true, data })\n            });\n    });\n\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"2bc86a4b093f4d3ebfd38100a44c7e4e7ca8b8a6"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/auth.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/auth.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":10,"column":11},"end":{"line":10,"column":34}},"2":{"start":{"line":11,"column":15},"end":{"line":11,"column":102}},"3":{"start":{"line":13,"column":16},"end":{"line":13,"column":20}},"4":{"start":{"line":15,"column":20},"end":{"line":55,"column":1}},"5":{"start":{"line":16,"column":4},"end":{"line":54,"column":9}},"6":{"start":{"line":17,"column":19},"end":{"line":49,"column":11}},"7":{"start":{"line":20,"column":12},"end":{"line":48,"column":41}},"8":{"start":{"line":21,"column":16},"end":{"line":47,"column":17}},"9":{"start":{"line":22,"column":20},"end":{"line":46,"column":21}},"10":{"start":{"line":24,"column":28},"end":{"line":24,"column":46}},"11":{"start":{"line":25,"column":28},"end":{"line":25,"column":46}},"12":{"start":{"line":26,"column":28},"end":{"line":26,"column":55}},"13":{"start":{"line":29,"column":28},"end":{"line":29,"column":50}},"14":{"start":{"line":30,"column":28},"end":{"line":30,"column":51}},"15":{"start":{"line":32,"column":28},"end":{"line":32,"column":45}},"16":{"start":{"line":33,"column":28},"end":{"line":33,"column":38}},"17":{"start":{"line":34,"column":28},"end":{"line":34,"column":47}},"18":{"start":{"line":35,"column":28},"end":{"line":35,"column":34}},"19":{"start":{"line":38,"column":28},"end":{"line":38,"column":46}},"20":{"start":{"line":39,"column":28},"end":{"line":39,"column":63}},"21":{"start":{"line":41,"column":28},"end":{"line":41,"column":48}},"22":{"start":{"line":45,"column":28},"end":{"line":45,"column":51}},"23":{"start":{"line":51,"column":8},"end":{"line":53,"column":10}},"24":{"start":{"line":52,"column":12},"end":{"line":52,"column":47}},"25":{"start":{"line":57,"column":25},"end":{"line":92,"column":1}},"26":{"start":{"line":58,"column":23},"end":{"line":58,"column":39}},"27":{"start":{"line":59,"column":24},"end":{"line":59,"column":49}},"28":{"start":{"line":61,"column":4},"end":{"line":91,"column":5}},"29":{"start":{"line":62,"column":20},"end":{"line":62,"column":53}},"30":{"start":{"line":63,"column":24},"end":{"line":63,"column":61}},"31":{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},"32":{"start":{"line":66,"column":36},"end":{"line":66,"column":52}},"33":{"start":{"line":67,"column":22},"end":{"line":67,"column":43}},"34":{"start":{"line":68,"column":22},"end":{"line":68,"column":43}},"35":{"start":{"line":69,"column":26},"end":{"line":69,"column":43}},"36":{"start":{"line":70,"column":22},"end":{"line":70,"column":33}},"37":{"start":{"line":71,"column":22},"end":{"line":71,"column":33}},"38":{"start":{"line":73,"column":36},"end":{"line":75,"column":14}},"39":{"start":{"line":74,"column":16},"end":{"line":74,"column":54}},"40":{"start":{"line":76,"column":37},"end":{"line":76,"column":73}},"41":{"start":{"line":77,"column":27},"end":{"line":77,"column":48}},"42":{"start":{"line":79,"column":29},"end":{"line":79,"column":58}},"43":{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},"44":{"start":{"line":82,"column":16},"end":{"line":82,"column":35}},"45":{"start":{"line":83,"column":16},"end":{"line":83,"column":23}},"46":{"start":{"line":84,"column":16},"end":{"line":84,"column":23}},"47":{"start":{"line":87,"column":11},"end":{"line":91,"column":5}},"48":{"start":{"line":88,"column":8},"end":{"line":88,"column":15}},"49":{"start":{"line":90,"column":8},"end":{"line":90,"column":78}}},"fnMap":{"0":{"name":"getJWT","decl":{"start":{"line":15,"column":29},"end":{"line":15,"column":35}},"loc":{"start":{"line":15,"column":38},"end":{"line":55,"column":1}},"line":15},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":24},"end":{"line":16,"column":25}},"loc":{"start":{"line":16,"column":36},"end":{"line":54,"column":5}},"line":16},"2":{"name":"_callee","decl":{"start":{"line":17,"column":85},"end":{"line":17,"column":92}},"loc":{"start":{"line":17,"column":110},"end":{"line":49,"column":9}},"line":17},"3":{"name":"_callee$","decl":{"start":{"line":20,"column":53},"end":{"line":20,"column":61}},"loc":{"start":{"line":20,"column":72},"end":{"line":48,"column":13}},"line":20},"4":{"name":"(anonymous_4)","decl":{"start":{"line":51,"column":15},"end":{"line":51,"column":16}},"loc":{"start":{"line":51,"column":34},"end":{"line":53,"column":9}},"line":51},"5":{"name":"verifyToken","decl":{"start":{"line":57,"column":34},"end":{"line":57,"column":45}},"loc":{"start":{"line":57,"column":62},"end":{"line":92,"column":1}},"line":57},"6":{"name":"(anonymous_6)","decl":{"start":{"line":73,"column":53},"end":{"line":73,"column":54}},"loc":{"start":{"line":73,"column":66},"end":{"line":75,"column":13}},"line":73}},"branchMap":{"0":{"loc":{"start":{"line":22,"column":20},"end":{"line":46,"column":21}},"type":"switch","locations":[{"start":{"line":23,"column":24},"end":{"line":26,"column":55}},{"start":{"line":28,"column":24},"end":{"line":35,"column":34}},{"start":{"line":37,"column":24},"end":{"line":41,"column":48}},{"start":{"line":43,"column":24},"end":{"line":43,"column":32}},{"start":{"line":44,"column":24},"end":{"line":45,"column":51}}],"line":22},"1":{"loc":{"start":{"line":61,"column":4},"end":{"line":91,"column":5}},"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":91,"column":5}},{"start":{"line":61,"column":4},"end":{"line":91,"column":5}}],"line":61},"2":{"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":60}},"type":"binary-expr","locations":[{"start":{"line":61,"column":8},"end":{"line":61,"column":21}},{"start":{"line":61,"column":25},"end":{"line":61,"column":60}}],"line":61},"3":{"loc":{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},{"start":{"line":65,"column":8},"end":{"line":86,"column":9}}],"line":65},"4":{"loc":{"start":{"line":74,"column":23},"end":{"line":74,"column":53}},"type":"binary-expr","locations":[{"start":{"line":74,"column":23},"end":{"line":74,"column":36}},{"start":{"line":74,"column":40},"end":{"line":74,"column":53}}],"line":74},"5":{"loc":{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},"type":"if","locations":[{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},{"start":{"line":81,"column":12},"end":{"line":85,"column":13}}],"line":81},"6":{"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":74}},"type":"binary-expr","locations":[{"start":{"line":81,"column":16},"end":{"line":81,"column":38}},{"start":{"line":81,"column":42},"end":{"line":81,"column":54}},{"start":{"line":81,"column":58},"end":{"line":81,"column":74}}],"line":81},"7":{"loc":{"start":{"line":87,"column":11},"end":{"line":91,"column":5}},"type":"if","locations":[{"start":{"line":87,"column":11},"end":{"line":91,"column":5}},{"start":{"line":87,"column":11},"end":{"line":91,"column":5}}],"line":87},"8":{"loc":{"start":{"line":87,"column":15},"end":{"line":87,"column":626}},"type":"binary-expr","locations":[{"start":{"line":87,"column":15},"end":{"line":87,"column":61}},{"start":{"line":87,"column":65},"end":{"line":87,"column":99}},{"start":{"line":87,"column":103},"end":{"line":87,"column":149}},{"start":{"line":87,"column":153},"end":{"line":87,"column":188}},{"start":{"line":87,"column":192},"end":{"line":87,"column":238}},{"start":{"line":87,"column":242},"end":{"line":87,"column":276}},{"start":{"line":87,"column":280},"end":{"line":87,"column":324}},{"start":{"line":87,"column":328},"end":{"line":87,"column":362}},{"start":{"line":87,"column":366},"end":{"line":87,"column":412}},{"start":{"line":87,"column":416},"end":{"line":87,"column":451}},{"start":{"line":87,"column":455},"end":{"line":87,"column":501}},{"start":{"line":87,"column":505},"end":{"line":87,"column":539}},{"start":{"line":87,"column":543},"end":{"line":87,"column":588}},{"start":{"line":87,"column":592},"end":{"line":87,"column":626}}],"line":87}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":3,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":0,"20":0,"21":0,"22":1,"23":1,"24":1,"25":1,"26":5,"27":5,"28":5,"29":2,"30":2,"31":2,"32":2,"33":2,"34":2,"35":2,"36":2,"37":2,"38":2,"39":4,"40":2,"41":2,"42":2,"43":2,"44":2,"45":2,"46":2,"47":3,"48":3,"49":0},"f":{"0":1,"1":1,"2":1,"3":2,"4":1,"5":5,"6":4},"b":{"0":[1,1,0,1,1],"1":[2,3],"2":[5,2],"3":[2,0],"4":[4,2],"5":[2,0],"6":[2,2,2],"7":[3,0],"8":[3,1,2,2,1,1,0,0,0,0,0,0,0,0]},"inputSourceMap":{"version":3,"sources":["src/api/modules/auth.js"],"names":["axios","jwt","aaud","process","env","COGNITO_AUD","tokenUrl","tokenKeys","getJWT","resolve","reject","get","keys","data","verifyToken","req","res","next","bearerLength","length","authorization","headers","token","slice","tokenData","decode","complete","header","kid","alg","payload","aud","exp","filter","k","matchKey","current_ts","Math","floor","Date","undefined","user","originalUrl","match","method","toLowerCase","status","send","success","error"],"mappings":"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","file":"auth.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import axios from 'axios';\nimport jwt from 'jsonwebtoken';\nconst aaud = process.env.COGNITO_AUD;\nconst tokenUrl = `https://cognito-idp.us-east-2.amazonaws.com/us-east-2_ZAwetvcgl/.well-known/jwks.json`;\n\nlet tokenKeys = null;\n\nexport const getJWT = () => new Promise(async (resolve, reject) => {\n    try {\n        const { data: { keys } } = await axios.get(tokenUrl);\n        tokenKeys  = keys;\n        resolve();\n    } catch (err) {\n        reject(err);\n    }\n});\n\nexport const verifyToken = (req, res, next) => {\n    const bearerLength = \"Bearer \".length;\n    const authorization = req.headers.authorization;\n\n    if (authorization && authorization.length > bearerLength) {\n        const token = authorization.slice(bearerLength);\n        const tokenData = jwt.decode(token, { complete: true });\n\n        if (!!tokenData) {\n            const { header: { kid, alg }, payload } = tokenData;\n            const { aud, exp } = payload;\n            const [ matchKey ] = tokenKeys.filter((k) => (k.kid === kid && k.alg === alg));\n            const current_ts = Math.floor(new Date() / 1000);\n    \n            if (matchKey !== undefined && aaud === aud && current_ts < exp) {\n                req.user = payload;\n                next();\n                return;\n            }\n        }\n    } else if (\n        req.originalUrl.match('/api/invoice') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/payment') !== null && req.method.toLowerCase() === 'post' ||\n        req.originalUrl.match('/api/payment') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/banks') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/dispute') !== null && req.method.toLowerCase() === 'post' ||\n        req.originalUrl.match('/api/dispute') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/verify') !== null && req.method.toLowerCase() === 'get'\n    ) {\n        next(); \n    } else {\n        res.status(403).send({ success: false, error: 'Invalid auth token' });\n    }\n};"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"fce3832adc31411c4c500f19b1afdfd53c8927fc"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/index.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/index.js","statementMap":{"0":{"start":{"line":11,"column":17},"end":{"line":11,"column":33}},"1":{"start":{"line":13,"column":0},"end":{"line":13,"column":39}},"2":{"start":{"line":14,"column":0},"end":{"line":14,"column":37}},"3":{"start":{"line":15,"column":0},"end":{"line":15,"column":41}},"4":{"start":{"line":16,"column":0},"end":{"line":16,"column":41}},"5":{"start":{"line":17,"column":0},"end":{"line":17,"column":53}},"6":{"start":{"line":18,"column":0},"end":{"line":18,"column":54}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/index.js"],"names":["express","VerifyRoute","InvoceRoute","PaymentRoute","DisputeRoute","ConfirmRoute","BanksRoute","verifyToken","MainRouter","Router","use"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;;AAEA,SAASC,WAAT,QAA4B,iBAA5B;;AAEA,IAAMC,aAAaR,QAAQS,MAAR,EAAnB;;AAEAD,WAAWE,GAAX,CAAe,SAAf,EAA0BT,WAA1B;AACAO,WAAWE,GAAX,CAAe,QAAf,EAAyBJ,UAAzB;AACAE,WAAWE,GAAX,CAAe,UAAf,EAA2BL,YAA3B;AACAG,WAAWE,GAAX,CAAe,UAAf,EAA2BN,YAA3B;AACAI,WAAWE,GAAX,CAAe,UAAf,EAA2BH,WAA3B,EAAwCL,WAAxC;AACAM,WAAWE,GAAX,CAAe,UAAf,EAA2BH,WAA3B,EAAwCJ,YAAxC;;AAEA,eAAeK,UAAf","file":"index.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport VerifyRoute from './verify/verify.route';\nimport InvoceRoute from './invoice/invoice.route';\nimport PaymentRoute from './payment/payment.route';\nimport DisputeRoute from './dispute/dispute.route';\nimport ConfirmRoute from './confirm/confirm.route';\nimport BanksRoute from './banks/banks.route';\n\nimport { verifyToken } from '../modules/auth';\n\nconst MainRouter = express.Router();\n\nMainRouter.use('/verify', VerifyRoute);\nMainRouter.use('/banks', BanksRoute);\nMainRouter.use('/confirm', ConfirmRoute);\nMainRouter.use('/dispute', DisputeRoute);\nMainRouter.use('/invoice', verifyToken, InvoceRoute);\nMainRouter.use('/payment', verifyToken, PaymentRoute);\n\nexport default MainRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"3a0d4da55ecc03c2ab222722d7a83c8d9718dbb3"},"/Users/Sleekvick/Projects/pipepay/server/src/config/index.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/config/index.js","statementMap":{"0":{"start":{"line":2,"column":10},"end":{"line":2,"column":30}},"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":24}},"2":{"start":{"line":6,"column":17},"end":{"line":11,"column":1}},"3":{"start":{"line":13,"column":16},"end":{"line":13,"column":18}},"4":{"start":{"line":15,"column":0},"end":{"line":25,"column":1}},"5":{"start":{"line":18,"column":8},"end":{"line":18,"column":44}},"6":{"start":{"line":19,"column":8},"end":{"line":19,"column":14}},"7":{"start":{"line":22,"column":8},"end":{"line":22,"column":45}},"8":{"start":{"line":24,"column":8},"end":{"line":24,"column":44}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":15,"column":0},"end":{"line":25,"column":1}},"type":"switch","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":23}},{"start":{"line":17,"column":4},"end":{"line":19,"column":14}},{"start":{"line":20,"column":4},"end":{"line":20,"column":16}},{"start":{"line":21,"column":4},"end":{"line":22,"column":45}},{"start":{"line":23,"column":4},"end":{"line":24,"column":44}}],"line":15}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1},"f":{},"b":{"0":[0,0,0,0,1]},"inputSourceMap":{"version":3,"sources":["src/config/index.js"],"names":["merge","env","process","NODE_ENV","console","log","baseConfig","port","db","url","envConfig","require","config"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,cAAlB;AACA,IAAMC,MAAMC,QAAQD,GAAR,CAAYE,QAAxB;;AAEAC,QAAQC,GAAR,CAAY,KAAZ,EAAmBJ,GAAnB;;AAEA,IAAMK,aAAa;AACfC,UAAM,IADS;AAEfC,QAAI;AACAC,aAAK;AADL;AAFW,CAAnB;;AAOA,IAAIC,YAAY,EAAhB;;AAEA,QAAQT,GAAR;AACI,SAAK,aAAL;AACA,SAAK,KAAL;AACIS,oBAAYC,QAAQ,OAAR,EAAiBC,MAA7B;AACA;AACJ,SAAK,MAAL;AACA,SAAK,YAAL;AACIF,oBAAYC,QAAQ,QAAR,EAAkBC,MAA9B;AACJ;AACIF,oBAAYC,QAAQ,OAAR,EAAiBC,MAA7B;AATR;;AAYA,eAAeZ,MAAMM,UAAN,EAAkBI,SAAlB,CAAf","file":"index.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import merge from 'lodash.merge';\nconst env = process.env.NODE_ENV\n\nconsole.log('env', env);\n\nconst baseConfig = {\n    port: 3000,\n    db: {\n        url: ''\n    }\n}\n\nlet envConfig = {}\n\nswitch (env) {\n    case 'development':\n    case 'dev':\n        envConfig = require('./dev').config\n        break;\n    case 'prod':\n    case 'production':\n        envConfig = require('./prod').config\n    default:\n        envConfig = require('./dev').config \n}\n\nexport default merge(baseConfig, envConfig)"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"12b98bce8cc8749db5861f0b1c175fec28356b2a"},"/Users/Sleekvick/Projects/pipepay/server/src/config/dev.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/config/dev.js","statementMap":{"0":{"start":{"line":1,"column":15},"end":{"line":1,"column":34}},"1":{"start":{"line":2,"column":15},"end":{"line":2,"column":38}},"2":{"start":{"line":4,"column":20},"end":{"line":8,"column":1}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/config/dev.js"],"names":["username","process","env","DB_USER","password","DB_PASSWORD","config","db","url"],"mappings":"AAAA,IAAMA,WAAWC,QAAQC,GAAR,CAAYC,OAA7B;AACA,IAAMC,WAAWH,QAAQC,GAAR,CAAYG,WAA7B;;AAEA,OAAO,IAAMC,SAAS;AAClBC,QAAI;AACAC;AADA;AADc,CAAf","file":"dev.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["const username = process.env.DB_USER;\nconst password = process.env.DB_PASSWORD;\n\nexport const config = {\n    db: {\n        url: `mongodb://localhost:27017/pipepay`\n    }\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"7fd446ce6880388639c06c2698ea81f288331135"},"/Users/Sleekvick/Projects/pipepay/server/src/db.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/db.js","statementMap":{"0":{"start":{"line":4,"column":0},"end":{"line":4,"column":34}},"1":{"start":{"line":6,"column":21},"end":{"line":10,"column":1}},"2":{"start":{"line":7,"column":17},"end":{"line":7,"column":94}},"3":{"start":{"line":9,"column":4},"end":{"line":9,"column":70}}},"fnMap":{"0":{"name":"connect","decl":{"start":{"line":6,"column":30},"end":{"line":6,"column":37}},"loc":{"start":{"line":6,"column":40},"end":{"line":10,"column":1}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":94}},"type":"cond-expr","locations":[{"start":{"line":7,"column":70},"end":{"line":7,"column":82}},{"start":{"line":7,"column":85},"end":{"line":7,"column":94}}],"line":7},"1":{"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":67}},"type":"binary-expr","locations":[{"start":{"line":7,"column":17},"end":{"line":7,"column":37}},{"start":{"line":7,"column":41},"end":{"line":7,"column":67}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{"0":[0,1],"1":[1,0]},"inputSourceMap":{"version":3,"sources":["src/db.js"],"names":["mongoose","appConfig","Promise","global","connect","config","db","url","useNewUrlParser"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;AACA,OAAOC,SAAP,MAAsB,UAAtB;;AAEAD,SAASE,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,OAAO,IAAME,UAAU,SAAVA,OAAU,GAAwB;AAAA,QAAvBC,MAAuB,uEAAdJ,SAAc;;AAC3C,WAAOD,SAASI,OAAT,CAAiBC,OAAOC,EAAP,CAAUC,GAA3B,EAAgC,EAAEC,iBAAiB,IAAnB,EAAhC,CAAP;AACH,CAFM","file":"db.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose'\nimport appConfig from './config'\n\nmongoose.Promise = global.Promise\n\nexport const connect = (config = appConfig) => {\n    return mongoose.connect(config.db.url, { useNewUrlParser: true });\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"16ad6e924b87568ea46f15e9dda6e9bad4f67d09"},"/Users/Sleekvick/Projects/pipepay/server/src/server.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/server.js","statementMap":{"0":{"start":{"line":7,"column":10},"end":{"line":7,"column":19}},"1":{"start":{"line":8,"column":0},"end":{"line":8,"column":9}},"2":{"start":{"line":9,"column":0},"end":{"line":9,"column":21}},"3":{"start":{"line":10,"column":0},"end":{"line":12,"column":3}},"4":{"start":{"line":11,"column":4},"end":{"line":11,"column":35}},"5":{"start":{"line":14,"column":0},"end":{"line":14,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":10,"column":16},"end":{"line":10,"column":17}},"loc":{"start":{"line":10,"column":31},"end":{"line":12,"column":1}},"line":10}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":1},"f":{"0":0},"b":{},"inputSourceMap":{"version":3,"sources":["src/server.js"],"names":["express","setupMiddleware","MainRouter","connect","getJWT","app","catch","err","console","error","use"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,eAAP,MAA4B,cAA5B;AACA,OAAOC,UAAP,MAAuB,iBAAvB;AACA,SAASC,OAAT,QAAwB,MAAxB;AACA,SAASC,MAAT,QAAuB,oBAAvB;;AAEA,IAAMC,MAAML,SAAZ;AACAI;AACAH,gBAAgBI,GAAhB;AACAF,UAAUG,KAAV,CAAgB,UAACC,GAAD,EAAS;AACrBC,YAAQC,KAAR,CAAc,UAAd,EAA0BF,GAA1B;AACH,CAFD;;AAIAF,IAAIK,GAAJ,CAAQ,MAAR,EAAgBR,UAAhB;;AAEA,eAAeG,GAAf","file":"server.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport setupMiddleware from './middleware';\nimport MainRouter from './api/resources';\nimport { connect } from './db';\nimport { getJWT } from './api/modules/auth';\n\nconst app = express();\ngetJWT();\nsetupMiddleware(app);\nconnect().catch((err) => {\n    console.error('DB error', err);\n});\n\napp.use('/api', MainRouter);\n\nexport default app;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"0e0c032ba8a81bdaae253d098199ed82ce8a9de0"},"/Users/Sleekvick/Projects/pipepay/server/src/test-helpers/auth.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/test-helpers/auth.js","statementMap":{"0":{"start":{"line":10,"column":11},"end":{"line":10,"column":34}},"1":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}},"2":{"start":{"line":14,"column":25},"end":{"line":28,"column":1}},"3":{"start":{"line":15,"column":14},"end":{"line":15,"column":39}},"4":{"start":{"line":16,"column":2},"end":{"line":27,"column":5}},"5":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"6":{"start":{"line":18,"column":6},"end":{"line":18,"column":23}},"7":{"start":{"line":20,"column":4},"end":{"line":26,"column":7}},"8":{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},"9":{"start":{"line":22,"column":8},"end":{"line":22,"column":20}},"10":{"start":{"line":24,"column":8},"end":{"line":24,"column":18}},"11":{"start":{"line":30,"column":20},"end":{"line":34,"column":1}},"12":{"start":{"line":31,"column":2},"end":{"line":33,"column":5}},"13":{"start":{"line":32,"column":4},"end":{"line":32,"column":64}},"14":{"start":{"line":36,"column":22},"end":{"line":39,"column":2}},"15":{"start":{"line":41,"column":20},"end":{"line":61,"column":1}},"16":{"start":{"line":42,"column":2},"end":{"line":60,"column":5}},"17":{"start":{"line":43,"column":29},"end":{"line":46,"column":5}},"18":{"start":{"line":48,"column":19},"end":{"line":51,"column":5}},"19":{"start":{"line":53,"column":22},"end":{"line":53,"column":47}},"20":{"start":{"line":54,"column":32},"end":{"line":54,"column":77}},"21":{"start":{"line":56,"column":4},"end":{"line":59,"column":7}}},"fnMap":{"0":{"name":"removeModel","decl":{"start":{"line":14,"column":34},"end":{"line":14,"column":45}},"loc":{"start":{"line":14,"column":57},"end":{"line":28,"column":1}},"line":14},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":22},"end":{"line":16,"column":23}},"loc":{"start":{"line":16,"column":49},"end":{"line":27,"column":3}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":17},"end":{"line":20,"column":18}},"loc":{"start":{"line":20,"column":32},"end":{"line":26,"column":5}},"line":20},"3":{"name":"dropDb","decl":{"start":{"line":30,"column":29},"end":{"line":30,"column":35}},"loc":{"start":{"line":30,"column":38},"end":{"line":34,"column":1}},"line":30},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":73},"end":{"line":31,"column":74}},"loc":{"start":{"line":31,"column":85},"end":{"line":33,"column":3}},"line":31},"5":{"name":"signin","decl":{"start":{"line":41,"column":29},"end":{"line":41,"column":35}},"loc":{"start":{"line":41,"column":56},"end":{"line":61,"column":1}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":42,"column":22},"end":{"line":42,"column":23}},"loc":{"start":{"line":42,"column":49},"end":{"line":60,"column":3}},"line":42}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},{"start":{"line":17,"column":4},"end":{"line":19,"column":5}}],"line":17},"1":{"loc":{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},"type":"if","locations":[{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},{"start":{"line":21,"column":6},"end":{"line":25,"column":7}}],"line":21}},"s":{"0":1,"1":1,"2":1,"3":3,"4":3,"5":3,"6":0,"7":3,"8":3,"9":0,"10":3,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1},"f":{"0":3,"1":3,"2":3,"3":1,"4":1,"5":1,"6":1},"b":{"0":[0,3],"1":[0,3]},"inputSourceMap":{"version":3,"sources":["src/test-helpers/auth.js"],"names":["AuthenticationDetails","CognitoUserPool","CognitoUser","mongoose","config","aaud","process","env","COGNITO_AUD","Promise","global","removeModel","modelName","model","resolve","reject","remove","err","dropDb","connect","db","url","useNewUrlParser","then","all","modelNames","map","userPool","UserPoolId","ClientId","signin","Username","Password","authenticationData","userData","Pool","cognitoUser","authenticationDetails","authenticateUser","onSuccess","onFailure"],"mappings":";AAAA,OAAO,wCAAP;AACA,OAAO,wCAAP;AACA,OAAO,wCAAP;;AAEA,SAASA,qBAAT,EAAgCC,eAAhC,EAAiDC,WAAjD,QAAoE,4BAApE;;AAEA,OAAOC,QAAP,MAAqB,UAArB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,IAAMC,OAAOC,QAAQC,GAAR,CAAYC,WAAzB;;AAEAL,SAASM,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,OAAO,IAAME,cAAc,SAAdA,WAAc,CAACC,SAAD,EAAe;AACxC,MAAMC,QAAQV,SAASU,KAAT,CAAeD,SAAf,CAAd;AACA,SAAO,aAAY,UAACE,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAI,CAACF,KAAL,EAAY;AACV,aAAOC,SAAP;AACD;AACDD,UAAMG,MAAN,CAAa,UAACC,GAAD,EAAS;AACpB,UAAIA,GAAJ,EAAS;AACPF,eAAOE,GAAP;AACD,OAFD,MAEO;AACLH;AACD;AACF,KAND;AAOD,GAXM,CAAP;AAYD,CAdM;;AAgBP,OAAO,IAAMI,SAAS,SAATA,MAAS,GAAM;AAC1B,SAAOf,SAASgB,OAAT,CAAiBf,OAAOgB,EAAP,CAAUC,GAA3B,EAAgC,EAAEC,iBAAiB,IAAnB,EAAhC,EAA2DC,IAA3D,CAAgE;AAAA,WAAM,SAAQC,GAAR,CAAYrB,SAASsB,UAAT,GAAsBC,GAAtB,CAA0Bf,WAA1B,CAAZ,CAAN;AAAA,GAAhE,CAAP;AACD,CAFM;;AAIP,OAAO,IAAMgB,WAAW,IAAI1B,eAAJ,CAAoB;AAC1C2B,cAAY,qBAD8B;AAE1CC,YAAUxB;AAFgC,CAApB,CAAjB;;AAKP,OAAO,IAAMyB,SAAS,SAATA,MAAS,CAACC,QAAD,EAAWC,QAAX;AAAA,SAAwB,aAAY,UAAClB,OAAD,EAAUC,MAAV,EAAqB;AAC7E,QAAIkB,qBAAqB;AACvBF,wBADuB;AAEvBC;AAFuB,KAAzB;;AAKA,QAAIE,WAAW;AACbH,wBADa;AAEbI,YAAMR;AAFO,KAAf;;AAKA,QAAMS,cAAc,IAAIlC,WAAJ,CAAgBgC,QAAhB,CAApB;AACA,QAAIG,wBAAwB,IAAIrC,qBAAJ,CAA0BiC,kBAA1B,CAA5B;;AAEAG,gBAAYE,gBAAZ,CAA6BD,qBAA7B,EAAoD;AAClDE,iBAAWzB,OADuC;AAElD0B,iBAAWzB;AAFuC,KAApD;AAID,GAlB6C,CAAxB;AAAA,CAAf","file":"auth.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import '../api/resources/dispute/dispute.model'\nimport '../api/resources/invoice/invoice.model'\nimport '../api/resources/payment/payment.model'\n\nimport { AuthenticationDetails, CognitoUserPool, CognitoUser } from 'amazon-cognito-identity-js';\n\nimport mongoose from 'mongoose'\nimport config from '../config'\nconst aaud = process.env.COGNITO_AUD;\n\nmongoose.Promise = global.Promise\n\nexport const removeModel = (modelName) => {\n  const model = mongoose.model(modelName)\n  return new Promise((resolve, reject) => {\n    if (!model) {\n      return resolve()\n    }\n    model.remove((err) => {\n      if (err) {\n        reject(err)\n      } else {\n        resolve()\n      }\n    })\n  })\n}\n\nexport const dropDb = () => {\n  return mongoose.connect(config.db.url, { useNewUrlParser: true }).then(() => Promise.all(mongoose.modelNames().map(removeModel)))\n}\n\nexport const userPool = new CognitoUserPool({\n  UserPoolId: 'us-east-2_ZAwetvcgl',\n  ClientId: aaud\n});\n\nexport const signin = (Username, Password) => new Promise((resolve, reject) => {\n  let authenticationData = {\n    Username,\n    Password\n  };\n\n  let userData = {\n    Username,\n    Pool: userPool   \n  }\n\n  const cognitoUser = new CognitoUser(userData);\n  let authenticationDetails = new AuthenticationDetails(authenticationData);\n\n  cognitoUser.authenticateUser(authenticationDetails, {\n    onSuccess: resolve,\n    onFailure: reject\n  });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"0fd5e5af5555499341b1949e56d82fa8a4594af5"},"/Users/Sleekvick/Projects/pipepay/server/src/server.spec.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/server.spec.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":15,"column":15},"end":{"line":15,"column":40}},"2":{"start":{"line":16,"column":15},"end":{"line":16,"column":40}},"3":{"start":{"line":17,"column":13},"end":{"line":17,"column":40}},"4":{"start":{"line":18,"column":11},"end":{"line":18,"column":33}},"5":{"start":{"line":19,"column":13},"end":{"line":19,"column":24}},"6":{"start":{"line":21,"column":0},"end":{"line":21,"column":19}},"7":{"start":{"line":22,"column":0},"end":{"line":22,"column":46}},"8":{"start":{"line":24,"column":0},"end":{"line":24,"column":9}},"9":{"start":{"line":26,"column":0},"end":{"line":219,"column":3}},"10":{"start":{"line":28,"column":16},"end":{"line":28,"column":22}},"11":{"start":{"line":29,"column":15},"end":{"line":29,"column":21}},"12":{"start":{"line":30,"column":22},"end":{"line":30,"column":34}},"13":{"start":{"line":31,"column":20},"end":{"line":31,"column":30}},"14":{"start":{"line":32,"column":20},"end":{"line":32,"column":24}},"15":{"start":{"line":33,"column":25},"end":{"line":33,"column":29}},"16":{"start":{"line":35,"column":4},"end":{"line":72,"column":9}},"17":{"start":{"line":37,"column":8},"end":{"line":71,"column":37}},"18":{"start":{"line":38,"column":12},"end":{"line":70,"column":13}},"19":{"start":{"line":39,"column":16},"end":{"line":69,"column":17}},"20":{"start":{"line":41,"column":24},"end":{"line":41,"column":42}},"21":{"start":{"line":42,"column":24},"end":{"line":42,"column":42}},"22":{"start":{"line":43,"column":24},"end":{"line":43,"column":58}},"23":{"start":{"line":46,"column":24},"end":{"line":46,"column":64}},"24":{"start":{"line":48,"column":24},"end":{"line":57,"column":27}},"25":{"start":{"line":49,"column":28},"end":{"line":49,"column":56}},"26":{"start":{"line":49,"column":37},"end":{"line":49,"column":56}},"27":{"start":{"line":51,"column":28},"end":{"line":54,"column":29}},"28":{"start":{"line":52,"column":32},"end":{"line":52,"column":74}},"29":{"start":{"line":53,"column":32},"end":{"line":53,"column":67}},"30":{"start":{"line":56,"column":28},"end":{"line":56,"column":65}},"31":{"start":{"line":58,"column":24},"end":{"line":58,"column":43}},"32":{"start":{"line":59,"column":24},"end":{"line":59,"column":30}},"33":{"start":{"line":62,"column":24},"end":{"line":62,"column":42}},"34":{"start":{"line":63,"column":24},"end":{"line":63,"column":59}},"35":{"start":{"line":64,"column":24},"end":{"line":64,"column":42}},"36":{"start":{"line":68,"column":24},"end":{"line":68,"column":47}},"37":{"start":{"line":74,"column":4},"end":{"line":89,"column":7}},"38":{"start":{"line":75,"column":8},"end":{"line":88,"column":11}},"39":{"start":{"line":84,"column":12},"end":{"line":84,"column":42}},"40":{"start":{"line":85,"column":12},"end":{"line":85,"column":61}},"41":{"start":{"line":86,"column":12},"end":{"line":86,"column":55}},"42":{"start":{"line":87,"column":12},"end":{"line":87,"column":19}},"43":{"start":{"line":91,"column":4},"end":{"line":97,"column":7}},"44":{"start":{"line":92,"column":8},"end":{"line":96,"column":11}},"45":{"start":{"line":93,"column":12},"end":{"line":93,"column":61}},"46":{"start":{"line":94,"column":12},"end":{"line":94,"column":55}},"47":{"start":{"line":95,"column":12},"end":{"line":95,"column":19}},"48":{"start":{"line":99,"column":4},"end":{"line":125,"column":7}},"49":{"start":{"line":100,"column":22},"end":{"line":115,"column":9}},"50":{"start":{"line":117,"column":19},"end":{"line":117,"column":101}},"51":{"start":{"line":119,"column":8},"end":{"line":124,"column":11}},"52":{"start":{"line":122,"column":12},"end":{"line":122,"column":48}},"53":{"start":{"line":123,"column":12},"end":{"line":123,"column":19}},"54":{"start":{"line":127,"column":4},"end":{"line":133,"column":7}},"55":{"start":{"line":128,"column":8},"end":{"line":132,"column":11}},"56":{"start":{"line":129,"column":12},"end":{"line":129,"column":67}},"57":{"start":{"line":130,"column":12},"end":{"line":130,"column":55}},"58":{"start":{"line":131,"column":12},"end":{"line":131,"column":19}},"59":{"start":{"line":135,"column":4},"end":{"line":140,"column":7}},"60":{"start":{"line":136,"column":8},"end":{"line":139,"column":11}},"61":{"start":{"line":137,"column":12},"end":{"line":137,"column":55}},"62":{"start":{"line":138,"column":12},"end":{"line":138,"column":19}},"63":{"start":{"line":142,"column":4},"end":{"line":149,"column":7}},"64":{"start":{"line":143,"column":8},"end":{"line":148,"column":11}},"65":{"start":{"line":146,"column":12},"end":{"line":146,"column":56}},"66":{"start":{"line":147,"column":12},"end":{"line":147,"column":19}},"67":{"start":{"line":151,"column":4},"end":{"line":160,"column":7}},"68":{"start":{"line":152,"column":8},"end":{"line":159,"column":11}},"69":{"start":{"line":156,"column":12},"end":{"line":156,"column":65}},"70":{"start":{"line":157,"column":12},"end":{"line":157,"column":55}},"71":{"start":{"line":158,"column":12},"end":{"line":158,"column":19}},"72":{"start":{"line":162,"column":4},"end":{"line":171,"column":7}},"73":{"start":{"line":163,"column":8},"end":{"line":170,"column":11}},"74":{"start":{"line":167,"column":12},"end":{"line":167,"column":65}},"75":{"start":{"line":168,"column":12},"end":{"line":168,"column":55}},"76":{"start":{"line":169,"column":12},"end":{"line":169,"column":19}},"77":{"start":{"line":173,"column":4},"end":{"line":180,"column":7}},"78":{"start":{"line":174,"column":8},"end":{"line":179,"column":11}},"79":{"start":{"line":175,"column":12},"end":{"line":175,"column":51}},"80":{"start":{"line":176,"column":12},"end":{"line":176,"column":62}},"81":{"start":{"line":177,"column":12},"end":{"line":177,"column":55}},"82":{"start":{"line":178,"column":12},"end":{"line":178,"column":19}},"83":{"start":{"line":182,"column":4},"end":{"line":188,"column":7}},"84":{"start":{"line":183,"column":8},"end":{"line":187,"column":11}},"85":{"start":{"line":184,"column":12},"end":{"line":184,"column":69}},"86":{"start":{"line":185,"column":12},"end":{"line":185,"column":55}},"87":{"start":{"line":186,"column":12},"end":{"line":186,"column":19}},"88":{"start":{"line":190,"column":4},"end":{"line":201,"column":7}},"89":{"start":{"line":191,"column":8},"end":{"line":200,"column":11}},"90":{"start":{"line":197,"column":12},"end":{"line":197,"column":60}},"91":{"start":{"line":198,"column":12},"end":{"line":198,"column":55}},"92":{"start":{"line":199,"column":12},"end":{"line":199,"column":19}},"93":{"start":{"line":203,"column":4},"end":{"line":209,"column":7}},"94":{"start":{"line":204,"column":8},"end":{"line":208,"column":11}},"95":{"start":{"line":205,"column":12},"end":{"line":205,"column":58}},"96":{"start":{"line":206,"column":12},"end":{"line":206,"column":55}},"97":{"start":{"line":207,"column":12},"end":{"line":207,"column":19}},"98":{"start":{"line":211,"column":4},"end":{"line":218,"column":7}},"99":{"start":{"line":212,"column":8},"end":{"line":217,"column":11}},"100":{"start":{"line":215,"column":12},"end":{"line":215,"column":55}},"101":{"start":{"line":216,"column":12},"end":{"line":216,"column":19}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":26,"column":30},"end":{"line":26,"column":31}},"loc":{"start":{"line":26,"column":42},"end":{"line":219,"column":1}},"line":26},"1":{"name":"_callee","decl":{"start":{"line":35,"column":82},"end":{"line":35,"column":89}},"loc":{"start":{"line":35,"column":92},"end":{"line":72,"column":5}},"line":35},"2":{"name":"_callee$","decl":{"start":{"line":37,"column":49},"end":{"line":37,"column":57}},"loc":{"start":{"line":37,"column":68},"end":{"line":71,"column":9}},"line":37},"3":{"name":"(anonymous_3)","decl":{"start":{"line":48,"column":47},"end":{"line":48,"column":48}},"loc":{"start":{"line":48,"column":70},"end":{"line":57,"column":25}},"line":48},"4":{"name":"(anonymous_4)","decl":{"start":{"line":74,"column":25},"end":{"line":74,"column":26}},"loc":{"start":{"line":74,"column":41},"end":{"line":89,"column":5}},"line":74},"5":{"name":"(anonymous_5)","decl":{"start":{"line":83,"column":15},"end":{"line":83,"column":16}},"loc":{"start":{"line":83,"column":35},"end":{"line":88,"column":9}},"line":83},"6":{"name":"(anonymous_6)","decl":{"start":{"line":91,"column":26},"end":{"line":91,"column":27}},"loc":{"start":{"line":91,"column":42},"end":{"line":97,"column":5}},"line":91},"7":{"name":"(anonymous_7)","decl":{"start":{"line":92,"column":63},"end":{"line":92,"column":64}},"loc":{"start":{"line":92,"column":83},"end":{"line":96,"column":9}},"line":92},"8":{"name":"(anonymous_8)","decl":{"start":{"line":99,"column":25},"end":{"line":99,"column":26}},"loc":{"start":{"line":99,"column":41},"end":{"line":125,"column":5}},"line":99},"9":{"name":"(anonymous_9)","decl":{"start":{"line":121,"column":29},"end":{"line":121,"column":30}},"loc":{"start":{"line":121,"column":49},"end":{"line":124,"column":9}},"line":121},"10":{"name":"(anonymous_10)","decl":{"start":{"line":127,"column":22},"end":{"line":127,"column":23}},"loc":{"start":{"line":127,"column":38},"end":{"line":133,"column":5}},"line":127},"11":{"name":"(anonymous_11)","decl":{"start":{"line":128,"column":63},"end":{"line":128,"column":64}},"loc":{"start":{"line":128,"column":83},"end":{"line":132,"column":9}},"line":128},"12":{"name":"(anonymous_12)","decl":{"start":{"line":135,"column":41},"end":{"line":135,"column":42}},"loc":{"start":{"line":135,"column":57},"end":{"line":140,"column":5}},"line":135},"13":{"name":"(anonymous_13)","decl":{"start":{"line":136,"column":62},"end":{"line":136,"column":63}},"loc":{"start":{"line":136,"column":82},"end":{"line":139,"column":9}},"line":136},"14":{"name":"(anonymous_14)","decl":{"start":{"line":142,"column":44},"end":{"line":142,"column":45}},"loc":{"start":{"line":142,"column":60},"end":{"line":149,"column":5}},"line":142},"15":{"name":"(anonymous_15)","decl":{"start":{"line":145,"column":15},"end":{"line":145,"column":16}},"loc":{"start":{"line":145,"column":35},"end":{"line":148,"column":9}},"line":145},"16":{"name":"(anonymous_16)","decl":{"start":{"line":151,"column":36},"end":{"line":151,"column":37}},"loc":{"start":{"line":151,"column":52},"end":{"line":160,"column":5}},"line":151},"17":{"name":"(anonymous_17)","decl":{"start":{"line":155,"column":15},"end":{"line":155,"column":16}},"loc":{"start":{"line":155,"column":35},"end":{"line":159,"column":9}},"line":155},"18":{"name":"(anonymous_18)","decl":{"start":{"line":162,"column":36},"end":{"line":162,"column":37}},"loc":{"start":{"line":162,"column":52},"end":{"line":171,"column":5}},"line":162},"19":{"name":"(anonymous_19)","decl":{"start":{"line":166,"column":15},"end":{"line":166,"column":16}},"loc":{"start":{"line":166,"column":35},"end":{"line":170,"column":9}},"line":166},"20":{"name":"(anonymous_20)","decl":{"start":{"line":173,"column":28},"end":{"line":173,"column":29}},"loc":{"start":{"line":173,"column":44},"end":{"line":180,"column":5}},"line":173},"21":{"name":"(anonymous_21)","decl":{"start":{"line":174,"column":49},"end":{"line":174,"column":50}},"loc":{"start":{"line":174,"column":69},"end":{"line":179,"column":9}},"line":174},"22":{"name":"(anonymous_22)","decl":{"start":{"line":182,"column":33},"end":{"line":182,"column":34}},"loc":{"start":{"line":182,"column":49},"end":{"line":188,"column":5}},"line":182},"23":{"name":"(anonymous_23)","decl":{"start":{"line":183,"column":89},"end":{"line":183,"column":90}},"loc":{"start":{"line":183,"column":109},"end":{"line":187,"column":9}},"line":183},"24":{"name":"(anonymous_24)","decl":{"start":{"line":190,"column":25},"end":{"line":190,"column":26}},"loc":{"start":{"line":190,"column":41},"end":{"line":201,"column":5}},"line":190},"25":{"name":"(anonymous_25)","decl":{"start":{"line":196,"column":15},"end":{"line":196,"column":16}},"loc":{"start":{"line":196,"column":35},"end":{"line":200,"column":9}},"line":196},"26":{"name":"(anonymous_26)","decl":{"start":{"line":203,"column":22},"end":{"line":203,"column":23}},"loc":{"start":{"line":203,"column":38},"end":{"line":209,"column":5}},"line":203},"27":{"name":"(anonymous_27)","decl":{"start":{"line":204,"column":63},"end":{"line":204,"column":64}},"loc":{"start":{"line":204,"column":83},"end":{"line":208,"column":9}},"line":204},"28":{"name":"(anonymous_28)","decl":{"start":{"line":211,"column":25},"end":{"line":211,"column":26}},"loc":{"start":{"line":211,"column":41},"end":{"line":218,"column":5}},"line":211},"29":{"name":"(anonymous_29)","decl":{"start":{"line":214,"column":15},"end":{"line":214,"column":16}},"loc":{"start":{"line":214,"column":35},"end":{"line":217,"column":9}},"line":214}},"branchMap":{"0":{"loc":{"start":{"line":39,"column":16},"end":{"line":69,"column":17}},"type":"switch","locations":[{"start":{"line":40,"column":20},"end":{"line":43,"column":58}},{"start":{"line":45,"column":20},"end":{"line":59,"column":30}},{"start":{"line":61,"column":20},"end":{"line":64,"column":42}},{"start":{"line":66,"column":20},"end":{"line":66,"column":28}},{"start":{"line":67,"column":20},"end":{"line":68,"column":47}}],"line":39},"1":{"loc":{"start":{"line":49,"column":28},"end":{"line":49,"column":56}},"type":"if","locations":[{"start":{"line":49,"column":28},"end":{"line":49,"column":56}},{"start":{"line":49,"column":28},"end":{"line":49,"column":56}}],"line":49},"2":{"loc":{"start":{"line":51,"column":28},"end":{"line":54,"column":29}},"type":"if","locations":[{"start":{"line":51,"column":28},"end":{"line":54,"column":29}},{"start":{"line":51,"column":28},"end":{"line":54,"column":29}}],"line":51},"3":{"loc":{"start":{"line":51,"column":32},"end":{"line":51,"column":58}},"type":"binary-expr","locations":[{"start":{"line":51,"column":32},"end":{"line":51,"column":38}},{"start":{"line":51,"column":42},"end":{"line":51,"column":58}}],"line":51}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":2,"19":3,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":0,"27":1,"28":1,"29":1,"30":1,"31":1,"32":1,"33":0,"34":0,"35":0,"36":1,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":1,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":1,"58":1,"59":1,"60":1,"61":1,"62":1,"63":1,"64":1,"65":1,"66":1,"67":1,"68":1,"69":1,"70":0,"71":0,"72":1,"73":1,"74":1,"75":1,"76":1,"77":1,"78":1,"79":1,"80":1,"81":1,"82":1,"83":1,"84":1,"85":1,"86":1,"87":1,"88":1,"89":1,"90":1,"91":1,"92":1,"93":1,"94":1,"95":1,"96":1,"97":1,"98":1,"99":1,"100":1,"101":1},"f":{"0":1,"1":1,"2":2,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":1,"28":1,"29":1},"b":{"0":[1,1,0,1,1],"1":[0,1],"2":[1,0],"3":[1,1]},"inputSourceMap":{"version":3,"sources":["src/server.spec.js"],"names":["chai","chaiHttp","axios","MockAdapter","crypto","app","signin","userPool","dropDb","username","process","env","TEST_USERNAME","password","TEST_PASSWORD","secret","PAYSTACK_SECRET","mock","expect","use","global","fetch","require","describe","token","user","paystackRef","emailCode","invoiceId","accessBankCode","it","cognitoUser","getCurrentUser","getSession","err","result","console","error","isValid","getIdToken","getJwtToken","payload","to","have","property","done","request","post","set","send","description","deliveryAmount","purchaseAmount","customerName","customerEmail","end","res","body","data","_id","be","success","equal","get","payment","event","reference","amount","customer","first_name","last_name","email","metadata","marchantEmail","hash","createHmac","update","digest","status","accepted","code","length","greaterThan","haveOwnProperty","category","reason","delete"],"mappings":"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","file":"server.spec.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import chai from 'chai';\nimport chaiHttp from 'chai-http';\nimport axios from 'axios';\nimport MockAdapter from 'axios-mock-adapter';\nimport crypto from 'crypto';\nimport app from './server';\nimport { signin, userPool, dropDb } from './test-helpers/auth';\n\nconst username = process.env.TEST_USERNAME;\nconst password = process.env.TEST_PASSWORD;\nconst secret = process.env.PAYSTACK_SECRET;\nconst mock = new MockAdapter(axios);\nconst expect = chai.expect;\n\nchai.use(chaiHttp);\nglobal.fetch = require('node-fetch-polyfill');\n\ndropDb();\n\ndescribe('Server Operations', () => {\n    \n    let token;\n    let user;\n    let paystackRef = '1234567890';\n    let emailCode = 'AXYZ0000';\n    let invoiceId = null;\n    let accessBankCode = null;\n\n    it('Login', async () => {\n        try {\n            await signin(username, password);\n            const cognitoUser = userPool.getCurrentUser();    \n            cognitoUser.getSession((err, result) => {\n                if (err) console.error(err);\n\n                if (result && result.isValid()) {\n                    token = result.getIdToken().getJwtToken();\n                    user = result.getIdToken().payload;\n                }\n\n                expect(user).to.have.property('sub');\n            });\n        } catch (err) {\n            throw err;\n        }\n    });\n\n\n    it('create invoice', (done) => {\n        chai.request(app)\n        .post('/api/invoice')\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .send({\n            description: \"This is an invoice\",\n            deliveryAmount: 500,\n            purchaseAmount: 5000,\n            customerName: 'Victor Nwaokocha',\n            customerEmail: 'vnwaokocha@gmail.com'\n        })\n        .end((err, res) => {\n            invoiceId = res.body.data._id;\n            expect(res.body.data).to.be.have.property('_id');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n\n    it('retrive invoice', (done) => {\n        chai.request(app)\n        .get('/api/invoice/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.data._id).to.be.equal(invoiceId);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('create payment', (done) => {\n        const payment = {\n            event: 'charge.success',\n            data: {\n                reference: '',\n                amount: 200000,\n                customer: { \n                    first_name: 'Victor',\n                    last_name: 'Nwaokocha',\n                    email: 'nvonweb@outlook.com',\n                    metadata: {\n                        invoiceId,\n                        marchantEmail : 'vnwaokocha@gmail.com'\n                    }\n                } \n            }\n        };\n        \n        const hash = crypto.createHmac('sha512', secret).update(JSON.stringify(payment)).digest('hex');\n\n        chai.request(app)\n        .post('/api/payment')\n        .set({\n            'X-Paystack-Signature': hash\n        })\n        .send(payment)\n        .end((err, res) => {\n            expect(res.status).to.be.equal(200);\n            done();\n        });\n\n    });\n\n    it('get payment', (done) => {\n        chai.request(app)\n        .get('/api/payment/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.data.invoiceId).to.be.equal(invoiceId);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('send customer verifcation mail', (done) => {\n        chai.request(app)\n        .get('/api/verify/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('do not confirm without email code', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            accepted: true\n        })\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(false);\n            done();\n        });\n    });\n\n    it('confirm payment::accepted', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            emailCode,\n            accepted: true\n        })\n        .end((err, res) => {\n            expect(res.body.data.status).to.be.equal(\"accepted\");\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('confirm payment::rejected', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            emailCode,\n            accepted: false\n        })\n        .end((err, res) => {\n            expect(res.body.data.status).to.be.equal(\"rejected\");\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('get list of banks', (done) => {\n        chai.request(app)\n        .get('/api/banks/')\n        .end((err, res) => {\n            accessBankCode = res.body.data[0].code;\n            expect(res.body.data.length).to.be.greaterThan(2);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('confirm account number', (done) => {\n        chai.request(app)\n        .get(`/api/banks/verify/${accessBankCode}/0695257934`)\n        .end((err, res) => {\n            expect(res.body.data).to.haveOwnProperty('account_name');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    })\n    \n    it('create dispute', (done) => {\n        chai.request(app)\n        .post(`/api/dispute/${invoiceId}`)\n        .send({\n            customerEmail: 'nvonweb@outlook.com',\n            marchantEmail: 'vnwaokocha@gmail.com',\n            category: '',\n            reason: 'I don\\'t want anymore'\n        })\n        .end((err, res) => {\n            expect(res.body.data).to.haveOwnProperty('_id');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('get dispute', (done) => {\n        chai.request(app)\n        .get(`/api/dispute/${invoiceId}`)\n        .end((err, res) => {\n            expect(res.body.data.status).to.equal('open');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('delete invoice', (done) => {\n        chai.request(app)\n        .delete('/api/invoice/'+invoiceId)\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"3d6aea9e7beb55266bd4ba266d15a89835d15e38"}}