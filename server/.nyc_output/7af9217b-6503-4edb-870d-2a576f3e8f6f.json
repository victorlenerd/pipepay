{"/Users/Sleekvick/Projects/pipepay/server/src/middleware.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/middleware.js","statementMap":{"0":{"start":{"line":4,"column":26},"end":{"line":8,"column":1}},"1":{"start":{"line":5,"column":4},"end":{"line":5,"column":22}},"2":{"start":{"line":6,"column":4},"end":{"line":6,"column":55}},"3":{"start":{"line":7,"column":4},"end":{"line":7,"column":31}}},"fnMap":{"0":{"name":"setGlobalMiddleware","decl":{"start":{"line":4,"column":35},"end":{"line":4,"column":54}},"loc":{"start":{"line":4,"column":60},"end":{"line":8,"column":1}},"line":4}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{},"inputSourceMap":{"version":3,"sources":["src/middleware.js"],"names":["bodyParser","morgan","setGlobalMiddleware","app","use","urlencoded","extended","json"],"mappings":"AAAA,OAAOA,UAAP,MAAuB,aAAvB;AACA,OAAOC,MAAP,MAAmB,QAAnB;;AAEA,IAAMC,sBAAsB,SAAtBA,mBAAsB,MAAO;AAC/BC,QAAIC,GAAJ,CAAQH,QAAR;AACAE,QAAIC,GAAJ,CAAQJ,WAAWK,UAAX,CAAsB,EAAEC,UAAU,IAAZ,EAAtB,CAAR;AACAH,QAAIC,GAAJ,CAAQJ,WAAWO,IAAX,EAAR;AACH,CAJD;;AAMA,eAAeL,mBAAf","file":"middleware.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import bodyParser from 'body-parser';\nimport morgan from 'morgan';\n\nconst setGlobalMiddleware = app => {\n    app.use(morgan());\n    app.use(bodyParser.urlencoded({ extended: true }))\n    app.use(bodyParser.json())\n}\n\nexport default setGlobalMiddleware;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"29cee4da1d88e554e3027715d8cf64866613745b"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":11,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.model.js"],"names":["mongoose","DisputeSchema","Schema","customerEmail","String","marchantEmail","from","reason","category","invoiceId","type","unique","status","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,mBAAeC,MADuB;AAEtCC,mBAAeD,MAFuB;AAGtCE,UAAMF,MAHgC;AAItCG,YAAQH,MAJ8B;AAKtCI,cAAUJ,MAL4B;AAMtCK,eAAW,EAAEC,MAAMN,MAAR,EAAgBO,QAAQ,IAAxB,EAN2B;AAOtCC,YAAQR;AAP8B,CAApB,CAAtB;;AAUA,eAAeJ,SAASa,KAAT,CAAe,SAAf,EAA0BZ,aAA1B,CAAf","file":"dispute.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst DisputeSchema = new mongoose.Schema({\n    customerEmail: String,\n    marchantEmail: String,\n    from: String,\n    reason: String,\n    category: String,\n    invoiceId: { type: String, unique: true },\n    status: String\n});\n\nexport default mongoose.model('Dispute', DisputeSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"fd133248553e28755a4b1ff62262a15a5497b4df"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.model.js","statementMap":{"0":{"start":{"line":3,"column":29},"end":{"line":8,"column":2}},"1":{"start":{"line":10,"column":20},"end":{"line":39,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.model.js"],"names":["mongoose","MilestoneSchema","Schema","amount","type","Number","required","description","String","dueDate","Date","paid","Boolean","default","InvoiceSchema","userId","enum","deliveryAmount","purchaseAmount","pipePayFee","totalPrice","bankCharges","customerName","customerEmail","customerPhone","marchantName","marchantAccountNumber","marchantBankCode","marchantEmail","milestones","invoice_code","unique","verifyCode","whoPaysPipepayFee","whoPaysDeliveryFee","status","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,OAAO,IAAMC,kBAAkB,IAAID,SAASE,MAAb,CAAoB;AAC/CC,YAAQ,EAAEC,MAAMC,MAAR,EAAgBC,UAAU,IAA1B,EADuC;AAE/CC,iBAAc,EAAEH,MAAMI,MAAR,EAAgBF,UAAU,IAA1B,EAFiC;AAG/CG,aAAS,EAAEL,MAAMM,IAAR,EAHsC;AAI/CC,UAAM,EAAEP,MAAMQ,OAAR,EAAiBN,UAAU,IAA3B,EAAiCO,SAAS,KAA1C;AAJyC,CAApB,CAAxB;;AAOP,IAAMC,gBAAgB,IAAId,SAASE,MAAb,CAAoB;AACtCa,YAAQ,EAAEX,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAD8B;AAEtCF,UAAM,EAAEA,MAAMI,MAAR,EAAgBQ,MAAM,CAAC,SAAD,EAAY,MAAZ,CAAtB,EAA2CV,UAAU,IAArD,EAFgC;AAGtCC,iBAAa,EAAEH,MAAMI,MAAR,EAAgBF,UAAU,IAA1B,EAHyB;;AAKtCW,oBAAgB,EAAEb,MAAMC,MAAR,EAAgBC,UAAU,IAA1B,EALsB;AAMtCY,oBAAgB,EAAEd,MAAMC,MAAR,EAAgBC,UAAU,IAA1B,EANsB;AAOtCa,gBAAY,EAAEf,MAAMC,MAAR,EAAgBC,UAAU,IAA1B,EAP0B;AAQtCc,gBAAY,EAAEhB,MAAMC,MAAR,EAAgBC,UAAU,IAA1B,EAR0B;AAStCe,iBAAa,EAAEjB,MAAMC,MAAR,EAAgBC,UAAU,IAA1B,EATyB;;AAWtCgB,kBAAc,EAAElB,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAXwB;AAYtCiB,mBAAe,EAAEnB,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAZuB;AAatCkB,mBAAe,EAAEpB,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAbuB;;AAetCmB,kBAAc,EAAErB,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAfwB;AAgBtCoB,2BAAuB,EAAEtB,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAhBe;AAiBtCqB,sBAAkB,EAAEvB,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAjBoB;AAkBtCsB,mBAAe,EAAExB,MAAKI,MAAP,EAAeF,UAAU,IAAzB,EAlBuB;;AAoBtCuB,gBAAY,CAAC5B,eAAD,CApB0B;;AAsBtC6B,kBAAc,EAAE1B,MAAKI,MAAP,EAAeuB,QAAQ,IAAvB,EAtBwB;AAuBtCC,gBAAY,EAAE5B,MAAKI,MAAP,EAAeuB,QAAQ,IAAvB,EAvB0B;;AAyBtCE,uBAAmB,EAAE7B,MAAMI,MAAR,EAAgBQ,MAAM,CAAC,OAAD,EAAU,QAAV,EAAoB,MAApB,CAAtB,EAzBmB;AA0BtCkB,wBAAoB,EAAE9B,MAAMI,MAAR,EAAgBQ,MAAM,CAAC,OAAD,EAAU,QAAV,EAAoB,MAApB,CAAtB,EA1BkB;;AA4BtCmB,YAAQ3B;AA5B8B,CAApB,CAAtB;;AA+BA,eAAeR,SAASoC,KAAT,CAAe,SAAf,EAA0BtB,aAA1B,CAAf","file":"invoice.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nexport const MilestoneSchema = new mongoose.Schema({\n    amount: { type: Number, required: true },\n    description:  { type: String, required: true },\n    dueDate: { type: Date },\n    paid: { type: Boolean, required: true, default: false }\n});\n\nconst InvoiceSchema = new mongoose.Schema({\n    userId: { type:String, required: true },\n    type: { type: String, enum: ['service', 'good'], required: true },\n    description: { type: String, required: true },\n    \n    deliveryAmount: { type: Number, required: true },\n    purchaseAmount: { type: Number, required: true },\n    pipePayFee: { type: Number, required: true },\n    totalPrice: { type: Number, required: true },\n    bankCharges: { type: Number, required: true },\n\n    customerName: { type:String, required: true },\n    customerEmail: { type:String, required: true },\n    customerPhone: { type:String, required: true },\n    \n    marchantName: { type:String, required: true },\n    marchantAccountNumber: { type:String, required: true },\n    marchantBankCode: { type:String, required: true },\n    marchantEmail: { type:String, required: true },\n    \n    milestones: [MilestoneSchema],\n    \n    invoice_code: { type:String, unique: true },\n    verifyCode: { type:String, unique: true },\n\n    whoPaysPipepayFee: { type: String, enum: ['buyer', 'seller', 'both'] },\n    whoPaysDeliveryFee: { type: String, enum: ['buyer', 'seller', 'both'] }, \n\n    status: String\n});\n\nexport default mongoose.model('Invoice', InvoiceSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"502643c76bd5f99500964a21ac0718dc5a852af4"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/generateController.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/generateController.js","statementMap":{"0":{"start":{"line":4,"column":21},"end":{"line":49,"column":5}},"1":{"start":{"line":6,"column":12},"end":{"line":10,"column":15}},"2":{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},"3":{"start":{"line":7,"column":25},"end":{"line":7,"column":99}},"4":{"start":{"line":8,"column":16},"end":{"line":8,"column":35}},"5":{"start":{"line":9,"column":16},"end":{"line":9,"column":23}},"6":{"start":{"line":13,"column":23},"end":{"line":13,"column":31}},"7":{"start":{"line":14,"column":12},"end":{"line":14,"column":38}},"8":{"start":{"line":15,"column":12},"end":{"line":18,"column":15}},"9":{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},"10":{"start":{"line":16,"column":25},"end":{"line":16,"column":92}},"11":{"start":{"line":17,"column":16},"end":{"line":17,"column":67}},"12":{"start":{"line":21,"column":21},"end":{"line":21,"column":30}},"13":{"start":{"line":22,"column":12},"end":{"line":25,"column":15}},"14":{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},"15":{"start":{"line":23,"column":25},"end":{"line":23,"column":92}},"16":{"start":{"line":24,"column":16},"end":{"line":24,"column":56}},"17":{"start":{"line":28,"column":12},"end":{"line":31,"column":15}},"18":{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},"19":{"start":{"line":29,"column":25},"end":{"line":29,"column":92}},"20":{"start":{"line":30,"column":16},"end":{"line":30,"column":68}},"21":{"start":{"line":34,"column":21},"end":{"line":34,"column":30}},"22":{"start":{"line":35,"column":12},"end":{"line":38,"column":15}},"23":{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},"24":{"start":{"line":36,"column":25},"end":{"line":36,"column":92}},"25":{"start":{"line":37,"column":16},"end":{"line":37,"column":71}},"26":{"start":{"line":41,"column":21},"end":{"line":41,"column":30}},"27":{"start":{"line":42,"column":23},"end":{"line":42,"column":31}},"28":{"start":{"line":43,"column":12},"end":{"line":47,"column":15}},"29":{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},"30":{"start":{"line":44,"column":25},"end":{"line":44,"column":92}},"31":{"start":{"line":45,"column":30},"end":{"line":45,"column":59}},"32":{"start":{"line":46,"column":16},"end":{"line":46,"column":71}},"33":{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},"34":{"start":{"line":52,"column":8},"end":{"line":52,"column":23}},"35":{"start":{"line":55,"column":4},"end":{"line":55,"column":53}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":3,"column":15},"end":{"line":3,"column":16}},"loc":{"start":{"line":3,"column":43},"end":{"line":56,"column":1}},"line":3},"1":{"name":"findByParam","decl":{"start":{"line":5,"column":30},"end":{"line":5,"column":41}},"loc":{"start":{"line":5,"column":62},"end":{"line":11,"column":9}},"line":5},"2":{"name":"(anonymous_2)","decl":{"start":{"line":6,"column":31},"end":{"line":6,"column":32}},"loc":{"start":{"line":6,"column":51},"end":{"line":10,"column":13}},"line":6},"3":{"name":"createOne","decl":{"start":{"line":12,"column":28},"end":{"line":12,"column":37}},"loc":{"start":{"line":12,"column":48},"end":{"line":19,"column":9}},"line":12},"4":{"name":"(anonymous_4)","decl":{"start":{"line":15,"column":31},"end":{"line":15,"column":32}},"loc":{"start":{"line":15,"column":51},"end":{"line":18,"column":13}},"line":15},"5":{"name":"deleteOne","decl":{"start":{"line":20,"column":28},"end":{"line":20,"column":37}},"loc":{"start":{"line":20,"column":48},"end":{"line":26,"column":9}},"line":20},"6":{"name":"(anonymous_6)","decl":{"start":{"line":22,"column":41},"end":{"line":22,"column":42}},"loc":{"start":{"line":22,"column":61},"end":{"line":25,"column":13}},"line":22},"7":{"name":"getAll","decl":{"start":{"line":27,"column":25},"end":{"line":27,"column":31}},"loc":{"start":{"line":27,"column":42},"end":{"line":32,"column":9}},"line":27},"8":{"name":"(anonymous_8)","decl":{"start":{"line":28,"column":27},"end":{"line":28,"column":28}},"loc":{"start":{"line":28,"column":48},"end":{"line":31,"column":13}},"line":28},"9":{"name":"getOne","decl":{"start":{"line":33,"column":25},"end":{"line":33,"column":31}},"loc":{"start":{"line":33,"column":42},"end":{"line":39,"column":9}},"line":33},"10":{"name":"(anonymous_10)","decl":{"start":{"line":35,"column":36},"end":{"line":35,"column":37}},"loc":{"start":{"line":35,"column":57},"end":{"line":38,"column":13}},"line":35},"11":{"name":"updateOne","decl":{"start":{"line":40,"column":28},"end":{"line":40,"column":37}},"loc":{"start":{"line":40,"column":48},"end":{"line":48,"column":9}},"line":40},"12":{"name":"(anonymous_12)","decl":{"start":{"line":43,"column":54},"end":{"line":43,"column":55}},"loc":{"start":{"line":43,"column":74},"end":{"line":47,"column":13}},"line":43}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},"type":"if","locations":[{"start":{"line":7,"column":16},"end":{"line":7,"column":99}},{"start":{"line":7,"column":16},"end":{"line":7,"column":99}}],"line":7},"1":{"loc":{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},"type":"if","locations":[{"start":{"line":16,"column":16},"end":{"line":16,"column":92}},{"start":{"line":16,"column":16},"end":{"line":16,"column":92}}],"line":16},"2":{"loc":{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},"type":"if","locations":[{"start":{"line":23,"column":16},"end":{"line":23,"column":92}},{"start":{"line":23,"column":16},"end":{"line":23,"column":92}}],"line":23},"3":{"loc":{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},"type":"if","locations":[{"start":{"line":29,"column":16},"end":{"line":29,"column":92}},{"start":{"line":29,"column":16},"end":{"line":29,"column":92}}],"line":29},"4":{"loc":{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},"type":"if","locations":[{"start":{"line":36,"column":16},"end":{"line":36,"column":92}},{"start":{"line":36,"column":16},"end":{"line":36,"column":92}}],"line":36},"5":{"loc":{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},"type":"if","locations":[{"start":{"line":44,"column":16},"end":{"line":44,"column":92}},{"start":{"line":44,"column":16},"end":{"line":44,"column":92}}],"line":44},"6":{"loc":{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},"type":"if","locations":[{"start":{"line":51,"column":4},"end":{"line":53,"column":5}},{"start":{"line":51,"column":4},"end":{"line":53,"column":5}}],"line":51}},"s":{"0":3,"1":1,"2":1,"3":0,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":1,"13":1,"14":1,"15":0,"16":1,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":3,"34":0,"35":3},"f":{"0":3,"1":1,"2":1,"3":0,"4":0,"5":1,"6":1,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0},"b":{"0":[0,1],"1":[0,0],"2":[0,1],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,3]},"inputSourceMap":{"version":3,"sources":["src/api/modules/generateController.js"],"names":["model","overrides","controller","findByParam","req","res","next","id","findById","err","doc","status","send","success","error","message","docId","createOne","body","userId","user","create","data","deleteOne","_id","getAll","find","docs","getOne","updateOne","findOneAndUpdate","updated"],"mappings":"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","file":"generateController.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["export default function (model, overrides) {\n    var controller = {\n        findByParam: function (req, res, next, id) {\n            model.findById(id, function (err, doc) {\n                if (err) res.status(404).send({ success: false, error: { message: \"Not found\" } });\n                req.docId = doc.id;\n                next();\n            });\n        },\n        createOne: function (req, res) {\n            var body = req.body;\n            body.userId = req.user.id;\n            model.create(body, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });\n                res.status(200).send({ success: true, data: doc });\n            });\n        },\n        deleteOne: function (req, res) {\n            var id = req.docId;\n            model.deleteOne({ _id: id }, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true });\n            });\n        },\n        getAll: function (req, res) {\n            model.find({}, function (err, docs) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true, data: docs });\n            });\n        },\n        getOne: function (req, res) {\n            var id = req.docId;\n            model.find({ _id: id }, function (err, docs) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                res.status(200).send({ success: true, data: docs[0] });\n            });\n        },\n        updateOne: function (req, res) {\n            var id = req.docId;\n            var body = req.body;\n            model.findOneAndUpdate({ _id: id }, body, function (err, doc) {\n                if (err) res.status(401).send({ success: false, error: { ...err } });;\n                var updated = Object.assign({}, body, doc);\n                res.status(200).send({ success: true, data: updated });\n            });\n        }\n    };\n\n    if (!overrides) {\n        overrides = {}\n    }\n\n    return Object.assign({}, controller, overrides);\n};"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"c7631bddd9b0416ea7b10a2286b419bc28f8c545"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/mailer.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/mailer.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":10,"column":17},"end":{"line":10,"column":39}},"2":{"start":{"line":11,"column":20},"end":{"line":11,"column":45}},"3":{"start":{"line":13,"column":18},"end":{"line":21,"column":2}},"4":{"start":{"line":23,"column":11},"end":{"line":23,"column":43}},"5":{"start":{"line":25,"column":29},"end":{"line":44,"column":1}},"6":{"start":{"line":26,"column":24},"end":{"line":26,"column":42}},"7":{"start":{"line":27,"column":21},"end":{"line":27,"column":36}},"8":{"start":{"line":28,"column":4},"end":{"line":43,"column":7}},"9":{"start":{"line":29,"column":26},"end":{"line":34,"column":9}},"10":{"start":{"line":36,"column":8},"end":{"line":42,"column":11}},"11":{"start":{"line":37,"column":12},"end":{"line":39,"column":13}},"12":{"start":{"line":38,"column":16},"end":{"line":38,"column":48}},"13":{"start":{"line":41,"column":12},"end":{"line":41,"column":26}},"14":{"start":{"line":46,"column":13},"end":{"line":55,"column":1}},"15":{"start":{"line":47,"column":4},"end":{"line":54,"column":7}},"16":{"start":{"line":48,"column":8},"end":{"line":53,"column":11}},"17":{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},"18":{"start":{"line":50,"column":16},"end":{"line":50,"column":48}},"19":{"start":{"line":52,"column":12},"end":{"line":52,"column":26}},"20":{"start":{"line":57,"column":29},"end":{"line":85,"column":1}},"21":{"start":{"line":58,"column":4},"end":{"line":84,"column":9}},"22":{"start":{"line":59,"column":20},"end":{"line":79,"column":11}},"23":{"start":{"line":61,"column":12},"end":{"line":78,"column":31}},"24":{"start":{"line":62,"column":16},"end":{"line":77,"column":17}},"25":{"start":{"line":63,"column":20},"end":{"line":76,"column":21}},"26":{"start":{"line":65,"column":28},"end":{"line":69,"column":30}},"27":{"start":{"line":71,"column":28},"end":{"line":71,"column":186}},"28":{"start":{"line":75,"column":28},"end":{"line":75,"column":51}},"29":{"start":{"line":81,"column":8},"end":{"line":83,"column":10}},"30":{"start":{"line":82,"column":12},"end":{"line":82,"column":48}},"31":{"start":{"line":87,"column":30},"end":{"line":89,"column":1}},"32":{"start":{"line":88,"column":4},"end":{"line":88,"column":54}},"33":{"start":{"line":91,"column":29},"end":{"line":145,"column":1}},"34":{"start":{"line":92,"column":23},"end":{"line":92,"column":113}},"35":{"start":{"line":93,"column":4},"end":{"line":144,"column":9}},"36":{"start":{"line":94,"column":20},"end":{"line":139,"column":11}},"37":{"start":{"line":96,"column":12},"end":{"line":138,"column":43}},"38":{"start":{"line":97,"column":16},"end":{"line":137,"column":17}},"39":{"start":{"line":98,"column":20},"end":{"line":136,"column":21}},"40":{"start":{"line":100,"column":28},"end":{"line":103,"column":30}},"41":{"start":{"line":104,"column":28},"end":{"line":104,"column":47}},"42":{"start":{"line":106,"column":28},"end":{"line":109,"column":29}},"43":{"start":{"line":107,"column":32},"end":{"line":107,"column":51}},"44":{"start":{"line":108,"column":32},"end":{"line":108,"column":38}},"45":{"start":{"line":111,"column":28},"end":{"line":111,"column":47}},"46":{"start":{"line":112,"column":28},"end":{"line":112,"column":504}},"47":{"start":{"line":115,"column":28},"end":{"line":115,"column":47}},"48":{"start":{"line":116,"column":28},"end":{"line":116,"column":34}},"49":{"start":{"line":119,"column":28},"end":{"line":119,"column":47}},"50":{"start":{"line":120,"column":28},"end":{"line":120,"column":504}},"51":{"start":{"line":123,"column":28},"end":{"line":123,"column":38}},"52":{"start":{"line":124,"column":28},"end":{"line":124,"column":48}},"53":{"start":{"line":125,"column":28},"end":{"line":125,"column":34}},"54":{"start":{"line":128,"column":28},"end":{"line":128,"column":48}},"55":{"start":{"line":129,"column":28},"end":{"line":129,"column":65}},"56":{"start":{"line":131,"column":28},"end":{"line":131,"column":49}},"57":{"start":{"line":135,"column":28},"end":{"line":135,"column":52}},"58":{"start":{"line":141,"column":8},"end":{"line":143,"column":10}},"59":{"start":{"line":142,"column":12},"end":{"line":142,"column":48}},"60":{"start":{"line":147,"column":43},"end":{"line":187,"column":1}},"61":{"start":{"line":148,"column":4},"end":{"line":186,"column":9}},"62":{"start":{"line":149,"column":20},"end":{"line":181,"column":11}},"63":{"start":{"line":151,"column":12},"end":{"line":180,"column":42}},"64":{"start":{"line":152,"column":16},"end":{"line":179,"column":17}},"65":{"start":{"line":153,"column":20},"end":{"line":178,"column":21}},"66":{"start":{"line":155,"column":28},"end":{"line":159,"column":30}},"67":{"start":{"line":160,"column":28},"end":{"line":160,"column":47}},"68":{"start":{"line":161,"column":28},"end":{"line":161,"column":47}},"69":{"start":{"line":162,"column":28},"end":{"line":162,"column":91}},"70":{"start":{"line":165,"column":28},"end":{"line":165,"column":38}},"71":{"start":{"line":166,"column":28},"end":{"line":166,"column":48}},"72":{"start":{"line":167,"column":28},"end":{"line":167,"column":34}},"73":{"start":{"line":170,"column":28},"end":{"line":170,"column":47}},"74":{"start":{"line":171,"column":28},"end":{"line":171,"column":65}},"75":{"start":{"line":173,"column":28},"end":{"line":173,"column":49}},"76":{"start":{"line":177,"column":28},"end":{"line":177,"column":52}},"77":{"start":{"line":183,"column":8},"end":{"line":185,"column":10}},"78":{"start":{"line":184,"column":12},"end":{"line":184,"column":48}},"79":{"start":{"line":189,"column":32},"end":{"line":232,"column":1}},"80":{"start":{"line":190,"column":17},"end":{"line":190,"column":29}},"81":{"start":{"line":191,"column":15},"end":{"line":191,"column":25}},"82":{"start":{"line":192,"column":4},"end":{"line":231,"column":9}},"83":{"start":{"line":193,"column":20},"end":{"line":226,"column":11}},"84":{"start":{"line":195,"column":12},"end":{"line":225,"column":42}},"85":{"start":{"line":196,"column":16},"end":{"line":224,"column":17}},"86":{"start":{"line":197,"column":20},"end":{"line":223,"column":21}},"87":{"start":{"line":199,"column":28},"end":{"line":203,"column":30}},"88":{"start":{"line":204,"column":28},"end":{"line":204,"column":47}},"89":{"start":{"line":205,"column":28},"end":{"line":205,"column":47}},"90":{"start":{"line":206,"column":28},"end":{"line":206,"column":91}},"91":{"start":{"line":209,"column":28},"end":{"line":209,"column":38}},"92":{"start":{"line":210,"column":28},"end":{"line":210,"column":48}},"93":{"start":{"line":211,"column":28},"end":{"line":211,"column":34}},"94":{"start":{"line":214,"column":28},"end":{"line":214,"column":47}},"95":{"start":{"line":215,"column":28},"end":{"line":215,"column":65}},"96":{"start":{"line":217,"column":28},"end":{"line":217,"column":61}},"97":{"start":{"line":218,"column":28},"end":{"line":218,"column":49}},"98":{"start":{"line":222,"column":28},"end":{"line":222,"column":52}},"99":{"start":{"line":228,"column":8},"end":{"line":230,"column":10}},"100":{"start":{"line":229,"column":12},"end":{"line":229,"column":48}}},"fnMap":{"0":{"name":"sendInvoiceMail","decl":{"start":{"line":25,"column":38},"end":{"line":25,"column":53}},"loc":{"start":{"line":25,"column":60},"end":{"line":44,"column":1}},"line":25},"1":{"name":"(anonymous_1)","decl":{"start":{"line":28,"column":24},"end":{"line":28,"column":25}},"loc":{"start":{"line":28,"column":51},"end":{"line":43,"column":5}},"line":28},"2":{"name":"(anonymous_2)","decl":{"start":{"line":36,"column":42},"end":{"line":36,"column":43}},"loc":{"start":{"line":36,"column":65},"end":{"line":42,"column":9}},"line":36},"3":{"name":"sendTo","decl":{"start":{"line":46,"column":22},"end":{"line":46,"column":28}},"loc":{"start":{"line":46,"column":41},"end":{"line":55,"column":1}},"line":46},"4":{"name":"(anonymous_4)","decl":{"start":{"line":47,"column":24},"end":{"line":47,"column":25}},"loc":{"start":{"line":47,"column":51},"end":{"line":54,"column":5}},"line":47},"5":{"name":"(anonymous_5)","decl":{"start":{"line":48,"column":41},"end":{"line":48,"column":42}},"loc":{"start":{"line":48,"column":64},"end":{"line":53,"column":9}},"line":48},"6":{"name":"sendReceiptMail","decl":{"start":{"line":57,"column":38},"end":{"line":57,"column":53}},"loc":{"start":{"line":57,"column":106},"end":{"line":85,"column":1}},"line":57},"7":{"name":"(anonymous_7)","decl":{"start":{"line":58,"column":24},"end":{"line":58,"column":25}},"loc":{"start":{"line":58,"column":36},"end":{"line":84,"column":5}},"line":58},"8":{"name":"_callee","decl":{"start":{"line":59,"column":86},"end":{"line":59,"column":93}},"loc":{"start":{"line":59,"column":111},"end":{"line":79,"column":9}},"line":59},"9":{"name":"_callee$","decl":{"start":{"line":61,"column":53},"end":{"line":61,"column":61}},"loc":{"start":{"line":61,"column":72},"end":{"line":78,"column":13}},"line":61},"10":{"name":"(anonymous_10)","decl":{"start":{"line":81,"column":15},"end":{"line":81,"column":16}},"loc":{"start":{"line":81,"column":34},"end":{"line":83,"column":9}},"line":81},"11":{"name":"sendTransferMail","decl":{"start":{"line":87,"column":39},"end":{"line":87,"column":55}},"loc":{"start":{"line":87,"column":86},"end":{"line":89,"column":1}},"line":87},"12":{"name":"(anonymous_12)","decl":{"start":{"line":88,"column":24},"end":{"line":88,"column":25}},"loc":{"start":{"line":88,"column":50},"end":{"line":88,"column":52}},"line":88},"13":{"name":"sendDisputeMail","decl":{"start":{"line":91,"column":38},"end":{"line":91,"column":53}},"loc":{"start":{"line":91,"column":119},"end":{"line":145,"column":1}},"line":91},"14":{"name":"(anonymous_14)","decl":{"start":{"line":93,"column":24},"end":{"line":93,"column":25}},"loc":{"start":{"line":93,"column":36},"end":{"line":144,"column":5}},"line":93},"15":{"name":"_callee2","decl":{"start":{"line":94,"column":86},"end":{"line":94,"column":94}},"loc":{"start":{"line":94,"column":112},"end":{"line":139,"column":9}},"line":94},"16":{"name":"_callee2$","decl":{"start":{"line":96,"column":53},"end":{"line":96,"column":62}},"loc":{"start":{"line":96,"column":74},"end":{"line":138,"column":13}},"line":96},"17":{"name":"(anonymous_17)","decl":{"start":{"line":141,"column":15},"end":{"line":141,"column":16}},"loc":{"start":{"line":141,"column":35},"end":{"line":143,"column":9}},"line":141},"18":{"name":"sendCustormerVerificationCode","decl":{"start":{"line":147,"column":52},"end":{"line":147,"column":81}},"loc":{"start":{"line":147,"column":103},"end":{"line":187,"column":1}},"line":147},"19":{"name":"(anonymous_19)","decl":{"start":{"line":148,"column":24},"end":{"line":148,"column":25}},"loc":{"start":{"line":148,"column":36},"end":{"line":186,"column":5}},"line":148},"20":{"name":"_callee3","decl":{"start":{"line":149,"column":86},"end":{"line":149,"column":94}},"loc":{"start":{"line":149,"column":112},"end":{"line":181,"column":9}},"line":149},"21":{"name":"_callee3$","decl":{"start":{"line":151,"column":53},"end":{"line":151,"column":62}},"loc":{"start":{"line":151,"column":74},"end":{"line":180,"column":13}},"line":151},"22":{"name":"(anonymous_22)","decl":{"start":{"line":183,"column":15},"end":{"line":183,"column":16}},"loc":{"start":{"line":183,"column":35},"end":{"line":185,"column":9}},"line":183},"23":{"name":"sendPaymentRequest","decl":{"start":{"line":189,"column":41},"end":{"line":189,"column":59}},"loc":{"start":{"line":189,"column":96},"end":{"line":232,"column":1}},"line":189},"24":{"name":"(anonymous_24)","decl":{"start":{"line":192,"column":24},"end":{"line":192,"column":25}},"loc":{"start":{"line":192,"column":36},"end":{"line":231,"column":5}},"line":192},"25":{"name":"_callee4","decl":{"start":{"line":193,"column":86},"end":{"line":193,"column":94}},"loc":{"start":{"line":193,"column":112},"end":{"line":226,"column":9}},"line":193},"26":{"name":"_callee4$","decl":{"start":{"line":195,"column":53},"end":{"line":195,"column":62}},"loc":{"start":{"line":195,"column":74},"end":{"line":225,"column":13}},"line":195},"27":{"name":"(anonymous_27)","decl":{"start":{"line":228,"column":15},"end":{"line":228,"column":16}},"loc":{"start":{"line":228,"column":35},"end":{"line":230,"column":9}},"line":228}},"branchMap":{"0":{"loc":{"start":{"line":37,"column":12},"end":{"line":39,"column":13}},"type":"if","locations":[{"start":{"line":37,"column":12},"end":{"line":39,"column":13}},{"start":{"line":37,"column":12},"end":{"line":39,"column":13}}],"line":37},"1":{"loc":{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},"type":"if","locations":[{"start":{"line":49,"column":12},"end":{"line":51,"column":13}},{"start":{"line":49,"column":12},"end":{"line":51,"column":13}}],"line":49},"2":{"loc":{"start":{"line":63,"column":20},"end":{"line":76,"column":21}},"type":"switch","locations":[{"start":{"line":64,"column":24},"end":{"line":71,"column":186}},{"start":{"line":73,"column":24},"end":{"line":73,"column":31}},{"start":{"line":74,"column":24},"end":{"line":75,"column":51}}],"line":63},"3":{"loc":{"start":{"line":92,"column":23},"end":{"line":92,"column":113}},"type":"cond-expr","locations":[{"start":{"line":92,"column":76},"end":{"line":92,"column":88}},{"start":{"line":92,"column":91},"end":{"line":92,"column":113}}],"line":92},"4":{"loc":{"start":{"line":92,"column":23},"end":{"line":92,"column":73}},"type":"binary-expr","locations":[{"start":{"line":92,"column":23},"end":{"line":92,"column":43}},{"start":{"line":92,"column":47},"end":{"line":92,"column":73}}],"line":92},"5":{"loc":{"start":{"line":98,"column":20},"end":{"line":136,"column":21}},"type":"switch","locations":[{"start":{"line":99,"column":24},"end":{"line":112,"column":504}},{"start":{"line":114,"column":24},"end":{"line":116,"column":34}},{"start":{"line":118,"column":24},"end":{"line":120,"column":504}},{"start":{"line":122,"column":24},"end":{"line":125,"column":34}},{"start":{"line":127,"column":24},"end":{"line":131,"column":49}},{"start":{"line":133,"column":24},"end":{"line":133,"column":32}},{"start":{"line":134,"column":24},"end":{"line":135,"column":52}}],"line":98},"6":{"loc":{"start":{"line":106,"column":28},"end":{"line":109,"column":29}},"type":"if","locations":[{"start":{"line":106,"column":28},"end":{"line":109,"column":29}},{"start":{"line":106,"column":28},"end":{"line":109,"column":29}}],"line":106},"7":{"loc":{"start":{"line":153,"column":20},"end":{"line":178,"column":21}},"type":"switch","locations":[{"start":{"line":154,"column":24},"end":{"line":162,"column":91}},{"start":{"line":164,"column":24},"end":{"line":167,"column":34}},{"start":{"line":169,"column":24},"end":{"line":173,"column":49}},{"start":{"line":175,"column":24},"end":{"line":175,"column":32}},{"start":{"line":176,"column":24},"end":{"line":177,"column":52}}],"line":153},"8":{"loc":{"start":{"line":197,"column":20},"end":{"line":223,"column":21}},"type":"switch","locations":[{"start":{"line":198,"column":24},"end":{"line":206,"column":91}},{"start":{"line":208,"column":24},"end":{"line":211,"column":34}},{"start":{"line":213,"column":24},"end":{"line":218,"column":49}},{"start":{"line":220,"column":24},"end":{"line":220,"column":32}},{"start":{"line":221,"column":24},"end":{"line":222,"column":52}}],"line":197}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":0,"17":0,"18":0,"19":0,"20":1,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":1,"32":0,"33":1,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":1,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":1,"80":0,"81":0,"82":0,"83":0,"84":0,"85":0,"86":0,"87":0,"88":0,"89":0,"90":0,"91":0,"92":0,"93":0,"94":0,"95":0,"96":0,"97":0,"98":0,"99":0,"100":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0,0],"3":[0,0],"4":[0,0],"5":[0,0,0,0,0,0,0],"6":[0,0],"7":[0,0,0,0,0],"8":[0,0,0,0,0]},"inputSourceMap":{"version":3,"sources":["src/api/modules/mailer.js"],"names":["nodemailer","ZOHO_EMAIL","process","env","ZOHO_PASSWORD","transporter","createTransport","host","port","secure","auth","user","pass","from","sendInvoiceMail","customerEmail","totalPrice","resolve","reject","mailOptions","to","subject","text","sendMail","error","info","Error","sendTo","mailOption","sendReceiptMail","customerName","marchantEmail","amount","race","then","catch","sendTransferMail","esolve","sendDisputeMail","reason","disputeFrom","supportEmail","all","sendCustormerVerificationCode","code","sendPaymentRequest","marchantName","name","console","log"],"mappings":"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","file":"mailer.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import nodemailer from 'nodemailer';\n\nconst ZOHO_EMAIL = process.env.ZOHO_EMAIL;\nconst ZOHO_PASSWORD = process.env.ZOHO_PASSWORD;\n\nconst transporter = nodemailer.createTransport({\n    host: 'smtp.zoho.com',\n    port: 465,\n    secure: true,\n    auth: {\n        user: ZOHO_EMAIL,\n        pass: ZOHO_PASSWORD\n    }\n});\n\nconst from = 'Pipepay <hello@pipepay.africa>';\n\nexport const sendInvoiceMail = ({ customerEmail, totalPrice }) => new Promise((resolve, reject) => {\n    let mailOptions = {\n        from,\n        to: customerEmail,\n        subject: 'Your Invoice Is Ready',\n        text: `Your invoice is worth ${totalPrice }`,\n    };\n\n    transporter.sendMail(mailOptions, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n\n        resolve(info);\n    });\n});\n\nconst sendTo = (mailOption) => new Promise((resolve, reject) => {\n    transporter.sendMail(mailOption, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n        resolve(info);\n    });\n});\n\nexport const sendReceiptMail = (customerName, customerEmail, marchantEmail, amount) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Your Receipt Is Ready',\n        text: `${customerName} made payment of ${amount}`,\n    };\n    Promise.race([\n        sendTo({ ...mailOption, to: customerEmail }),\n        sendTo({ ...mailOption, to: marchantEmail })\n    ]).then(resolve)\n    .catch(reject)\n});\n\nexport const sendTransferMail = (customerEmail, marchantEmail) => new Promise((esolve, reject) => {\n\n});\n\nexport const sendDisputeMail = (marchantEmail, customerEmail, customerName, reason, disputeFrom, supportEmail = 'hello@pipepay.africa') => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Payment Dispute',\n    };\n\n    try {\n        if (disputeFrom !== 'marchant') {\n            await Promise.all([\n                sendTo({ ...mailOption, to: customerEmail,  text: 'Your dispute has been received, you will hear from our support rep soon.' }),\n                sendTo({ ...mailOption, to: marchantEmail, text: `New dispute from ${customerName} reason being that: \"${reason}\"` }),\n                sendTo({ ...mailOption, to: supportEmail, text: `New dispute from ${customerEmail} reason being that: \"${reason}\" marchant email is ${marchantEmail}` })\n            ]);\n        } else {\n            await Promise.all([\n                sendTo({ ...mailOption, to: customerEmail,  text: 'Your dispute has been received, you will hear from our support rep soon.' }),\n                sendTo({ ...mailOption, to: marchantEmail, text: `New dispute from ${customerName} reason being that: \"${reason}\"` }),\n                sendTo({ ...mailOption, to: supportEmail, text: `New dispute from ${marchantEmail} reason being that: \"${reason}\" customer email is ${customerEmail}` })\n            ]);\n        }\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendCustormerVerificationCode = (customerEmail, code) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Invoice Mail Verification',\n        text: `Your invoice verfication code is ${code}`\n    };\n\n    try {\n        await sendTo({ ...mailOption, to: customerEmail });\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendPaymentRequest = ({ amount, name }, customerEmail, marchantName) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Payment Request',\n        text: `${marchantName} is requesting for payment for milestone \"${name}\"`\n    };\n\n    try {\n        await sendTo({ ...mailOption, to: customerEmail });\n        resolve();\n    } catch(err) {\n        console.log('err', err);\n        reject(err);\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"2d52d43a99d1ae501071399379ebc8e7b203304e"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.controller.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":11,"column":24},"end":{"line":103,"column":2}},"2":{"start":{"line":13,"column":18},"end":{"line":13,"column":38}},"3":{"start":{"line":15,"column":8},"end":{"line":19,"column":11}},"4":{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},"5":{"start":{"line":16,"column":21},"end":{"line":16,"column":123}},"6":{"start":{"line":17,"column":12},"end":{"line":17,"column":30}},"7":{"start":{"line":18,"column":12},"end":{"line":18,"column":19}},"8":{"start":{"line":22,"column":19},"end":{"line":22,"column":27}},"9":{"start":{"line":23,"column":27},"end":{"line":23,"column":38}},"10":{"start":{"line":24,"column":28},"end":{"line":24,"column":54}},"11":{"start":{"line":25,"column":28},"end":{"line":25,"column":54}},"12":{"start":{"line":26,"column":27},"end":{"line":26,"column":52}},"13":{"start":{"line":27,"column":18},"end":{"line":27,"column":34}},"14":{"start":{"line":29,"column":8},"end":{"line":29,"column":29}},"15":{"start":{"line":30,"column":8},"end":{"line":30,"column":29}},"16":{"start":{"line":31,"column":8},"end":{"line":70,"column":13}},"17":{"start":{"line":32,"column":23},"end":{"line":65,"column":15}},"18":{"start":{"line":33,"column":16},"end":{"line":64,"column":45}},"19":{"start":{"line":34,"column":20},"end":{"line":63,"column":21}},"20":{"start":{"line":35,"column":24},"end":{"line":62,"column":25}},"21":{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},"22":{"start":{"line":38,"column":36},"end":{"line":38,"column":54}},"23":{"start":{"line":39,"column":36},"end":{"line":39,"column":42}},"24":{"start":{"line":42,"column":32},"end":{"line":42,"column":159}},"25":{"start":{"line":45,"column":32},"end":{"line":45,"column":50}},"26":{"start":{"line":46,"column":32},"end":{"line":46,"column":50}},"27":{"start":{"line":47,"column":32},"end":{"line":47,"column":123}},"28":{"start":{"line":50,"column":32},"end":{"line":50,"column":71}},"29":{"start":{"line":51,"column":32},"end":{"line":51,"column":51}},"30":{"start":{"line":52,"column":32},"end":{"line":52,"column":38}},"31":{"start":{"line":55,"column":32},"end":{"line":55,"column":50}},"32":{"start":{"line":56,"column":32},"end":{"line":56,"column":67}},"33":{"start":{"line":57,"column":32},"end":{"line":57,"column":150}},"34":{"start":{"line":61,"column":32},"end":{"line":61,"column":55}},"35":{"start":{"line":67,"column":12},"end":{"line":69,"column":14}},"36":{"start":{"line":68,"column":16},"end":{"line":68,"column":51}},"37":{"start":{"line":73,"column":24},"end":{"line":73,"column":44}},"38":{"start":{"line":74,"column":8},"end":{"line":101,"column":13}},"39":{"start":{"line":75,"column":24},"end":{"line":96,"column":15}},"40":{"start":{"line":76,"column":16},"end":{"line":95,"column":36}},"41":{"start":{"line":77,"column":20},"end":{"line":94,"column":21}},"42":{"start":{"line":78,"column":24},"end":{"line":93,"column":25}},"43":{"start":{"line":80,"column":32},"end":{"line":83,"column":33}},"44":{"start":{"line":81,"column":36},"end":{"line":81,"column":55}},"45":{"start":{"line":82,"column":36},"end":{"line":82,"column":42}},"46":{"start":{"line":85,"column":32},"end":{"line":85,"column":144}},"47":{"start":{"line":88,"column":32},"end":{"line":88,"column":71}},"48":{"start":{"line":92,"column":32},"end":{"line":92,"column":56}},"49":{"start":{"line":98,"column":12},"end":{"line":100,"column":14}},"50":{"start":{"line":99,"column":16},"end":{"line":99,"column":52}}},"fnMap":{"0":{"name":"getInvoiceId","decl":{"start":{"line":12,"column":27},"end":{"line":12,"column":39}},"loc":{"start":{"line":12,"column":56},"end":{"line":20,"column":5}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":43},"end":{"line":15,"column":44}},"loc":{"start":{"line":15,"column":63},"end":{"line":19,"column":9}},"line":15},"2":{"name":"createOne","decl":{"start":{"line":21,"column":24},"end":{"line":21,"column":33}},"loc":{"start":{"line":21,"column":44},"end":{"line":71,"column":5}},"line":21},"3":{"name":"(anonymous_3)","decl":{"start":{"line":31,"column":34},"end":{"line":31,"column":35}},"loc":{"start":{"line":31,"column":46},"end":{"line":70,"column":9}},"line":31},"4":{"name":"_callee","decl":{"start":{"line":32,"column":89},"end":{"line":32,"column":96}},"loc":{"start":{"line":32,"column":107},"end":{"line":65,"column":13}},"line":32},"5":{"name":"_callee$","decl":{"start":{"line":33,"column":57},"end":{"line":33,"column":65}},"loc":{"start":{"line":33,"column":76},"end":{"line":64,"column":17}},"line":33},"6":{"name":"(anonymous_6)","decl":{"start":{"line":67,"column":19},"end":{"line":67,"column":20}},"loc":{"start":{"line":67,"column":38},"end":{"line":69,"column":13}},"line":67},"7":{"name":"getOne","decl":{"start":{"line":72,"column":21},"end":{"line":72,"column":27}},"loc":{"start":{"line":72,"column":38},"end":{"line":102,"column":5}},"line":72},"8":{"name":"(anonymous_8)","decl":{"start":{"line":74,"column":55},"end":{"line":74,"column":56}},"loc":{"start":{"line":74,"column":67},"end":{"line":101,"column":9}},"line":74},"9":{"name":"_callee2","decl":{"start":{"line":75,"column":90},"end":{"line":75,"column":98}},"loc":{"start":{"line":75,"column":109},"end":{"line":96,"column":13}},"line":75},"10":{"name":"_callee2$","decl":{"start":{"line":76,"column":57},"end":{"line":76,"column":66}},"loc":{"start":{"line":76,"column":78},"end":{"line":95,"column":17}},"line":76},"11":{"name":"(anonymous_11)","decl":{"start":{"line":98,"column":19},"end":{"line":98,"column":20}},"loc":{"start":{"line":98,"column":39},"end":{"line":100,"column":13}},"line":98}},"branchMap":{"0":{"loc":{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},"type":"if","locations":[{"start":{"line":16,"column":12},"end":{"line":16,"column":123}},{"start":{"line":16,"column":12},"end":{"line":16,"column":123}}],"line":16},"1":{"loc":{"start":{"line":35,"column":24},"end":{"line":62,"column":25}},"type":"switch","locations":[{"start":{"line":36,"column":28},"end":{"line":42,"column":159}},{"start":{"line":44,"column":28},"end":{"line":47,"column":123}},{"start":{"line":49,"column":28},"end":{"line":52,"column":38}},{"start":{"line":54,"column":28},"end":{"line":57,"column":150}},{"start":{"line":59,"column":28},"end":{"line":59,"column":36}},{"start":{"line":60,"column":28},"end":{"line":61,"column":55}}],"line":35},"2":{"loc":{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},"type":"if","locations":[{"start":{"line":37,"column":32},"end":{"line":40,"column":33}},{"start":{"line":37,"column":32},"end":{"line":40,"column":33}}],"line":37},"3":{"loc":{"start":{"line":78,"column":24},"end":{"line":93,"column":25}},"type":"switch","locations":[{"start":{"line":79,"column":28},"end":{"line":85,"column":144}},{"start":{"line":87,"column":28},"end":{"line":88,"column":71}},{"start":{"line":90,"column":28},"end":{"line":90,"column":35}},{"start":{"line":91,"column":28},"end":{"line":92,"column":56}}],"line":78},"4":{"loc":{"start":{"line":80,"column":32},"end":{"line":83,"column":33}},"type":"if","locations":[{"start":{"line":80,"column":32},"end":{"line":83,"column":33}},{"start":{"line":80,"column":32},"end":{"line":83,"column":33}}],"line":80}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0},"b":{"0":[0,0],"1":[0,0,0,0,0,0],"2":[0,0],"3":[0,0,0,0],"4":[0,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.controller.js"],"names":["DisputeModel","InvoiceModel","generateController","sendDisputeMail","DisputeController","getInvoiceId","req","res","next","_id","params","invoiceId","findOne","err","doc","status","send","error","message","success","invoice","createOne","body","marchantEmail","customerEmail","customerName","create","reason","from","data","getOne"],"mappings":";;;;;AAAA,OAAOA,YAAP,MAAyB,iBAAzB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,OAAOC,kBAAP,MAA+B,kCAA/B;AACA,SAASC,eAAT,QAAgC,sBAAhC;;AAEA,IAAMC,oBAAoBF,mBAAmBF,YAAnB,EAAiC;AACvDK,kBAAc,sBAACC,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAoB;AAC9B,YAAMC,MAAMH,IAAII,MAAJ,CAAWC,SAAvB;;AAEAV,qBAAaW,OAAb,CAAqB,EAAEH,QAAF,EAArB,EAA8B,UAACI,GAAD,EAAMC,GAAN,EAAc;AACxC,gBAAID,GAAJ,EAAS,OAAON,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,gCAAX,EAAT,EAAwDC,SAAS,KAAjE,EAArB,CAAP;AACTb,gBAAIc,OAAJ,GAAcN,GAAd;AACAN;AACH,SAJD;AAKH,KATsD;AAUvDa,eAAW,mBAACf,GAAD,EAAMC,GAAN,EAAc;AACrB,YAAMe,OAAOhB,IAAIgB,IAAjB;AADqB,2BAEuChB,IAAIc,OAF3C;AAAA,YAEbG,aAFa,gBAEbA,aAFa;AAAA,YAEEC,aAFF,gBAEEA,aAFF;AAAA,YAEiBC,YAFjB,gBAEiBA,YAFjB;AAAA,YAE+BhB,GAF/B,gBAE+BA,GAF/B;;AAGrBa,aAAKP,MAAL,GAAc,MAAd;AACAO,aAAKX,SAAL,GAAiBF,GAAjB;AACAT,qBAAa0B,MAAb,CAAoBJ,IAApB;AAAA,gFAA0B,iBAAOT,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,qCAClBD,GADkB;AAAA;AAAA;AAAA;;AAAA,iEACNN,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,8BAAX,EAAT,EAAsDC,SAAS,KAA/D,EAArB,CADM;;AAAA;AAAA;AAAA;AAAA,uCAIZhB,gBAAgBoB,aAAhB,EAA+BC,aAA/B,EAA8CC,YAA9C,EAA4DH,KAAKK,MAAjE,EAAyEL,KAAKM,IAA9E,CAJY;;AAAA;AAKlBrB,oCAAIS,IAAJ,CAAS,EAAEa,MAAMf,GAAR,EAAaK,SAAS,IAAtB,EAAT;AALkB;AAAA;;AAAA;AAAA;AAAA;AAAA,iEAOXZ,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,qBAAX,EAAT,EAA6CC,SAAS,KAAtD,EAArB,CAPW;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAA1B;;AAAA;AAAA;AAAA;AAAA;AAUH,KAzBsD;AA0BvDW,YAAQ,gBAACxB,GAAD,EAAMC,GAAN,EAAc;AAClB,YAAMI,YAAYL,IAAII,MAAJ,CAAWC,SAA7B;AACAX,qBAAaY,OAAb,CAAqB,EAAED,oBAAF,EAArB;AAAA,iFAAoC,kBAAOE,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AAAA,qCAC5BD,GAD4B;AAAA;AAAA;AAAA;;AAAA,kEAChBN,IAAIQ,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,OAAO,EAAEC,SAAS,cAAX,EAAT,EAAsCC,SAAS,KAA/C,EAArB,CADgB;;AAAA;AAEhCZ,oCAAIS,IAAJ,CAAS,EAAEa,MAAMf,GAAR,EAAaK,SAAS,IAAtB,EAAT;;AAFgC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aAApC;;AAAA;AAAA;AAAA;AAAA;AAIH;AAhCsD,CAAjC,CAA1B;;AAmCA,eAAef,iBAAf","file":"dispute.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import DisputeModel from './dispute.model';\nimport InvoiceModel from '../invoice/invoice.model';\nimport generateController from '../../modules/generateController';\nimport { sendDisputeMail } from '../../modules/mailer';\n\nconst DisputeController = generateController(DisputeModel, {\n    getInvoiceId: (req, res, next) => {\n        const _id = req.params.invoiceId;\n\n        InvoiceModel.findOne({ _id }, (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Invoice with id does not exits' }, success: false });\n            req.invoice = doc;\n            next()\n        });\n    },\n    createOne: (req, res) => {\n        const body = req.body;\n        const { marchantEmail, customerEmail, customerName, _id } = req.invoice;\n        body.status = \"open\";\n        body.invoiceId = _id;\n        DisputeModel.create(body, async (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Could not create the dispute' }, success: false });\n\n            try {\n                await sendDisputeMail(marchantEmail, customerEmail, customerName, body.reason, body.from);\n                res.send({ data: doc, success: true });\n            } catch (err) {\n                return res.status(400).send({ error: { message: 'Could not send mail' }, success: false });\n            }\n        });\n    },\n    getOne: (req, res) => {\n        const invoiceId = req.params.invoiceId;\n        DisputeModel.findOne({ invoiceId }, async (err, doc) => {\n            if (err) return res.status(400).send({ error: { message: 'Find dispute' }, success: false });\n            res.send({ data: doc, success: true });\n        });\n    }\n});\n\nexport default DisputeController;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"a9bd1131caf8e1ac1905da55b3cbb9d278c1f65f"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/verify/verify.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/verify/verify.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":10,"column":13},"end":{"line":10,"column":29}},"2":{"start":{"line":12,"column":0},"end":{"line":12,"column":58}},"3":{"start":{"line":14,"column":0},"end":{"line":49,"column":5}},"4":{"start":{"line":15,"column":15},"end":{"line":44,"column":7}},"5":{"start":{"line":18,"column":8},"end":{"line":43,"column":37}},"6":{"start":{"line":19,"column":12},"end":{"line":42,"column":13}},"7":{"start":{"line":20,"column":16},"end":{"line":41,"column":17}},"8":{"start":{"line":22,"column":24},"end":{"line":22,"column":133}},"9":{"start":{"line":23,"column":24},"end":{"line":23,"column":42}},"10":{"start":{"line":24,"column":24},"end":{"line":24,"column":42}},"11":{"start":{"line":25,"column":24},"end":{"line":25,"column":88}},"12":{"start":{"line":28,"column":24},"end":{"line":28,"column":52}},"13":{"start":{"line":29,"column":24},"end":{"line":29,"column":43}},"14":{"start":{"line":30,"column":24},"end":{"line":30,"column":30}},"15":{"start":{"line":33,"column":24},"end":{"line":33,"column":42}},"16":{"start":{"line":34,"column":24},"end":{"line":34,"column":59}},"17":{"start":{"line":36,"column":24},"end":{"line":36,"column":84}},"18":{"start":{"line":40,"column":24},"end":{"line":40,"column":47}},"19":{"start":{"line":46,"column":4},"end":{"line":48,"column":6}},"20":{"start":{"line":47,"column":8},"end":{"line":47,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":14,"column":32},"end":{"line":14,"column":33}},"loc":{"start":{"line":14,"column":44},"end":{"line":49,"column":1}},"line":14},"1":{"name":"_callee","decl":{"start":{"line":15,"column":81},"end":{"line":15,"column":88}},"loc":{"start":{"line":15,"column":99},"end":{"line":44,"column":5}},"line":15},"2":{"name":"_callee$","decl":{"start":{"line":18,"column":49},"end":{"line":18,"column":57}},"loc":{"start":{"line":18,"column":68},"end":{"line":43,"column":9}},"line":18},"3":{"name":"(anonymous_3)","decl":{"start":{"line":46,"column":11},"end":{"line":46,"column":12}},"loc":{"start":{"line":46,"column":30},"end":{"line":48,"column":5}},"line":46}},"branchMap":{"0":{"loc":{"start":{"line":20,"column":16},"end":{"line":41,"column":17}},"type":"switch","locations":[{"start":{"line":21,"column":20},"end":{"line":25,"column":88}},{"start":{"line":27,"column":20},"end":{"line":30,"column":30}},{"start":{"line":32,"column":20},"end":{"line":36,"column":84}},{"start":{"line":38,"column":20},"end":{"line":38,"column":28}},{"start":{"line":39,"column":20},"end":{"line":40,"column":47}}],"line":20}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":1,"20":0},"f":{"0":1,"1":0,"2":0,"3":0},"b":{"0":[0,0,0,0,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/verify/verify.route.js"],"names":["express","DisputeController","sendCustormerVerificationCode","Router","param","getInvoiceId","route","get","req","res","invoice","customerEmail","verifyCode","send","success","status","error"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,+BAA9B;AACA,SAASC,6BAAT,QAA8C,sBAA9C;;AAEA,IAAMC,SAASH,QAAQG,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,WAAb,EAA0BH,kBAAkBI,YAA5C;;AAEAF,OAAOG,KAAP,CAAa,aAAb,EACKC,GADL;AAAA,wEACS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,uCACqCD,IAAIE,OADzC,EACOC,aADP,gBACOA,aADP,EACsBC,UADtB,gBACsBA,UADtB;AAAA;AAAA;AAAA,+BAISV,8BAA8BS,aAA9B,EAA6CC,UAA7C,CAJT;;AAAA;AAKGH,4BAAII,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAT;AALH;AAAA;;AAAA;AAAA;AAAA;;AAOGL,4BAAIM,MAAJ,CAAW,GAAX,EAAgBF,IAAhB,CAAqB,EAAEE,QAAQ,KAAV,EAAiBC,kBAAjB,EAArB;;AAPH;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAYA,eAAeb,MAAf","file":"verify.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport DisputeController from '../dispute/dispute.controller';\nimport { sendCustormerVerificationCode } from '../../modules/mailer';\n\nconst Router = express.Router();\n\nRouter.param('invoiceId', DisputeController.getInvoiceId);\n\nRouter.route('/:invoiceId')\n    .get(async (req, res) => {\n        const { customerEmail, verifyCode } = req.invoice;\n\n        try {\n            await sendCustormerVerificationCode(customerEmail, verifyCode);\n            res.send({ success: true });\n        } catch (error) {\n            res.status(400).send({ status: false, error });\n        }\n    });\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"3e3ed174ba3cd9b8a308e49b5f7e7635103460b0"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/request/request.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/request/request.route.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":10,"column":13},"end":{"line":10,"column":29}},"2":{"start":{"line":12,"column":0},"end":{"line":74,"column":5}},"3":{"start":{"line":13,"column":15},"end":{"line":69,"column":7}},"4":{"start":{"line":16,"column":8},"end":{"line":68,"column":38}},"5":{"start":{"line":17,"column":12},"end":{"line":67,"column":13}},"6":{"start":{"line":18,"column":16},"end":{"line":66,"column":17}},"7":{"start":{"line":20,"column":24},"end":{"line":20,"column":123}},"8":{"start":{"line":21,"column":24},"end":{"line":21,"column":42}},"9":{"start":{"line":22,"column":24},"end":{"line":22,"column":42}},"10":{"start":{"line":23,"column":24},"end":{"line":23,"column":72}},"11":{"start":{"line":26,"column":24},"end":{"line":26,"column":46}},"12":{"start":{"line":27,"column":24},"end":{"line":27,"column":54}},"13":{"start":{"line":28,"column":24},"end":{"line":28,"column":60}},"14":{"start":{"line":29,"column":24},"end":{"line":29,"column":58}},"15":{"start":{"line":30,"column":24},"end":{"line":33,"column":124}},"16":{"start":{"line":31,"column":38},"end":{"line":31,"column":47}},"17":{"start":{"line":32,"column":28},"end":{"line":32,"column":55}},"18":{"start":{"line":35,"column":24},"end":{"line":38,"column":25}},"19":{"start":{"line":36,"column":28},"end":{"line":36,"column":47}},"20":{"start":{"line":37,"column":28},"end":{"line":37,"column":34}},"21":{"start":{"line":40,"column":24},"end":{"line":40,"column":43}},"22":{"start":{"line":41,"column":24},"end":{"line":41,"column":90}},"23":{"start":{"line":44,"column":24},"end":{"line":44,"column":64}},"24":{"start":{"line":45,"column":24},"end":{"line":45,"column":43}},"25":{"start":{"line":46,"column":24},"end":{"line":46,"column":30}},"26":{"start":{"line":49,"column":24},"end":{"line":49,"column":115}},"27":{"start":{"line":52,"column":24},"end":{"line":52,"column":43}},"28":{"start":{"line":53,"column":24},"end":{"line":53,"column":30}},"29":{"start":{"line":56,"column":24},"end":{"line":56,"column":43}},"30":{"start":{"line":57,"column":24},"end":{"line":57,"column":59}},"31":{"start":{"line":59,"column":24},"end":{"line":59,"column":48}},"32":{"start":{"line":60,"column":24},"end":{"line":60,"column":66}},"33":{"start":{"line":60,"column":41},"end":{"line":60,"column":66}},"34":{"start":{"line":61,"column":24},"end":{"line":61,"column":102}},"35":{"start":{"line":61,"column":41},"end":{"line":61,"column":102}},"36":{"start":{"line":65,"column":24},"end":{"line":65,"column":47}},"37":{"start":{"line":71,"column":4},"end":{"line":73,"column":6}},"38":{"start":{"line":72,"column":8},"end":{"line":72,"column":43}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":45},"end":{"line":12,"column":46}},"loc":{"start":{"line":12,"column":57},"end":{"line":74,"column":1}},"line":12},"1":{"name":"_callee","decl":{"start":{"line":13,"column":81},"end":{"line":13,"column":88}},"loc":{"start":{"line":13,"column":99},"end":{"line":69,"column":5}},"line":13},"2":{"name":"_callee$","decl":{"start":{"line":16,"column":49},"end":{"line":16,"column":57}},"loc":{"start":{"line":16,"column":68},"end":{"line":68,"column":9}},"line":16},"3":{"name":"(anonymous_3)","decl":{"start":{"line":30,"column":63},"end":{"line":30,"column":64}},"loc":{"start":{"line":30,"column":80},"end":{"line":33,"column":25}},"line":30},"4":{"name":"(anonymous_4)","decl":{"start":{"line":71,"column":11},"end":{"line":71,"column":12}},"loc":{"start":{"line":71,"column":30},"end":{"line":73,"column":5}},"line":71}},"branchMap":{"0":{"loc":{"start":{"line":18,"column":16},"end":{"line":66,"column":17}},"type":"switch","locations":[{"start":{"line":19,"column":20},"end":{"line":23,"column":72}},{"start":{"line":25,"column":20},"end":{"line":41,"column":90}},{"start":{"line":43,"column":20},"end":{"line":46,"column":30}},{"start":{"line":48,"column":20},"end":{"line":49,"column":115}},{"start":{"line":51,"column":20},"end":{"line":53,"column":30}},{"start":{"line":55,"column":20},"end":{"line":61,"column":102}},{"start":{"line":63,"column":20},"end":{"line":63,"column":28}},{"start":{"line":64,"column":20},"end":{"line":65,"column":47}}],"line":18},"1":{"loc":{"start":{"line":35,"column":24},"end":{"line":38,"column":25}},"type":"if","locations":[{"start":{"line":35,"column":24},"end":{"line":38,"column":25}},{"start":{"line":35,"column":24},"end":{"line":38,"column":25}}],"line":35},"2":{"loc":{"start":{"line":35,"column":30},"end":{"line":35,"column":58}},"type":"binary-expr","locations":[{"start":{"line":35,"column":30},"end":{"line":35,"column":39}},{"start":{"line":35,"column":43},"end":{"line":35,"column":58}}],"line":35},"3":{"loc":{"start":{"line":60,"column":24},"end":{"line":60,"column":66}},"type":"if","locations":[{"start":{"line":60,"column":24},"end":{"line":60,"column":66}},{"start":{"line":60,"column":24},"end":{"line":60,"column":66}}],"line":60},"4":{"loc":{"start":{"line":61,"column":24},"end":{"line":61,"column":102}},"type":"if","locations":[{"start":{"line":61,"column":24},"end":{"line":61,"column":102}},{"start":{"line":61,"column":24},"end":{"line":61,"column":102}}],"line":61}},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":1,"38":0},"f":{"0":1,"1":0,"2":0,"3":0,"4":0},"b":{"0":[0,0,0,0,0,0,0,0],"1":[0,0],"2":[0,0],"3":[0,0],"4":[0,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/request/request.route.js"],"names":["express","InvoiceModel","sendPaymentRequest","Router","route","get","req","res","params","invoiceId","milestoneId","findOne","_id","milestones","customerEmail","marchantName","filter","milestone","paid","status","send","success","error","message","console","log"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,YAAP,MAAyB,0BAAzB;AACA,SAASC,kBAAT,QAAmC,sBAAnC;AACA,IAAMC,SAASH,QAAQG,MAAR,EAAf;;AAGAA,OAAOC,KAAP,CAAa,0BAAb,EACKC,GADL;AAAA,wEACS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,sCACkCD,IAAIE,MADtC,EACOC,SADP,eACOA,SADP,EACkBC,WADlB,eACkBA,WADlB;AAAA;AAAA;AAAA,+BAI6DT,aAAaU,OAAb,CAAqB,EAAEC,KAAKH,SAAP,EAArB,CAJ7D;;AAAA;AAAA;AAIWI,kCAJX,SAIWA,UAJX;AAIuBC,qCAJvB,SAIuBA,aAJvB;AAIsCC,oCAJtC,SAIsCA,YAJtC;AAAA,6CAKyBF,WAAWG,MAAX,CAAkB;AAAA,gCAAGJ,GAAH,SAAGA,GAAH;AAAA,mCAAaA,QAAQF,WAArB;AAAA,yBAAlB,CALzB,+DAKWO,SALX;;AAAA,8BAOOA,aAAa,CAACA,UAAUC,IAP/B;AAAA;AAAA;AAAA;;AAAA;AAAA,+BAQahB,mBAAmBe,SAAnB,EAA8BH,aAA9B,EAA6CC,YAA7C,CARb;;AAAA;AASOR,4BAAIY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,IAAX,EAArB;AATP;AAAA;;AAAA;AAWOd,4BAAIY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,OAAO,EAAEC,SAAS,4BAAX,EAAzB,EAArB;;AAXP;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAcGC,gCAAQC,GAAR,CAAY,UAAZ;AACA,yCAASD,QAAQC,GAAR;AACT,yCAASlB,IAAIY,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBC,kBAAlB,EAArB;;AAhBZ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAsBA,eAAenB,MAAf","file":"request.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport InvoiceModel from '../invoice/invoice.model';\nimport { sendPaymentRequest } from '../../modules/mailer';\nconst Router = express.Router();\n\n\nRouter.route('/:invoiceId/:milestoneId')\n    .get(async (req, res) => {\n        const { invoiceId, milestoneId } = req.params;\n        \n        try {\n            const { milestones, customerEmail, marchantName } = await InvoiceModel.findOne({ _id: invoiceId });\n            const [ milestone ] = milestones.filter(({ _id }) => _id !== milestoneId);\n\n            if (milestone && !milestone.paid) {\n                await sendPaymentRequest(milestone, customerEmail, marchantName);\n                res.status(200).send({ success: true });\n            } else {\n                res.status(400).send({ success: false, error: { message: 'Milestone already paid for' } });\n            }\n        } catch(err) {\n            console.log('error...');\n            if (err) console.log(err);\n            if (err) res.status(400).send({ success: false, error: err});\n        }\n\n    });\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"0b7c2371048066ac5e3aa3a01549dee8cf7f4be3"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/recode.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/recode.js","statementMap":{"0":{"start":{"line":1,"column":18},"end":{"line":3,"column":1}},"1":{"start":{"line":2,"column":2},"end":{"line":2,"column":77}},"2":{"start":{"line":4,"column":16},"end":{"line":6,"column":1}},"3":{"start":{"line":5,"column":2},"end":{"line":5,"column":39}},"4":{"start":{"line":8,"column":2},"end":{"line":8,"column":102}}},"fnMap":{"0":{"name":"randomAlpha","decl":{"start":{"line":1,"column":27},"end":{"line":1,"column":38}},"loc":{"start":{"line":1,"column":41},"end":{"line":3,"column":1}},"line":1},"1":{"name":"randomNum","decl":{"start":{"line":4,"column":25},"end":{"line":4,"column":34}},"loc":{"start":{"line":4,"column":37},"end":{"line":6,"column":1}},"line":4},"2":{"name":"(anonymous_2)","decl":{"start":{"line":7,"column":16},"end":{"line":7,"column":17}},"loc":{"start":{"line":7,"column":28},"end":{"line":9,"column":1}},"line":7}},"branchMap":{},"s":{"0":1,"1":0,"2":1,"3":0,"4":0},"f":{"0":0,"1":0,"2":0},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/modules/recode.js"],"names":["randomAlpha","charAt","Math","floor","random","randomNum"],"mappings":"AAAA,IAAMA,cAAc,SAAdA,WAAc;AAAA,SAAM,6BAA6BC,MAA7B,CAAoCC,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,EAA3B,CAApC,CAAN;AAAA,CAApB;AACA,IAAMC,YAAY,SAAZA,SAAY;AAAA,SAAMH,KAAKC,KAAL,CAAWD,KAAKE,MAAL,KAAgB,CAA3B,CAAN;AAAA,CAAlB;AACA,gBAAe;AAAA,cAASJ,aAAT,GAAyBK,WAAzB,GAAuCL,aAAvC,GAAuDK,WAAvD,GAAqEL,aAArE,GAAqFK,WAArF;AAAA,CAAf","file":"recode.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["const randomAlpha = () => 'abcdefghijklmnopqrstuvwxyz'.charAt(Math.floor(Math.random() * 26));\nconst randomNum = () => Math.floor(Math.random() * 9);\nexport default () => `${randomAlpha()}${randomNum()}${randomAlpha()}${randomNum()}${randomAlpha()}${randomNum()}`;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"47f253a3eb59465b9854042bc101bde93416092e"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/invoice.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/invoice.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":9,"column":13},"end":{"line":9,"column":40}},"2":{"start":{"line":11,"column":21},"end":{"line":27,"column":1}},"3":{"start":{"line":12,"column":15},"end":{"line":12,"column":24}},"4":{"start":{"line":13,"column":16},"end":{"line":13,"column":26}},"5":{"start":{"line":14,"column":16},"end":{"line":14,"column":26}},"6":{"start":{"line":15,"column":4},"end":{"line":26,"column":7}},"7":{"start":{"line":16,"column":8},"end":{"line":25,"column":11}},"8":{"start":{"line":21,"column":23},"end":{"line":21,"column":33}},"9":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"10":{"start":{"line":23,"column":21},"end":{"line":23,"column":33}},"11":{"start":{"line":24,"column":12},"end":{"line":24,"column":26}},"12":{"start":{"line":29,"column":27},"end":{"line":73,"column":1}},"13":{"start":{"line":30,"column":21},"end":{"line":30,"column":91}},"14":{"start":{"line":31,"column":4},"end":{"line":72,"column":9}},"15":{"start":{"line":32,"column":20},"end":{"line":67,"column":11}},"16":{"start":{"line":35,"column":12},"end":{"line":66,"column":31}},"17":{"start":{"line":36,"column":16},"end":{"line":65,"column":17}},"18":{"start":{"line":37,"column":20},"end":{"line":64,"column":21}},"19":{"start":{"line":39,"column":28},"end":{"line":39,"column":46}},"20":{"start":{"line":40,"column":28},"end":{"line":40,"column":60}},"21":{"start":{"line":43,"column":28},"end":{"line":43,"column":50}},"22":{"start":{"line":44,"column":28},"end":{"line":44,"column":69}},"23":{"start":{"line":45,"column":28},"end":{"line":45,"column":62}},"24":{"start":{"line":48,"column":28},"end":{"line":59,"column":31}},"25":{"start":{"line":55,"column":43},"end":{"line":55,"column":53}},"26":{"start":{"line":57,"column":32},"end":{"line":57,"column":53}},"27":{"start":{"line":57,"column":41},"end":{"line":57,"column":53}},"28":{"start":{"line":58,"column":32},"end":{"line":58,"column":46}},"29":{"start":{"line":63,"column":28},"end":{"line":63,"column":51}},"30":{"start":{"line":69,"column":8},"end":{"line":71,"column":10}},"31":{"start":{"line":70,"column":12},"end":{"line":70,"column":48}}},"fnMap":{"0":{"name":"CreateCustomer","decl":{"start":{"line":11,"column":30},"end":{"line":11,"column":44}},"loc":{"start":{"line":11,"column":51},"end":{"line":27,"column":1}},"line":11},"1":{"name":"(anonymous_1)","decl":{"start":{"line":15,"column":24},"end":{"line":15,"column":25}},"loc":{"start":{"line":15,"column":51},"end":{"line":26,"column":5}},"line":15},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":15},"end":{"line":20,"column":16}},"loc":{"start":{"line":20,"column":37},"end":{"line":25,"column":9}},"line":20},"3":{"name":"CreateInvoice","decl":{"start":{"line":29,"column":36},"end":{"line":29,"column":49}},"loc":{"start":{"line":29,"column":81},"end":{"line":73,"column":1}},"line":29},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":24},"end":{"line":31,"column":25}},"loc":{"start":{"line":31,"column":36},"end":{"line":72,"column":5}},"line":31},"5":{"name":"_callee","decl":{"start":{"line":32,"column":86},"end":{"line":32,"column":93}},"loc":{"start":{"line":32,"column":111},"end":{"line":67,"column":9}},"line":32},"6":{"name":"_callee$","decl":{"start":{"line":35,"column":53},"end":{"line":35,"column":61}},"loc":{"start":{"line":35,"column":72},"end":{"line":66,"column":13}},"line":35},"7":{"name":"(anonymous_7)","decl":{"start":{"line":54,"column":35},"end":{"line":54,"column":36}},"loc":{"start":{"line":54,"column":57},"end":{"line":59,"column":29}},"line":54},"8":{"name":"(anonymous_8)","decl":{"start":{"line":69,"column":15},"end":{"line":69,"column":16}},"loc":{"start":{"line":69,"column":35},"end":{"line":71,"column":9}},"line":69}},"branchMap":{"0":{"loc":{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},"type":"if","locations":[{"start":{"line":23,"column":12},"end":{"line":23,"column":33}},{"start":{"line":23,"column":12},"end":{"line":23,"column":33}}],"line":23},"1":{"loc":{"start":{"line":30,"column":21},"end":{"line":30,"column":91}},"type":"cond-expr","locations":[{"start":{"line":30,"column":74},"end":{"line":30,"column":86}},{"start":{"line":30,"column":89},"end":{"line":30,"column":91}}],"line":30},"2":{"loc":{"start":{"line":30,"column":21},"end":{"line":30,"column":71}},"type":"binary-expr","locations":[{"start":{"line":30,"column":21},"end":{"line":30,"column":41}},{"start":{"line":30,"column":45},"end":{"line":30,"column":71}}],"line":30},"3":{"loc":{"start":{"line":37,"column":20},"end":{"line":64,"column":21}},"type":"switch","locations":[{"start":{"line":38,"column":24},"end":{"line":40,"column":60}},{"start":{"line":42,"column":24},"end":{"line":59,"column":31}},{"start":{"line":61,"column":24},"end":{"line":61,"column":31}},{"start":{"line":62,"column":24},"end":{"line":63,"column":51}}],"line":37},"4":{"loc":{"start":{"line":57,"column":32},"end":{"line":57,"column":53}},"type":"if","locations":[{"start":{"line":57,"column":32},"end":{"line":57,"column":53}},{"start":{"line":57,"column":32},"end":{"line":57,"column":53}}],"line":57}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":0,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":2,"18":2,"19":1,"20":1,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":1,"29":1,"30":1,"31":1},"f":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":2,"7":1,"8":1},"b":{"0":[0,1],"1":[1,0],"2":[1,1],"3":[1,1,1,1],"4":[0,1]},"inputSourceMap":{"version":3,"sources":["src/api/modules/invoice.js"],"names":["request","addDays","secret","process","env","PAYSTACK_SECRET","CreateCustomer","name","email","phone","resolve","reject","post","set","send","end","err","body","CreateInvoice","customer","amount","description","line_items","customer_code","data","due_date","Date"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,mBAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;;AAEA,IAAMC,iBAAiB,SAAjBA,cAAiB;AAAA,QAAGC,IAAH,QAAGA,IAAH;AAAA,QAASC,KAAT,QAASA,KAAT;AAAA,QAAgBC,KAAhB,QAAgBA,KAAhB;AAAA,WAA4B,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAChFX,gBACKY,IADL,qCAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACFP,sBADE;AAEFC,wBAFE;AAGFC;AAHE,SAHV,EAQKM,GARL,CAQS,UAACC,GAAD,SAAmB;AAAA,gBAAXC,IAAW,SAAXA,IAAW;;AACpB,gBAAID,GAAJ,EAASL,OAAOK,GAAP;AACTN,oBAAQO,IAAR;AACH,SAXL;AAYH,KAbkD,CAA5B;AAAA,CAAvB;;AAeA,OAAO,IAAMC,gBAAgB,SAAhBA,aAAgB,CAACC,QAAD,EAAWC,MAAX,EAAmBC,WAAnB;AAAA,QAAgCC,UAAhC,uEAA6C,EAA7C;AAAA,WAAoD;AAAA,6EAAY,iBAAOZ,OAAP,EAAgBC,MAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAC/CL,eAAea,QAAf,CAD+C;;AAAA;AAAA;AACzEI,yCADyE,SACjFC,IADiF,CACzED,aADyE;AAEnFE,oCAFmF,GAExExB,QAAQ,IAAIyB,IAAJ,EAAR,EAAoB,CAApB,CAFwE;;;AAIzF1B,oCACKY,IADL,2CAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACFK,0CAAUI,aADR;AAEFF,wDAFE;AAGFD,8CAHE;AAIFE,sDAJE;AAKFG;AALE,6BAHV,EAUKV,GAVL,CAUS,UAACC,GAAD,SAAmB;AAAA,oCAAXC,IAAW,SAAXA,IAAW;;AACpB,oCAAID,GAAJ,EAASL,OAAOK,GAAP;AACTN,wCAAQO,IAAR;AACH,6BAbL;;AAJyF;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAZ;;AAAA;AAAA;AAAA;AAAA,QAApD;AAAA,CAAtB","file":"invoice.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nimport addDays from 'date-fns/add_days';\nconst secret = process.env.PAYSTACK_SECRET;\n\nconst CreateCustomer = ({ name, email, phone }) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/customer`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            name,\n            email,\n            phone\n        })\n        .end((err, { body }) => {\n            if (err) reject(err);\n            resolve(body);\n        });\n});\n\nexport const CreateInvoice = (customer, amount, description, line_items = []) => new Promise(async (resolve, reject) => {\n    const { data: { customer_code } } = await CreateCustomer(customer);\n    const due_date = addDays(new Date(), 7);\n\n    request\n        .post(`https://api.paystack.co/paymentrequest`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            customer: customer_code,\n            description,\n            amount,\n            line_items,\n            due_date\n        })\n        .end((err, { body }) => {\n            if (err) reject(err);\n            resolve(body);\n        });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"ade94eb33072c7a277397b1a542a57f5b5b02a54"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.controller.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":13,"column":19},"end":{"line":137,"column":11}},"2":{"start":{"line":16,"column":12},"end":{"line":136,"column":44}},"3":{"start":{"line":17,"column":16},"end":{"line":135,"column":17}},"4":{"start":{"line":18,"column":20},"end":{"line":134,"column":21}},"5":{"start":{"line":20,"column":28},"end":{"line":20,"column":44}},"6":{"start":{"line":23,"column":28},"end":{"line":23,"column":55}},"7":{"start":{"line":24,"column":28},"end":{"line":24,"column":64}},"8":{"start":{"line":25,"column":28},"end":{"line":25,"column":62}},"9":{"start":{"line":26,"column":28},"end":{"line":26,"column":91}},"10":{"start":{"line":27,"column":28},"end":{"line":27,"column":81}},"11":{"start":{"line":29,"column":28},"end":{"line":29,"column":105}},"12":{"start":{"line":31,"column":28},"end":{"line":45,"column":29}},"13":{"start":{"line":32,"column":32},"end":{"line":32,"column":55}},"14":{"start":{"line":33,"column":32},"end":{"line":33,"column":115}},"15":{"start":{"line":34,"column":32},"end":{"line":34,"column":110}},"16":{"start":{"line":36,"column":32},"end":{"line":36,"column":79}},"17":{"start":{"line":37,"column":32},"end":{"line":40,"column":38}},"18":{"start":{"line":38,"column":49},"end":{"line":38,"column":61}},"19":{"start":{"line":39,"column":36},"end":{"line":39,"column":55}},"20":{"start":{"line":41,"column":32},"end":{"line":41,"column":52}},"21":{"start":{"line":42,"column":32},"end":{"line":42,"column":115}},"22":{"start":{"line":43,"column":32},"end":{"line":43,"column":56}},"23":{"start":{"line":44,"column":32},"end":{"line":44,"column":88}},"24":{"start":{"line":47,"column":28},"end":{"line":47,"column":44}},"25":{"start":{"line":48,"column":28},"end":{"line":48,"column":70}},"26":{"start":{"line":49,"column":28},"end":{"line":49,"column":52}},"27":{"start":{"line":50,"column":28},"end":{"line":50,"column":49}},"28":{"start":{"line":52,"column":28},"end":{"line":60,"column":30}},"29":{"start":{"line":53,"column":32},"end":{"line":59,"column":33}},"30":{"start":{"line":54,"column":36},"end":{"line":54,"column":63}},"31":{"start":{"line":55,"column":39},"end":{"line":59,"column":33}},"32":{"start":{"line":56,"column":36},"end":{"line":56,"column":59}},"33":{"start":{"line":58,"column":36},"end":{"line":58,"column":52}},"34":{"start":{"line":62,"column":28},"end":{"line":62,"column":131}},"35":{"start":{"line":63,"column":28},"end":{"line":63,"column":120}},"36":{"start":{"line":65,"column":28},"end":{"line":77,"column":29}},"37":{"start":{"line":66,"column":32},"end":{"line":66,"column":113}},"38":{"start":{"line":68,"column":32},"end":{"line":68,"column":135}},"39":{"start":{"line":68,"column":58},"end":{"line":68,"column":135}},"40":{"start":{"line":69,"column":32},"end":{"line":69,"column":142}},"41":{"start":{"line":69,"column":61},"end":{"line":69,"column":142}},"42":{"start":{"line":71,"column":32},"end":{"line":75,"column":35}},"43":{"start":{"line":72,"column":54},"end":{"line":72,"column":71}},"44":{"start":{"line":73,"column":49},"end":{"line":73,"column":61}},"45":{"start":{"line":74,"column":36},"end":{"line":74,"column":87}},"46":{"start":{"line":76,"column":32},"end":{"line":76,"column":108}},"47":{"start":{"line":79,"column":28},"end":{"line":79,"column":48}},"48":{"start":{"line":80,"column":28},"end":{"line":80,"column":48}},"49":{"start":{"line":81,"column":28},"end":{"line":81,"column":189}},"50":{"start":{"line":84,"column":28},"end":{"line":84,"column":51}},"51":{"start":{"line":85,"column":28},"end":{"line":85,"column":67}},"52":{"start":{"line":87,"column":28},"end":{"line":87,"column":61}},"53":{"start":{"line":89,"column":28},"end":{"line":120,"column":33}},"54":{"start":{"line":90,"column":44},"end":{"line":115,"column":35}},"55":{"start":{"line":91,"column":36},"end":{"line":114,"column":55}},"56":{"start":{"line":92,"column":40},"end":{"line":113,"column":41}},"57":{"start":{"line":93,"column":44},"end":{"line":112,"column":45}},"58":{"start":{"line":95,"column":52},"end":{"line":98,"column":53}},"59":{"start":{"line":96,"column":56},"end":{"line":96,"column":74}},"60":{"start":{"line":97,"column":56},"end":{"line":97,"column":62}},"61":{"start":{"line":100,"column":52},"end":{"line":100,"column":76}},"62":{"start":{"line":101,"column":52},"end":{"line":101,"column":179}},"63":{"start":{"line":104,"column":52},"end":{"line":104,"column":74}},"64":{"start":{"line":105,"column":52},"end":{"line":105,"column":72}},"65":{"start":{"line":106,"column":52},"end":{"line":106,"column":63}},"66":{"start":{"line":107,"column":52},"end":{"line":107,"column":91}},"67":{"start":{"line":111,"column":52},"end":{"line":111,"column":75}},"68":{"start":{"line":117,"column":32},"end":{"line":119,"column":34}},"69":{"start":{"line":118,"column":36},"end":{"line":118,"column":72}},"70":{"start":{"line":121,"column":28},"end":{"line":121,"column":48}},"71":{"start":{"line":122,"column":28},"end":{"line":122,"column":34}},"72":{"start":{"line":125,"column":28},"end":{"line":125,"column":48}},"73":{"start":{"line":126,"column":28},"end":{"line":126,"column":66}},"74":{"start":{"line":128,"column":28},"end":{"line":128,"column":61}},"75":{"start":{"line":129,"column":28},"end":{"line":129,"column":123}},"76":{"start":{"line":133,"column":28},"end":{"line":133,"column":52}},"77":{"start":{"line":139,"column":8},"end":{"line":141,"column":10}},"78":{"start":{"line":140,"column":12},"end":{"line":140,"column":47}},"79":{"start":{"line":144,"column":20},"end":{"line":182,"column":11}},"80":{"start":{"line":146,"column":12},"end":{"line":181,"column":43}},"81":{"start":{"line":147,"column":16},"end":{"line":180,"column":17}},"82":{"start":{"line":148,"column":20},"end":{"line":179,"column":21}},"83":{"start":{"line":150,"column":28},"end":{"line":153,"column":29}},"84":{"start":{"line":151,"column":32},"end":{"line":151,"column":51}},"85":{"start":{"line":152,"column":32},"end":{"line":152,"column":38}},"86":{"start":{"line":155,"column":28},"end":{"line":155,"column":133}},"87":{"start":{"line":158,"column":28},"end":{"line":158,"column":50}},"88":{"start":{"line":159,"column":28},"end":{"line":159,"column":47}},"89":{"start":{"line":160,"column":28},"end":{"line":160,"column":47}},"90":{"start":{"line":161,"column":28},"end":{"line":161,"column":73}},"91":{"start":{"line":164,"column":28},"end":{"line":164,"column":54}},"92":{"start":{"line":166,"column":28},"end":{"line":166,"column":64}},"93":{"start":{"line":167,"column":28},"end":{"line":167,"column":133}},"94":{"start":{"line":170,"column":28},"end":{"line":170,"column":48}},"95":{"start":{"line":171,"column":28},"end":{"line":171,"column":65}},"96":{"start":{"line":173,"column":28},"end":{"line":173,"column":63}},"97":{"start":{"line":174,"column":28},"end":{"line":174,"column":123}},"98":{"start":{"line":178,"column":28},"end":{"line":178,"column":52}},"99":{"start":{"line":184,"column":8},"end":{"line":186,"column":10}},"100":{"start":{"line":185,"column":12},"end":{"line":185,"column":48}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":15},"end":{"line":12,"column":16}},"loc":{"start":{"line":12,"column":27},"end":{"line":142,"column":5}},"line":12},"1":{"name":"_callee2","decl":{"start":{"line":13,"column":85},"end":{"line":13,"column":93}},"loc":{"start":{"line":13,"column":104},"end":{"line":137,"column":9}},"line":13},"2":{"name":"_callee2$","decl":{"start":{"line":16,"column":53},"end":{"line":16,"column":62}},"loc":{"start":{"line":16,"column":74},"end":{"line":136,"column":13}},"line":16},"3":{"name":"(anonymous_3)","decl":{"start":{"line":37,"column":77},"end":{"line":37,"column":78}},"loc":{"start":{"line":37,"column":98},"end":{"line":40,"column":33}},"line":37},"4":{"name":"reconciliator","decl":{"start":{"line":52,"column":53},"end":{"line":52,"column":66}},"loc":{"start":{"line":52,"column":87},"end":{"line":60,"column":29}},"line":52},"5":{"name":"(anonymous_5)","decl":{"start":{"line":71,"column":65},"end":{"line":71,"column":66}},"loc":{"start":{"line":71,"column":82},"end":{"line":75,"column":33}},"line":71},"6":{"name":"(anonymous_6)","decl":{"start":{"line":89,"column":54},"end":{"line":89,"column":55}},"loc":{"start":{"line":89,"column":66},"end":{"line":120,"column":29}},"line":89},"7":{"name":"_callee","decl":{"start":{"line":90,"column":110},"end":{"line":90,"column":117}},"loc":{"start":{"line":90,"column":128},"end":{"line":115,"column":33}},"line":90},"8":{"name":"_callee$","decl":{"start":{"line":91,"column":77},"end":{"line":91,"column":85}},"loc":{"start":{"line":91,"column":96},"end":{"line":114,"column":37}},"line":91},"9":{"name":"(anonymous_9)","decl":{"start":{"line":117,"column":39},"end":{"line":117,"column":40}},"loc":{"start":{"line":117,"column":59},"end":{"line":119,"column":33}},"line":117},"10":{"name":"createOne","decl":{"start":{"line":139,"column":24},"end":{"line":139,"column":33}},"loc":{"start":{"line":139,"column":43},"end":{"line":141,"column":9}},"line":139},"11":{"name":"(anonymous_11)","decl":{"start":{"line":143,"column":12},"end":{"line":143,"column":13}},"loc":{"start":{"line":143,"column":24},"end":{"line":187,"column":5}},"line":143},"12":{"name":"_callee3","decl":{"start":{"line":144,"column":86},"end":{"line":144,"column":94}},"loc":{"start":{"line":144,"column":105},"end":{"line":182,"column":9}},"line":144},"13":{"name":"_callee3$","decl":{"start":{"line":146,"column":53},"end":{"line":146,"column":62}},"loc":{"start":{"line":146,"column":74},"end":{"line":181,"column":13}},"line":146},"14":{"name":"getAll","decl":{"start":{"line":184,"column":24},"end":{"line":184,"column":30}},"loc":{"start":{"line":184,"column":41},"end":{"line":186,"column":9}},"line":184}},"branchMap":{"0":{"loc":{"start":{"line":18,"column":20},"end":{"line":134,"column":21}},"type":"switch","locations":[{"start":{"line":19,"column":24},"end":{"line":81,"column":189}},{"start":{"line":83,"column":24},"end":{"line":122,"column":34}},{"start":{"line":124,"column":24},"end":{"line":129,"column":123}},{"start":{"line":131,"column":24},"end":{"line":131,"column":32}},{"start":{"line":132,"column":24},"end":{"line":133,"column":52}}],"line":18},"1":{"loc":{"start":{"line":29,"column":46},"end":{"line":29,"column":104}},"type":"cond-expr","locations":[{"start":{"line":29,"column":83},"end":{"line":29,"column":93}},{"start":{"line":29,"column":96},"end":{"line":29,"column":104}}],"line":29},"2":{"loc":{"start":{"line":31,"column":28},"end":{"line":45,"column":29}},"type":"if","locations":[{"start":{"line":31,"column":28},"end":{"line":45,"column":29}},{"start":{"line":31,"column":28},"end":{"line":45,"column":29}}],"line":31},"3":{"loc":{"start":{"line":53,"column":32},"end":{"line":59,"column":33}},"type":"if","locations":[{"start":{"line":53,"column":32},"end":{"line":59,"column":33}},{"start":{"line":53,"column":32},"end":{"line":59,"column":33}}],"line":53},"4":{"loc":{"start":{"line":55,"column":39},"end":{"line":59,"column":33}},"type":"if","locations":[{"start":{"line":55,"column":39},"end":{"line":59,"column":33}},{"start":{"line":55,"column":39},"end":{"line":59,"column":33}}],"line":55},"5":{"loc":{"start":{"line":65,"column":28},"end":{"line":77,"column":29}},"type":"if","locations":[{"start":{"line":65,"column":28},"end":{"line":77,"column":29}},{"start":{"line":65,"column":28},"end":{"line":77,"column":29}}],"line":65},"6":{"loc":{"start":{"line":68,"column":32},"end":{"line":68,"column":135}},"type":"if","locations":[{"start":{"line":68,"column":32},"end":{"line":68,"column":135}},{"start":{"line":68,"column":32},"end":{"line":68,"column":135}}],"line":68},"7":{"loc":{"start":{"line":69,"column":32},"end":{"line":69,"column":142}},"type":"if","locations":[{"start":{"line":69,"column":32},"end":{"line":69,"column":142}},{"start":{"line":69,"column":32},"end":{"line":69,"column":142}}],"line":69},"8":{"loc":{"start":{"line":93,"column":44},"end":{"line":112,"column":45}},"type":"switch","locations":[{"start":{"line":94,"column":48},"end":{"line":101,"column":179}},{"start":{"line":103,"column":48},"end":{"line":107,"column":91}},{"start":{"line":109,"column":48},"end":{"line":109,"column":55}},{"start":{"line":110,"column":48},"end":{"line":111,"column":75}}],"line":93},"9":{"loc":{"start":{"line":95,"column":52},"end":{"line":98,"column":53}},"type":"if","locations":[{"start":{"line":95,"column":52},"end":{"line":98,"column":53}},{"start":{"line":95,"column":52},"end":{"line":98,"column":53}}],"line":95},"10":{"loc":{"start":{"line":148,"column":20},"end":{"line":179,"column":21}},"type":"switch","locations":[{"start":{"line":149,"column":24},"end":{"line":155,"column":133}},{"start":{"line":157,"column":24},"end":{"line":161,"column":73}},{"start":{"line":163,"column":24},"end":{"line":167,"column":133}},{"start":{"line":169,"column":24},"end":{"line":174,"column":123}},{"start":{"line":176,"column":24},"end":{"line":176,"column":32}},{"start":{"line":177,"column":24},"end":{"line":178,"column":52}}],"line":148},"11":{"loc":{"start":{"line":150,"column":28},"end":{"line":153,"column":29}},"type":"if","locations":[{"start":{"line":150,"column":28},"end":{"line":153,"column":29}},{"start":{"line":150,"column":28},"end":{"line":153,"column":29}}],"line":150}},"s":{"0":1,"1":1,"2":1,"3":2,"4":3,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":1,"25":1,"26":1,"27":1,"28":1,"29":2,"30":0,"31":2,"32":0,"33":2,"34":1,"35":1,"36":1,"37":1,"38":1,"39":0,"40":1,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":1,"48":1,"49":1,"50":1,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":2,"58":1,"59":1,"60":1,"61":0,"62":0,"63":1,"64":1,"65":1,"66":1,"67":1,"68":1,"69":1,"70":1,"71":1,"72":0,"73":0,"74":0,"75":0,"76":1,"77":1,"78":1,"79":1,"80":1,"81":3,"82":4,"83":1,"84":1,"85":1,"86":0,"87":1,"88":1,"89":1,"90":1,"91":1,"92":1,"93":1,"94":0,"95":0,"96":0,"97":0,"98":1,"99":1,"100":1},"f":{"0":1,"1":1,"2":2,"3":0,"4":2,"5":0,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":3,"14":1},"b":{"0":[1,1,0,1,1],"1":[1,0],"2":[1,0],"3":[0,2],"4":[0,2],"5":[1,0],"6":[0,1],"7":[0,1],"8":[1,1,1,1],"9":[1,0],"10":[1,1,1,0,0,1],"11":[1,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.controller.js"],"names":["InvoiceModel","recode","generateController","CreateInvoice","createOne","req","res","body","userId","user","sub","marchantEmail","email","marchantName","name","marchantAccountNumber","marchantBankCode","verifyCode","process","env","NODE_ENV","type","bankCharges","pipePayFee","Math","min","purchaseAmount","totalPrice","deliveryAmount","milestones","length","reduce","pv","amount","line_items","customerTotalAmount","customerDeliveryFee","customPipepayFee","reconciliator","who","original","fee","whoPaysDeliveryFee","whoPaysPipepayFee","push","map","description","customerEmail","customerName","phone","customerPhone","request_code","data","invoice_code","create","err","doc","console","log","status","send","error","message","success","save","getAll","find","invoices"],"mappings":"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","file":"invoice.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import InvoiceModel from './invoice.model';\nimport recode from '../../modules/recode';\nimport generateController from '../../modules/generateController';\nimport { CreateInvoice } from '../../modules/invoice';\n\nexport default generateController(InvoiceModel, {\n    createOne: async (req, res) => {\n        var body = req.body;\n\n        body.userId = req.user.sub;        \n        body.marchantEmail = req.user.email;\n        body.marchantName = req.user.name;\n        body.marchantAccountNumber = req.user['custom:account_number'];\n        body.marchantBankCode =  req.user['custom:bank_code'];\n\n        body.verifyCode = process.env.NODE_ENV === 'testing' ? 'AXYZ0000' : recode();\n\n        if (body.type === 'good') {            \n            body.bankCharges = 100;\n            body.pipePayFee = Math.min(((body.purchaseAmount * 5) / 100),  5000) + body.bankCharges;\n            body.totalPrice = body.purchaseAmount + body.deliveryAmount + body.pipePayFee;\n        } else {\n            body.bankCharges = ((body.milestones.length * 50));\n            body.purchaseAmount = body.milestones.reduce((pv, { amount }) => { return amount + pv }, 0);\n            body.purchaseAmount\n            body.pipePayFee = Math.min(((body.purchaseAmount * 5) / 100),  5000) + body.bankCharges;\n            body.deliveryAmount = 0;\n            body.totalPrice =  body.purchaseAmount + body.pipePayFee ;\n        }\n\n        let line_items = [];\n\n        let customerTotalAmount = body.purchaseAmount;\n        let customerDeliveryFee = 0;\n        let customPipepayFee = 0;\n\n        const reconciliator = (who, original, fee) => {\n            if (who === 'both') {\n                return original += (fee / 2);\n            } else if (who === 'buyer') {\n                return original += fee;\n            } else {\n                return original;\n            }\n        }\n\n        customerDeliveryFee = reconciliator(body.whoPaysDeliveryFee, customerDeliveryFee, body.deliveryAmount);\n        customPipepayFee = reconciliator(body.whoPaysPipepayFee, customPipepayFee, body.pipePayFee);\n\n        if (body.type === 'good') {\n            line_items = [{ 'name': 'Purchase Price', 'amount': customerTotalAmount * 100 }];\n\n            if (customPipepayFee > 0) line_items.push({ 'name': 'PipePay Fee', 'amount': customPipepayFee * 100 });\n            if (customerDeliveryFee > 0) line_items.push({ 'name': 'Delivery Fee', 'amount': customerDeliveryFee * 100 });\n        } else  {\n            line_items = body.milestones.map(({ description, amount }) => ({ name: description, amount: amount * 100 }));\n            line_items.push({ 'name': 'PipePay Fee', 'amount':  body.pipePayFee * 100 });\n        }\n\n        try {\n            const { data: { request_code } } = await CreateInvoice({ email: body.customerEmail, name: body.customerName, phone: body.customerPhone }, customerTotalAmount * 100, body.description, line_items);\n            body.invoice_code = request_code;\n\n            InvoiceModel.create(body, async (err, doc) => {\n                if (err) {\n                    console.log(\"err\", err);\n                    return res.status(400).send({ error: { message: 'Could not create the invoice' }, success: false });\n                }\n                delete doc.verifyCode;\n                doc.status = \"sent\";\n                doc.save();\n                res.send({ data: doc, success: true });\n            });\n        } catch(err) {\n            console.log('err', err);\n            return res.status(400).send({ err, success: false });\n        }\n    },\n    getAll: async (req, res) => {\n        if (!req.user) return res.status(403).send({ success: false, error: 'Invalid auth token' });\n        const userId = req.user.sub;\n\n        try {\n            const invoices = await InvoiceModel.find({ userId });\n            console.log({ invoices });\n            return res.status(200).send({ data: { invoices }, success: true });\n        } catch(err) {\n            console.error('err', err);\n            return res.status(400).send({ err, success: false });\n        }\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"847e7338a7cb7d6e6eddeed13cffdfc0b5574a1e"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/invoice/invoice.route.js","statementMap":{"0":{"start":{"line":4,"column":20},"end":{"line":4,"column":36}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":57}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":89}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":94}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/invoice/invoice.route.js"],"names":["express","InvoiceController","InvoiceRouter","Router","param","findByParam","route","get","getAll","post","createOne","getOne","delete","deleteOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;;AAEA,IAAMC,gBAAgBF,QAAQG,MAAR,EAAtB;;AAEAD,cAAcE,KAAd,CAAoB,IAApB,EAA0BH,kBAAkBI,WAA5C;;AAEAH,cAAcI,KAAd,CAAoB,GAApB,EACKC,GADL,CACSN,kBAAkBO,MAD3B,EAEKC,IAFL,CAEUR,kBAAkBS,SAF5B;;AAIAR,cAAcI,KAAd,CAAoB,MAApB,EACKC,GADL,CACSN,kBAAkBU,MAD3B,EAEKC,MAFL,CAEYX,kBAAkBY,SAF9B;;AAIA,eAAeX,aAAf","file":"invoice.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport InvoiceController from './invoice.controller';\n\nconst InvoiceRouter = express.Router();\n\nInvoiceRouter.param('id', InvoiceController.findByParam);\n\nInvoiceRouter.route('/')\n    .get(InvoiceController.getAll)\n    .post(InvoiceController.createOne);\n\nInvoiceRouter.route('/:id')\n    .get(InvoiceController.getOne)\n    .delete(InvoiceController.deleteOne);\n\nexport default InvoiceRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"bb6a13ce55f8fb34e3014e7f7c9c94307cfc819a"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.model.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.model.js","statementMap":{"0":{"start":{"line":3,"column":20},"end":{"line":9,"column":2}}},"fnMap":{},"branchMap":{},"s":{"0":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.model.js"],"names":["mongoose","PaymentSchema","Schema","marchantEmail","String","customerEmail","amount","Number","invoiceId","reference","model"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;;AAEA,IAAMC,gBAAgB,IAAID,SAASE,MAAb,CAAoB;AACtCC,mBAAeC,MADuB;AAEtCC,mBAAeD,MAFuB;AAGtCE,YAAQC,MAH8B;AAItCC,eAAWJ,MAJ2B;AAKtCK,eAAWL;AAL2B,CAApB,CAAtB;;AAQA,eAAeJ,SAASU,KAAT,CAAe,SAAf,EAA0BT,aAA1B,CAAf","file":"payment.model.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose';\n\nconst PaymentSchema = new mongoose.Schema({\n    marchantEmail: String,\n    customerEmail: String,\n    amount: Number,\n    invoiceId: String,\n    reference: String\n});\n\nexport default mongoose.model('Payment', PaymentSchema);"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"9e15a13fd93cf962a8c5c8090d8e6bb47055ee25"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/transfer.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/transfer.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":8,"column":13},"end":{"line":8,"column":40}},"2":{"start":{"line":10,"column":17},"end":{"line":28,"column":1}},"3":{"start":{"line":11,"column":4},"end":{"line":27,"column":7}},"4":{"start":{"line":12,"column":8},"end":{"line":26,"column":11}},"5":{"start":{"line":19,"column":23},"end":{"line":19,"column":32}},"6":{"start":{"line":21,"column":12},"end":{"line":24,"column":13}},"7":{"start":{"line":22,"column":16},"end":{"line":22,"column":41}},"8":{"start":{"line":23,"column":16},"end":{"line":23,"column":28}},"9":{"start":{"line":25,"column":12},"end":{"line":25,"column":26}},"10":{"start":{"line":30,"column":19},"end":{"line":47,"column":1}},"11":{"start":{"line":31,"column":4},"end":{"line":46,"column":7}},"12":{"start":{"line":32,"column":8},"end":{"line":45,"column":11}},"13":{"start":{"line":38,"column":23},"end":{"line":38,"column":33}},"14":{"start":{"line":40,"column":12},"end":{"line":43,"column":13}},"15":{"start":{"line":41,"column":16},"end":{"line":41,"column":41}},"16":{"start":{"line":42,"column":16},"end":{"line":42,"column":28}},"17":{"start":{"line":44,"column":12},"end":{"line":44,"column":26}},"18":{"start":{"line":49,"column":15},"end":{"line":109,"column":1}},"19":{"start":{"line":50,"column":4},"end":{"line":108,"column":9}},"20":{"start":{"line":51,"column":20},"end":{"line":103,"column":11}},"21":{"start":{"line":54,"column":12},"end":{"line":102,"column":42}},"22":{"start":{"line":55,"column":16},"end":{"line":101,"column":17}},"23":{"start":{"line":56,"column":20},"end":{"line":100,"column":21}},"24":{"start":{"line":58,"column":28},"end":{"line":58,"column":46}},"25":{"start":{"line":59,"column":28},"end":{"line":59,"column":46}},"26":{"start":{"line":60,"column":28},"end":{"line":60,"column":79}},"27":{"start":{"line":63,"column":28},"end":{"line":63,"column":50}},"28":{"start":{"line":64,"column":28},"end":{"line":64,"column":50}},"29":{"start":{"line":65,"column":28},"end":{"line":65,"column":71}},"30":{"start":{"line":67,"column":28},"end":{"line":70,"column":29}},"31":{"start":{"line":68,"column":32},"end":{"line":68,"column":51}},"32":{"start":{"line":69,"column":32},"end":{"line":69,"column":38}},"33":{"start":{"line":72,"column":28},"end":{"line":72,"column":46}},"34":{"start":{"line":73,"column":28},"end":{"line":73,"column":78}},"35":{"start":{"line":76,"column":28},"end":{"line":76,"column":50}},"36":{"start":{"line":77,"column":28},"end":{"line":77,"column":51}},"37":{"start":{"line":79,"column":28},"end":{"line":79,"column":51}},"38":{"start":{"line":79,"column":41},"end":{"line":79,"column":51}},"39":{"start":{"line":80,"column":28},"end":{"line":80,"column":47}},"40":{"start":{"line":81,"column":28},"end":{"line":81,"column":34}},"41":{"start":{"line":84,"column":28},"end":{"line":84,"column":67}},"42":{"start":{"line":87,"column":28},"end":{"line":87,"column":47}},"43":{"start":{"line":88,"column":28},"end":{"line":88,"column":34}},"44":{"start":{"line":91,"column":28},"end":{"line":91,"column":47}},"45":{"start":{"line":92,"column":28},"end":{"line":92,"column":63}},"46":{"start":{"line":94,"column":28},"end":{"line":94,"column":61}},"47":{"start":{"line":95,"column":28},"end":{"line":95,"column":48}},"48":{"start":{"line":99,"column":28},"end":{"line":99,"column":51}},"49":{"start":{"line":105,"column":8},"end":{"line":107,"column":10}},"50":{"start":{"line":106,"column":12},"end":{"line":106,"column":48}}},"fnMap":{"0":{"name":"getReceipt","decl":{"start":{"line":10,"column":26},"end":{"line":10,"column":36}},"loc":{"start":{"line":10,"column":70},"end":{"line":28,"column":1}},"line":10},"1":{"name":"(anonymous_1)","decl":{"start":{"line":11,"column":24},"end":{"line":11,"column":25}},"loc":{"start":{"line":11,"column":51},"end":{"line":27,"column":5}},"line":11},"2":{"name":"(anonymous_2)","decl":{"start":{"line":18,"column":15},"end":{"line":18,"column":16}},"loc":{"start":{"line":18,"column":36},"end":{"line":26,"column":9}},"line":18},"3":{"name":"makeTransfer","decl":{"start":{"line":30,"column":28},"end":{"line":30,"column":40}},"loc":{"start":{"line":30,"column":65},"end":{"line":47,"column":1}},"line":30},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":24},"end":{"line":31,"column":25}},"loc":{"start":{"line":31,"column":51},"end":{"line":46,"column":5}},"line":31},"5":{"name":"(anonymous_5)","decl":{"start":{"line":37,"column":15},"end":{"line":37,"column":16}},"loc":{"start":{"line":37,"column":37},"end":{"line":45,"column":9}},"line":37},"6":{"name":"transfer","decl":{"start":{"line":49,"column":24},"end":{"line":49,"column":32}},"loc":{"start":{"line":49,"column":74},"end":{"line":109,"column":1}},"line":49},"7":{"name":"(anonymous_7)","decl":{"start":{"line":50,"column":24},"end":{"line":50,"column":25}},"loc":{"start":{"line":50,"column":36},"end":{"line":108,"column":5}},"line":50},"8":{"name":"_callee","decl":{"start":{"line":51,"column":86},"end":{"line":51,"column":93}},"loc":{"start":{"line":51,"column":111},"end":{"line":103,"column":9}},"line":51},"9":{"name":"_callee$","decl":{"start":{"line":54,"column":53},"end":{"line":54,"column":61}},"loc":{"start":{"line":54,"column":72},"end":{"line":102,"column":13}},"line":54},"10":{"name":"(anonymous_10)","decl":{"start":{"line":105,"column":15},"end":{"line":105,"column":16}},"loc":{"start":{"line":105,"column":34},"end":{"line":107,"column":9}},"line":105}},"branchMap":{"0":{"loc":{"start":{"line":21,"column":12},"end":{"line":24,"column":13}},"type":"if","locations":[{"start":{"line":21,"column":12},"end":{"line":24,"column":13}},{"start":{"line":21,"column":12},"end":{"line":24,"column":13}}],"line":21},"1":{"loc":{"start":{"line":40,"column":12},"end":{"line":43,"column":13}},"type":"if","locations":[{"start":{"line":40,"column":12},"end":{"line":43,"column":13}},{"start":{"line":40,"column":12},"end":{"line":43,"column":13}}],"line":40},"2":{"loc":{"start":{"line":56,"column":20},"end":{"line":100,"column":21}},"type":"switch","locations":[{"start":{"line":57,"column":24},"end":{"line":60,"column":79}},{"start":{"line":62,"column":24},"end":{"line":73,"column":78}},{"start":{"line":75,"column":24},"end":{"line":81,"column":34}},{"start":{"line":83,"column":24},"end":{"line":84,"column":67}},{"start":{"line":86,"column":24},"end":{"line":88,"column":34}},{"start":{"line":90,"column":24},"end":{"line":95,"column":48}},{"start":{"line":97,"column":24},"end":{"line":97,"column":32}},{"start":{"line":98,"column":24},"end":{"line":99,"column":51}}],"line":56},"3":{"loc":{"start":{"line":67,"column":28},"end":{"line":70,"column":29}},"type":"if","locations":[{"start":{"line":67,"column":28},"end":{"line":70,"column":29}},{"start":{"line":67,"column":28},"end":{"line":70,"column":29}}],"line":67},"4":{"loc":{"start":{"line":67,"column":34},"end":{"line":67,"column":58}},"type":"binary-expr","locations":[{"start":{"line":67,"column":34},"end":{"line":67,"column":40}},{"start":{"line":67,"column":44},"end":{"line":67,"column":58}}],"line":67},"5":{"loc":{"start":{"line":79,"column":28},"end":{"line":79,"column":51}},"type":"if","locations":[{"start":{"line":79,"column":28},"end":{"line":79,"column":51}},{"start":{"line":79,"column":28},"end":{"line":79,"column":51}}],"line":79}},"s":{"0":1,"1":1,"2":1,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":1,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":1,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0,0,0,0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"sources":["src/api/modules/transfer.js"],"names":["request","secret","process","env","PAYSTACK_SECRET","getReceipt","name","account_number","bank_code","resolve","reject","post","set","send","currency","end","err","body","console","log","makeTransfer","recipient_code","amount","recipient","transfer","status","data","Error"],"mappings":";;;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;;AAEA,IAAMC,aAAa,SAAbA,UAAa,CAACC,IAAD,EAAOC,cAAP,EAAuBC,SAAvB;AAAA,WAAqC,aAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACrFV,gBACKW,IADL,8CAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACF,oBAAQ,OADN;AAEFP,sBAFE;AAGFC,0CAHE;AAIFC,gCAJE;AAKFM,sBAAU;AALR,SAHV,EAUKC,GAVL,CAUS,UAACC,GAAD,QAAmB;AAAA,gBAAXC,IAAW,QAAXA,IAAW;;AACpB,gBAAID,GAAJ,EAAS;AACLE,wBAAQC,GAAR,CAAY,MAAZ,EAAmBH,GAAnB;AACAN,uBAAOM,GAAP;AACH;AACDP,oBAAQQ,IAAR;AACH,SAhBL;AAiBH,KAlBuD,CAArC;AAAA,CAAnB;;AAoBA,IAAMG,eAAe,SAAfA,YAAe,CAACC,cAAD,EAAiBC,MAAjB;AAAA,WAA4B,aAAY,UAACb,OAAD,EAAUC,MAAV,EAAqB;AAC9EV,gBACKW,IADL,qCAEKC,GAFL,CAES,eAFT,cAEoCX,MAFpC,EAGKY,IAHL,CAGU;AACF,sBAAU,SADR;AAEFS,0BAFE;AAGFC,uBAAWF,cAHT;AAIFP,sBAAU;AAJR,SAHV,EASKC,GATL,CASS,UAACC,GAAD,SAAmB;AAAA,gBAAXC,IAAW,SAAXA,IAAW;;AACpB,gBAAID,GAAJ,EAAS;AACLE,wBAAQC,GAAR,CAAY,MAAZ,EAAmBH,GAAnB;AACAN,uBAAOM,GAAP;AACH;AACDP,oBAAQQ,IAAR;AACH,SAfL;AAgBH,KAjBgD,CAA5B;AAAA,CAArB;;AAmBA,IAAMO,WAAW,SAAXA,QAAW,CAAClB,IAAD,EAAOC,cAAP,EAAuBC,SAAvB,EAAkCc,MAAlC;AAAA,WAA6C;AAAA,6EAAY,iBAAOb,OAAP,EAAgBC,MAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mCAEdL,WAAWC,IAAX,EAAiBC,cAAjB,EAAiCC,SAAjC,CAFc;;AAAA;AAAA;AAE1DiB,kCAF0D,SAE1DA,MAF0D;AAE1CJ,0CAF0C,SAElDK,IAFkD,CAE1CL,cAF0C;;AAAA,kCAI9DI,UAAUJ,cAJoD;AAAA;AAAA;AAAA;;AAAA;AAAA,mCAKrCD,aAAaC,cAAb,EAA6BC,SAAS,GAAtC,CALqC;;AAAA;AAAA;AAKtDG,mCALsD,SAKtDA,MALsD;;AAM9D,gCAAIA,OAAJ,EAAYhB;AANkD;AAAA;;AAAA;AAQ9DC,mCAAO,IAAIiB,KAAJ,CAAU,mBAAV,CAAP;;AAR8D;AAAA;AAAA;;AAAA;AAAA;AAAA;;AAWlET,oCAAQC,GAAR,CAAY,MAAZ;AACAT;;AAZkE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAZ;;AAAA;AAAA;AAAA;AAAA,QAA7C;AAAA,CAAjB;;AAgBA,eAAec,QAAf","file":"transfer.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nconst secret = process.env.PAYSTACK_SECRET;\n\nconst getReceipt = (name, account_number, bank_code) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/transferrecipient`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            \"type\": \"nuban\",\n            name,\n            account_number,\n            bank_code,\n            currency: 'NGN'\n        })\n        .end((err, { body }) => {\n            if (err) {\n                console.log('err1',err);\n                reject(err);\n            }\n            resolve(body);\n        });\n})\n\nconst makeTransfer = (recipient_code, amount) => new Promise((resolve, reject) => {\n    request\n        .post(`https://api.paystack.co/transfer`)\n        .set(\"Authorization\", `Bearer ${secret}`)\n        .send({\n            \"source\": \"balance\",\n            amount,\n            recipient: recipient_code,\n            currency: 'NGN'\n        })\n        .end((err, { body }) => {\n            if (err) {\n                console.log('err2',err);\n                reject(err);\n            }\n            resolve(body);\n        });\n});\n\nconst transfer = (name, account_number, bank_code, amount) => new Promise(async (resolve, reject) => {\n    try {\n        const { status, data: { recipient_code  } } = await getReceipt(name, account_number, bank_code);\n \n        if (status && recipient_code) {\n            const { status } = await makeTransfer(recipient_code, amount * 100);\n            if (status) resolve();\n        } else {\n            reject(new Error('No recipient_code'));\n        }\n    } catch(err) {\n        console.log('err3',err);\n        reject(err);\n    }\n});\n\nexport default transfer;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"9e998665441fe94a4eea82127e51a1fff59a43f1"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.controller.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.controller.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":15,"column":13},"end":{"line":15,"column":40}},"2":{"start":{"line":19,"column":19},"end":{"line":19,"column":102}},"3":{"start":{"line":20,"column":24},"end":{"line":20,"column":32}},"4":{"start":{"line":21,"column":20},"end":{"line":21,"column":35}},"5":{"start":{"line":22,"column":29},"end":{"line":22,"column":43}},"6":{"start":{"line":23,"column":24},"end":{"line":23,"column":60}},"7":{"start":{"line":24,"column":21},"end":{"line":24,"column":42}},"8":{"start":{"line":25,"column":19},"end":{"line":25,"column":38}},"9":{"start":{"line":26,"column":27},"end":{"line":26,"column":54}},"10":{"start":{"line":27,"column":36},"end":{"line":27,"column":59}},"11":{"start":{"line":28,"column":25},"end":{"line":28,"column":57}},"12":{"start":{"line":29,"column":24},"end":{"line":29,"column":55}},"13":{"start":{"line":30,"column":20},"end":{"line":30,"column":47}},"14":{"start":{"line":33,"column":8},"end":{"line":96,"column":9}},"15":{"start":{"line":34,"column":12},"end":{"line":93,"column":17}},"16":{"start":{"line":35,"column":27},"end":{"line":88,"column":19}},"17":{"start":{"line":38,"column":20},"end":{"line":87,"column":50}},"18":{"start":{"line":39,"column":24},"end":{"line":86,"column":25}},"19":{"start":{"line":40,"column":28},"end":{"line":85,"column":29}},"20":{"start":{"line":42,"column":36},"end":{"line":45,"column":37}},"21":{"start":{"line":43,"column":40},"end":{"line":43,"column":58}},"22":{"start":{"line":44,"column":40},"end":{"line":44,"column":46}},"23":{"start":{"line":47,"column":36},"end":{"line":47,"column":55}},"24":{"start":{"line":48,"column":36},"end":{"line":48,"column":135}},"25":{"start":{"line":51,"column":36},"end":{"line":51,"column":309}},"26":{"start":{"line":52,"column":36},"end":{"line":52,"column":54}},"27":{"start":{"line":54,"column":36},"end":{"line":57,"column":37}},"28":{"start":{"line":55,"column":40},"end":{"line":55,"column":59}},"29":{"start":{"line":56,"column":40},"end":{"line":56,"column":46}},"30":{"start":{"line":59,"column":36},"end":{"line":59,"column":54}},"31":{"start":{"line":60,"column":36},"end":{"line":60,"column":123}},"32":{"start":{"line":63,"column":36},"end":{"line":63,"column":55}},"33":{"start":{"line":64,"column":36},"end":{"line":64,"column":189}},"34":{"start":{"line":67,"column":36},"end":{"line":67,"column":55}},"35":{"start":{"line":68,"column":36},"end":{"line":68,"column":126}},"36":{"start":{"line":71,"column":36},"end":{"line":71,"column":76}},"37":{"start":{"line":72,"column":36},"end":{"line":72,"column":55}},"38":{"start":{"line":73,"column":36},"end":{"line":73,"column":42}},"39":{"start":{"line":76,"column":36},"end":{"line":76,"column":55}},"40":{"start":{"line":77,"column":36},"end":{"line":77,"column":71}},"41":{"start":{"line":79,"column":36},"end":{"line":79,"column":63}},"42":{"start":{"line":80,"column":36},"end":{"line":80,"column":154}},"43":{"start":{"line":84,"column":36},"end":{"line":84,"column":59}},"44":{"start":{"line":90,"column":16},"end":{"line":92,"column":18}},"45":{"start":{"line":91,"column":20},"end":{"line":91,"column":55}},"46":{"start":{"line":95,"column":12},"end":{"line":95,"column":53}},"47":{"start":{"line":99,"column":17},"end":{"line":99,"column":37}},"48":{"start":{"line":100,"column":8},"end":{"line":103,"column":11}},"49":{"start":{"line":101,"column":12},"end":{"line":101,"column":88}},"50":{"start":{"line":101,"column":21},"end":{"line":101,"column":88}},"51":{"start":{"line":102,"column":12},"end":{"line":102,"column":63}}},"fnMap":{"0":{"name":"createOne","decl":{"start":{"line":18,"column":24},"end":{"line":18,"column":33}},"loc":{"start":{"line":18,"column":44},"end":{"line":97,"column":5}},"line":18},"1":{"name":"(anonymous_1)","decl":{"start":{"line":34,"column":119},"end":{"line":34,"column":120}},"loc":{"start":{"line":34,"column":131},"end":{"line":93,"column":13}},"line":34},"2":{"name":"_callee","decl":{"start":{"line":35,"column":93},"end":{"line":35,"column":100}},"loc":{"start":{"line":35,"column":111},"end":{"line":88,"column":17}},"line":35},"3":{"name":"_callee$","decl":{"start":{"line":38,"column":61},"end":{"line":38,"column":69}},"loc":{"start":{"line":38,"column":80},"end":{"line":87,"column":21}},"line":38},"4":{"name":"(anonymous_4)","decl":{"start":{"line":90,"column":23},"end":{"line":90,"column":24}},"loc":{"start":{"line":90,"column":42},"end":{"line":92,"column":17}},"line":90},"5":{"name":"getOne","decl":{"start":{"line":98,"column":21},"end":{"line":98,"column":27}},"loc":{"start":{"line":98,"column":38},"end":{"line":104,"column":5}},"line":98},"6":{"name":"(anonymous_6)","decl":{"start":{"line":100,"column":48},"end":{"line":100,"column":49}},"loc":{"start":{"line":100,"column":68},"end":{"line":103,"column":9}},"line":100}},"branchMap":{"0":{"loc":{"start":{"line":33,"column":8},"end":{"line":96,"column":9}},"type":"if","locations":[{"start":{"line":33,"column":8},"end":{"line":96,"column":9}},{"start":{"line":33,"column":8},"end":{"line":96,"column":9}}],"line":33},"1":{"loc":{"start":{"line":33,"column":12},"end":{"line":33,"column":94}},"type":"binary-expr","locations":[{"start":{"line":33,"column":12},"end":{"line":33,"column":56}},{"start":{"line":33,"column":60},"end":{"line":33,"column":86}},{"start":{"line":33,"column":90},"end":{"line":33,"column":94}}],"line":33},"2":{"loc":{"start":{"line":40,"column":28},"end":{"line":85,"column":29}},"type":"switch","locations":[{"start":{"line":41,"column":32},"end":{"line":48,"column":135}},{"start":{"line":50,"column":32},"end":{"line":60,"column":123}},{"start":{"line":62,"column":32},"end":{"line":64,"column":189}},{"start":{"line":66,"column":32},"end":{"line":68,"column":126}},{"start":{"line":70,"column":32},"end":{"line":73,"column":42}},{"start":{"line":75,"column":32},"end":{"line":80,"column":154}},{"start":{"line":82,"column":32},"end":{"line":82,"column":40}},{"start":{"line":83,"column":32},"end":{"line":84,"column":59}}],"line":40},"3":{"loc":{"start":{"line":42,"column":36},"end":{"line":45,"column":37}},"type":"if","locations":[{"start":{"line":42,"column":36},"end":{"line":45,"column":37}},{"start":{"line":42,"column":36},"end":{"line":45,"column":37}}],"line":42},"4":{"loc":{"start":{"line":54,"column":36},"end":{"line":57,"column":37}},"type":"if","locations":[{"start":{"line":54,"column":36},"end":{"line":57,"column":37}},{"start":{"line":54,"column":36},"end":{"line":57,"column":37}}],"line":54},"5":{"loc":{"start":{"line":101,"column":12},"end":{"line":101,"column":88}},"type":"if","locations":[{"start":{"line":101,"column":12},"end":{"line":101,"column":88}},{"start":{"line":101,"column":12},"end":{"line":101,"column":88}}],"line":101}},"s":{"0":1,"1":1,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":0,"42":0,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},"b":{"0":[0,0],"1":[0,0,0],"2":[0,0,0,0,0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.controller.js"],"names":["crypto","PaymentModel","InvoiceModel","mailer","generateController","Transfer","secret","process","env","PAYSTACK_SECRET","createOne","req","res","hash","createHmac","update","body","digest","event","data","reference","transaction","amount","paid","invoice_code","customer","first_name","last_name","email","headers","findOneAndUpdate","$set","status","new","err","doc","console","error","send","Error","_id","type","whoPaysDeliveryFee","marchantName","marchantEmail","marchantBankCode","deliveryAmount","marchantAccountNumber","create","customerEmail","invoiceId","sendReceiptMail","success","message","getOne","id","params","findOne"],"mappings":"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","file":"payment.controller.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import crypto from 'crypto';\nimport PaymentModel from './payment.model';\nimport InvoiceModel from '../invoice/invoice.model';\nimport * as mailer from '../../modules/mailer';\nimport generateController from '../../modules/generateController';\nimport Transfer from '../../modules/transfer';\n\nconst secret = process.env.PAYSTACK_SECRET;\n\nexport default generateController(PaymentModel, {\n    createOne: (req, res) => {\n        const hash = crypto.createHmac('sha512', secret).update(JSON.stringify(req.body)).digest('hex');\n        const { event, data: { transaction: { reference }, amount, paid, invoice_code, customer: { first_name, last_name, email } } } = req.body;\n\n        if (hash === req.headers['x-paystack-signature'] && event === 'invoice.update' && paid) {\n            InvoiceModel.findOneAndUpdate({ invoice_code }, { $set :{ status: 'paid' } }, { new: true }, async (err, doc) => {\n                if (err) {\n                    console.error(err);\n                    return res.status(400).send({ error: new Error(error), status: false });\n                }\n\n                const {\n                    _id,\n                    type,\n                    whoPaysDeliveryFee,\n                    marchantName,\n                    marchantEmail,\n                    marchantBankCode,\n                    deliveryAmount,\n                    marchantAccountNumber\n                } = doc;\n\n\n                try {\n                    if (type === 'good') {\n                        await Transfer(marchantName, marchantAccountNumber, marchantBankCode, deliveryAmount);\n                        await PaymentModel.create({ customerEmail: email, marchantEmail, reference, deliveryAmount, invoiceId: _id });\n                    }\n\n                    await mailer.sendReceiptMail(`${first_name} ${last_name}`, email, marchantEmail, amount);\n                    res.status(200).send({ success: true });\n                } catch (err) {\n                    console.error(err);\n                    return res.status(400).send({ error: { message: 'Could not send mail' }, success: false });\n                }\n            })\n        } else {\n            res.status(400).send({ success: false });\n        }\n    },\n    getOne: (req, res) => {\n        var id = req.params.invoiceId;\n        PaymentModel.findOne({ invoiceId: id }, function (err, doc) {\n            if (err) res.status(401).send({ success: false, error: { ...err } });\n            res.status(200).send({ success: true, data: doc });\n        });\n    }\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"7d0e5cb20ba0695d5fe8590128233ca606b3f880"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/payment/payment.route.js","statementMap":{"0":{"start":{"line":4,"column":13},"end":{"line":4,"column":29}},"1":{"start":{"line":6,"column":0},"end":{"line":6,"column":52}},"2":{"start":{"line":8,"column":0},"end":{"line":8,"column":52}},"3":{"start":{"line":10,"column":0},"end":{"line":10,"column":58}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/payment/payment.route.js"],"names":["express","PaymentController","Router","param","findByParam","route","post","createOne","get","getOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;;AAEA,IAAMC,SAASF,QAAQE,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,MAAb,EAAqBF,kBAAkBG,WAAvC;;AAEAF,OAAOG,KAAP,CAAa,GAAb,EACKC,IADL,CACUL,kBAAkBM,SAD5B;;AAGAL,OAAOG,KAAP,CAAa,aAAb,EACKG,GADL,CACSP,kBAAkBQ,MAD3B;;AAGA,eAAeP,MAAf","file":"payment.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport PaymentController from './payment.controller';\n\nconst Router = express.Router();\n\nRouter.param('/:id', PaymentController.findByParam);\n\nRouter.route('/')\n    .post(PaymentController.createOne);\n\nRouter.route('/:invoiceId')\n    .get(PaymentController.getOne);\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"bff3eb91f1d9edf483dc6a5e0a347972d7729f9d"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/dispute/dispute.route.js","statementMap":{"0":{"start":{"line":3,"column":13},"end":{"line":3,"column":29}},"1":{"start":{"line":5,"column":0},"end":{"line":5,"column":58}},"2":{"start":{"line":7,"column":0},"end":{"line":7,"column":92}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/dispute/dispute.route.js"],"names":["express","DisputeController","Router","param","getInvoiceId","route","post","createOne","get","getOne"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,iBAAP,MAA8B,sBAA9B;AACA,IAAMC,SAASF,QAAQE,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,WAAb,EAA0BF,kBAAkBG,YAA5C;;AAEAF,OAAOG,KAAP,CAAa,aAAb,EACKC,IADL,CACUL,kBAAkBM,SAD5B,EAEKC,GAFL,CAESP,kBAAkBQ,MAF3B;;AAIA,eAAeP,MAAf","file":"dispute.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport DisputeController from './dispute.controller';\nconst Router = express.Router();\n\nRouter.param('invoiceId', DisputeController.getInvoiceId);\n\nRouter.route('/:invoiceId')\n    .post(DisputeController.createOne)\n    .get(DisputeController.getOne);\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"1a94a95238012cbf38920e457e966864e29338fd"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/confirm/confirm.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/confirm/confirm.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":11,"column":20},"end":{"line":11,"column":36}},"2":{"start":{"line":13,"column":0},"end":{"line":13,"column":65}},"3":{"start":{"line":15,"column":0},"end":{"line":86,"column":3}},"4":{"start":{"line":16,"column":20},"end":{"line":16,"column":40}},"5":{"start":{"line":17,"column":17},"end":{"line":17,"column":60}},"6":{"start":{"line":18,"column":20},"end":{"line":18,"column":38}},"7":{"start":{"line":20,"column":4},"end":{"line":20,"column":134}},"8":{"start":{"line":20,"column":46},"end":{"line":20,"column":134}},"9":{"start":{"line":22,"column":4},"end":{"line":85,"column":9}},"10":{"start":{"line":23,"column":19},"end":{"line":80,"column":11}},"11":{"start":{"line":25,"column":12},"end":{"line":79,"column":42}},"12":{"start":{"line":26,"column":16},"end":{"line":78,"column":17}},"13":{"start":{"line":27,"column":20},"end":{"line":77,"column":21}},"14":{"start":{"line":29,"column":28},"end":{"line":29,"column":94}},"15":{"start":{"line":29,"column":39},"end":{"line":29,"column":94}},"16":{"start":{"line":30,"column":28},"end":{"line":30,"column":255}},"17":{"start":{"line":32,"column":28},"end":{"line":35,"column":29}},"18":{"start":{"line":33,"column":32},"end":{"line":33,"column":51}},"19":{"start":{"line":34,"column":32},"end":{"line":34,"column":38}},"20":{"start":{"line":37,"column":28},"end":{"line":37,"column":46}},"21":{"start":{"line":38,"column":28},"end":{"line":38,"column":52}},"22":{"start":{"line":41,"column":28},"end":{"line":43,"column":29}},"23":{"start":{"line":42,"column":32},"end":{"line":42,"column":53}},"24":{"start":{"line":45,"column":28},"end":{"line":47,"column":29}},"25":{"start":{"line":46,"column":32},"end":{"line":46,"column":57}},"26":{"start":{"line":49,"column":28},"end":{"line":51,"column":29}},"27":{"start":{"line":50,"column":32},"end":{"line":50,"column":61}},"28":{"start":{"line":53,"column":28},"end":{"line":55,"column":29}},"29":{"start":{"line":54,"column":32},"end":{"line":54,"column":57}},"30":{"start":{"line":57,"column":28},"end":{"line":57,"column":47}},"31":{"start":{"line":58,"column":28},"end":{"line":58,"column":107}},"32":{"start":{"line":61,"column":28},"end":{"line":61,"column":47}},"33":{"start":{"line":62,"column":28},"end":{"line":62,"column":34}},"34":{"start":{"line":65,"column":28},"end":{"line":65,"column":47}},"35":{"start":{"line":66,"column":28},"end":{"line":66,"column":63}},"36":{"start":{"line":68,"column":28},"end":{"line":68,"column":89}},"37":{"start":{"line":72,"column":28},"end":{"line":72,"column":79}},"38":{"start":{"line":76,"column":28},"end":{"line":76,"column":51}},"39":{"start":{"line":82,"column":8},"end":{"line":84,"column":10}},"40":{"start":{"line":83,"column":12},"end":{"line":83,"column":47}},"41":{"start":{"line":88,"column":0},"end":{"line":160,"column":5}},"42":{"start":{"line":89,"column":16},"end":{"line":155,"column":7}},"43":{"start":{"line":92,"column":8},"end":{"line":154,"column":39}},"44":{"start":{"line":93,"column":12},"end":{"line":153,"column":13}},"45":{"start":{"line":94,"column":16},"end":{"line":152,"column":17}},"46":{"start":{"line":96,"column":24},"end":{"line":96,"column":57}},"47":{"start":{"line":97,"column":24},"end":{"line":97,"column":61}},"48":{"start":{"line":98,"column":24},"end":{"line":98,"column":77}},"49":{"start":{"line":99,"column":24},"end":{"line":99,"column":55}},"50":{"start":{"line":101,"column":24},"end":{"line":104,"column":25}},"51":{"start":{"line":102,"column":28},"end":{"line":102,"column":47}},"52":{"start":{"line":103,"column":28},"end":{"line":103,"column":34}},"53":{"start":{"line":106,"column":24},"end":{"line":106,"column":140}},"54":{"start":{"line":109,"column":24},"end":{"line":109,"column":43}},"55":{"start":{"line":110,"column":24},"end":{"line":110,"column":43}},"56":{"start":{"line":111,"column":24},"end":{"line":111,"column":72}},"57":{"start":{"line":114,"column":24},"end":{"line":114,"column":47}},"58":{"start":{"line":115,"column":24},"end":{"line":115,"column":58}},"59":{"start":{"line":116,"column":24},"end":{"line":116,"column":76}},"60":{"start":{"line":117,"column":24},"end":{"line":117,"column":66}},"61":{"start":{"line":118,"column":24},"end":{"line":118,"column":54}},"62":{"start":{"line":119,"column":24},"end":{"line":119,"column":39}},"63":{"start":{"line":120,"column":24},"end":{"line":120,"column":44}},"64":{"start":{"line":123,"column":24},"end":{"line":128,"column":27}},"65":{"start":{"line":124,"column":28},"end":{"line":127,"column":29}},"66":{"start":{"line":125,"column":32},"end":{"line":125,"column":51}},"67":{"start":{"line":126,"column":32},"end":{"line":126,"column":46}},"68":{"start":{"line":130,"column":24},"end":{"line":130,"column":44}},"69":{"start":{"line":131,"column":24},"end":{"line":131,"column":113}},"70":{"start":{"line":134,"column":24},"end":{"line":134,"column":46}},"71":{"start":{"line":135,"column":24},"end":{"line":135,"column":63}},"72":{"start":{"line":136,"column":24},"end":{"line":139,"column":27}},"73":{"start":{"line":137,"column":28},"end":{"line":137,"column":90}},"74":{"start":{"line":137,"column":37},"end":{"line":137,"column":90}},"75":{"start":{"line":138,"column":28},"end":{"line":138,"column":79}},"76":{"start":{"line":140,"column":24},"end":{"line":140,"column":44}},"77":{"start":{"line":141,"column":24},"end":{"line":141,"column":30}},"78":{"start":{"line":144,"column":24},"end":{"line":144,"column":44}},"79":{"start":{"line":145,"column":24},"end":{"line":145,"column":61}},"80":{"start":{"line":147,"column":24},"end":{"line":147,"column":86}},"81":{"start":{"line":151,"column":24},"end":{"line":151,"column":48}},"82":{"start":{"line":157,"column":4},"end":{"line":159,"column":6}},"83":{"start":{"line":158,"column":8},"end":{"line":158,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":15,"column":40},"end":{"line":15,"column":41}},"loc":{"start":{"line":15,"column":60},"end":{"line":86,"column":1}},"line":15},"1":{"name":"(anonymous_1)","decl":{"start":{"line":22,"column":99},"end":{"line":22,"column":100}},"loc":{"start":{"line":22,"column":111},"end":{"line":85,"column":5}},"line":22},"2":{"name":"_callee","decl":{"start":{"line":23,"column":85},"end":{"line":23,"column":92}},"loc":{"start":{"line":23,"column":105},"end":{"line":80,"column":9}},"line":23},"3":{"name":"_callee$","decl":{"start":{"line":25,"column":53},"end":{"line":25,"column":61}},"loc":{"start":{"line":25,"column":72},"end":{"line":79,"column":13}},"line":25},"4":{"name":"(anonymous_4)","decl":{"start":{"line":82,"column":15},"end":{"line":82,"column":16}},"loc":{"start":{"line":82,"column":34},"end":{"line":84,"column":9}},"line":82},"5":{"name":"(anonymous_5)","decl":{"start":{"line":88,"column":53},"end":{"line":88,"column":54}},"loc":{"start":{"line":88,"column":65},"end":{"line":160,"column":1}},"line":88},"6":{"name":"_callee2","decl":{"start":{"line":89,"column":82},"end":{"line":89,"column":90}},"loc":{"start":{"line":89,"column":101},"end":{"line":155,"column":5}},"line":89},"7":{"name":"_callee2$","decl":{"start":{"line":92,"column":49},"end":{"line":92,"column":58}},"loc":{"start":{"line":92,"column":70},"end":{"line":154,"column":9}},"line":92},"8":{"name":"(anonymous_8)","decl":{"start":{"line":123,"column":43},"end":{"line":123,"column":44}},"loc":{"start":{"line":123,"column":59},"end":{"line":128,"column":25}},"line":123},"9":{"name":"(anonymous_9)","decl":{"start":{"line":136,"column":127},"end":{"line":136,"column":128}},"loc":{"start":{"line":136,"column":147},"end":{"line":139,"column":25}},"line":136},"10":{"name":"(anonymous_10)","decl":{"start":{"line":157,"column":11},"end":{"line":157,"column":12}},"loc":{"start":{"line":157,"column":31},"end":{"line":159,"column":5}},"line":157}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":17},"end":{"line":17,"column":60}},"type":"cond-expr","locations":[{"start":{"line":17,"column":37},"end":{"line":17,"column":47}},{"start":{"line":17,"column":50},"end":{"line":17,"column":60}}],"line":17},"1":{"loc":{"start":{"line":20,"column":4},"end":{"line":20,"column":134}},"type":"if","locations":[{"start":{"line":20,"column":4},"end":{"line":20,"column":134}},{"start":{"line":20,"column":4},"end":{"line":20,"column":134}}],"line":20},"2":{"loc":{"start":{"line":27,"column":20},"end":{"line":77,"column":21}},"type":"switch","locations":[{"start":{"line":28,"column":24},"end":{"line":58,"column":107}},{"start":{"line":60,"column":24},"end":{"line":62,"column":34}},{"start":{"line":64,"column":24},"end":{"line":68,"column":89}},{"start":{"line":70,"column":24},"end":{"line":72,"column":79}},{"start":{"line":74,"column":24},"end":{"line":74,"column":32}},{"start":{"line":75,"column":24},"end":{"line":76,"column":51}}],"line":27},"3":{"loc":{"start":{"line":29,"column":28},"end":{"line":29,"column":94}},"type":"if","locations":[{"start":{"line":29,"column":28},"end":{"line":29,"column":94}},{"start":{"line":29,"column":28},"end":{"line":29,"column":94}}],"line":29},"4":{"loc":{"start":{"line":32,"column":28},"end":{"line":35,"column":29}},"type":"if","locations":[{"start":{"line":32,"column":28},"end":{"line":35,"column":29}},{"start":{"line":32,"column":28},"end":{"line":35,"column":29}}],"line":32},"5":{"loc":{"start":{"line":41,"column":28},"end":{"line":43,"column":29}},"type":"if","locations":[{"start":{"line":41,"column":28},"end":{"line":43,"column":29}},{"start":{"line":41,"column":28},"end":{"line":43,"column":29}}],"line":41},"6":{"loc":{"start":{"line":45,"column":28},"end":{"line":47,"column":29}},"type":"if","locations":[{"start":{"line":45,"column":28},"end":{"line":47,"column":29}},{"start":{"line":45,"column":28},"end":{"line":47,"column":29}}],"line":45},"7":{"loc":{"start":{"line":49,"column":28},"end":{"line":51,"column":29}},"type":"if","locations":[{"start":{"line":49,"column":28},"end":{"line":51,"column":29}},{"start":{"line":49,"column":28},"end":{"line":51,"column":29}}],"line":49},"8":{"loc":{"start":{"line":53,"column":28},"end":{"line":55,"column":29}},"type":"if","locations":[{"start":{"line":53,"column":28},"end":{"line":55,"column":29}},{"start":{"line":53,"column":28},"end":{"line":55,"column":29}}],"line":53},"9":{"loc":{"start":{"line":94,"column":16},"end":{"line":152,"column":17}},"type":"switch","locations":[{"start":{"line":95,"column":20},"end":{"line":106,"column":140}},{"start":{"line":108,"column":20},"end":{"line":111,"column":72}},{"start":{"line":113,"column":20},"end":{"line":131,"column":113}},{"start":{"line":133,"column":20},"end":{"line":141,"column":30}},{"start":{"line":143,"column":20},"end":{"line":147,"column":86}},{"start":{"line":149,"column":20},"end":{"line":149,"column":28}},{"start":{"line":150,"column":20},"end":{"line":151,"column":48}}],"line":94},"10":{"loc":{"start":{"line":98,"column":33},"end":{"line":98,"column":76}},"type":"cond-expr","locations":[{"start":{"line":98,"column":53},"end":{"line":98,"column":63}},{"start":{"line":98,"column":66},"end":{"line":98,"column":76}}],"line":98},"11":{"loc":{"start":{"line":101,"column":24},"end":{"line":104,"column":25}},"type":"if","locations":[{"start":{"line":101,"column":24},"end":{"line":104,"column":25}},{"start":{"line":101,"column":24},"end":{"line":104,"column":25}}],"line":101},"12":{"loc":{"start":{"line":124,"column":28},"end":{"line":127,"column":29}},"type":"if","locations":[{"start":{"line":124,"column":28},"end":{"line":127,"column":29}},{"start":{"line":124,"column":28},"end":{"line":127,"column":29}}],"line":124},"13":{"loc":{"start":{"line":137,"column":28},"end":{"line":137,"column":90}},"type":"if","locations":[{"start":{"line":137,"column":28},"end":{"line":137,"column":90}},{"start":{"line":137,"column":28},"end":{"line":137,"column":90}}],"line":137}},"s":{"0":1,"1":1,"2":1,"3":1,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":0,"31":0,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0,"40":0,"41":1,"42":1,"43":0,"44":0,"45":0,"46":0,"47":0,"48":0,"49":0,"50":0,"51":0,"52":0,"53":0,"54":0,"55":0,"56":0,"57":0,"58":0,"59":0,"60":0,"61":0,"62":0,"63":0,"64":0,"65":0,"66":0,"67":0,"68":0,"69":0,"70":0,"71":0,"72":0,"73":0,"74":0,"75":0,"76":0,"77":0,"78":0,"79":0,"80":0,"81":0,"82":1,"83":0},"f":{"0":0,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"0":[0,0],"1":[0,0],"2":[0,0,0,0,0,0],"3":[0,0],"4":[0,0],"5":[0,0],"6":[0,0],"7":[0,0],"8":[0,0],"9":[0,0,0,0,0,0,0],"10":[0,0],"11":[0,0],"12":[0,0],"13":[0,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/confirm/confirm.route.js"],"names":["express","InvoiceModel","MilestoneSchema","Transfer","DisputeController","ConfirmRouter","Router","param","getInvoiceId","route","post","req","res","invoiceId","params","status","body","accepted","emailCode","invoice","verifyCode","send","success","error","Error","findOneAndUpdate","_id","$set","new","doc","marchantName","marchantAccountNumber","marchantBankCode","purchaseAmount","pipePayFee","deliveryAmount","amount","whoPaysPipepayFee","whoPaysDeliveryFee","data","milestoneId","findOne","milestones","milestone","milestoneIndex","forEach","m","i","paid","err"],"mappings":"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","file":"confirm.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport InvoiceModel, { MilestoneSchema } from '../invoice/invoice.model';\nimport Transfer from '../../modules/transfer';\nimport DisputeController from '../dispute/dispute.controller';\n\nconst ConfirmRouter = express.Router();\n\nConfirmRouter.param('invoiceId', DisputeController.getInvoiceId);\n\nConfirmRouter.route('/:invoiceId')\n    .post((req, res) => {\n        const invoiceId = req.params.invoiceId;\n        const status = req.body.accepted ? 'accepted' : 'rejected';\n        const emailCode = req.body.emailCode;\n\n        if (req.invoice.verifyCode !== emailCode) return res.status(400).send({ success: false, error: new Error('Wrong invoice code') });\n\n        InvoiceModel.findOneAndUpdate({ _id: invoiceId }, { $set: { status } }, {new: true}, async (error, doc) => {\n            if (error) res.status(400).send({ success: false, error });\n            const { marchantName, marchantAccountNumber, marchantBankCode, purchaseAmount, pipePayFee, deliveryAmount } = doc;\n\n            if (status === \"accepted\") {\n                try {\n                    let amount = purchaseAmount;\n\n                    if  (doc.whoPaysPipepayFee === 'seller') {\n                        amount -= pipePayFee;\n                    }\n\n                    if (doc.whoPaysPipepayFee === 'both') {\n                        amount -= (pipePayFee / 2);\n                    }\n\n                    if (doc.whoPaysDeliveryFee === 'both') {\n                        amount += (deliveryAmount / 2);\n                    }\n\n                    if (doc.whoPaysDeliveryFee === 'seller') {\n                        amount -= deliveryAmount;\n                    }\n\n                    await Transfer(marchantName, marchantAccountNumber, marchantBankCode, amount);\n                } catch(err) {\n                    res.status(400).send({ success: false, error: err });\n                }\n            }\n\n            res.status(200).send({ success: true, data: doc });\n        });\n    });\n\nConfirmRouter.route('/:invoiceId/:milestoneId')\n    .post(async (req, res) => {\n        const invoiceId = req.params.invoiceId;\n        const milestoneId = req.params.milestoneId;\n        \n        const status = req.body.accepted ? 'accepted' : 'rejected';\n        const emailCode = req.body.emailCode;\n\n        if (req.invoice.verifyCode !== emailCode) return res.status(400).send({ success: false, error: new Error('Wrong invoice code') });\n        try {\n            const { marchantName, marchantAccountNumber, marchantBankCode, milestones } = await InvoiceModel.findOne({ _id: invoiceId });\n            let milestone = {};\n            let milestoneIndex = -1;\n\n            milestones.forEach((m, i) => {\n                if (m._id == milestoneId) {\n                    milestoneIndex = i;\n                    milestone = m;\n                }\n            });\n\n            await Transfer(marchantName, marchantAccountNumber, marchantBankCode, milestone.amount);\n            milestone.paid = true;\n            milestones[milestoneIndex] = milestone;\n            InvoiceModel.findOneAndUpdate({ _id: invoiceId }, { $set: { milestones } }, {new: true}, (err, doc) => {\n                if (err) res.status(400).send({ success: false, error: err });\n                res.status(200).send({ success: true, data: doc });\n            });\n        } catch (err) {\n            res.status(400).send({ success: false, error: err });\n        }\n    });\n\nexport default ConfirmRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"abdbfbb272aeb1ee1b2750884f4ca1ac6972a6bd"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/banks/banks.route.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/banks/banks.route.js","statementMap":{"0":{"start":{"line":4,"column":12},"end":{"line":4,"column":16}},"1":{"start":{"line":8,"column":13},"end":{"line":8,"column":40}},"2":{"start":{"line":9,"column":13},"end":{"line":9,"column":29}},"3":{"start":{"line":11,"column":0},"end":{"line":35,"column":5}},"4":{"start":{"line":12,"column":15},"end":{"line":30,"column":7}},"5":{"start":{"line":13,"column":8},"end":{"line":29,"column":27}},"6":{"start":{"line":14,"column":12},"end":{"line":28,"column":13}},"7":{"start":{"line":15,"column":16},"end":{"line":27,"column":17}},"8":{"start":{"line":17,"column":24},"end":{"line":22,"column":27}},"9":{"start":{"line":18,"column":39},"end":{"line":18,"column":54}},"10":{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},"11":{"start":{"line":20,"column":37},"end":{"line":20,"column":88}},"12":{"start":{"line":21,"column":28},"end":{"line":21,"column":68}},"13":{"start":{"line":26,"column":24},"end":{"line":26,"column":47}},"14":{"start":{"line":32,"column":4},"end":{"line":34,"column":6}},"15":{"start":{"line":33,"column":8},"end":{"line":33,"column":43}},"16":{"start":{"line":37,"column":0},"end":{"line":67,"column":5}},"17":{"start":{"line":38,"column":16},"end":{"line":62,"column":7}},"18":{"start":{"line":41,"column":8},"end":{"line":61,"column":28}},"19":{"start":{"line":42,"column":12},"end":{"line":60,"column":13}},"20":{"start":{"line":43,"column":16},"end":{"line":59,"column":17}},"21":{"start":{"line":45,"column":24},"end":{"line":45,"column":129}},"22":{"start":{"line":48,"column":24},"end":{"line":54,"column":27}},"23":{"start":{"line":49,"column":39},"end":{"line":49,"column":54}},"24":{"start":{"line":51,"column":28},"end":{"line":51,"column":68}},"25":{"start":{"line":53,"column":28},"end":{"line":53,"column":79}},"26":{"start":{"line":58,"column":24},"end":{"line":58,"column":48}},"27":{"start":{"line":64,"column":4},"end":{"line":66,"column":6}},"28":{"start":{"line":65,"column":8},"end":{"line":65,"column":44}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":11,"column":22},"end":{"line":11,"column":23}},"loc":{"start":{"line":11,"column":34},"end":{"line":35,"column":1}},"line":11},"1":{"name":"_callee","decl":{"start":{"line":12,"column":81},"end":{"line":12,"column":88}},"loc":{"start":{"line":12,"column":99},"end":{"line":30,"column":5}},"line":12},"2":{"name":"_callee$","decl":{"start":{"line":13,"column":49},"end":{"line":13,"column":57}},"loc":{"start":{"line":13,"column":68},"end":{"line":29,"column":9}},"line":13},"3":{"name":"(anonymous_3)","decl":{"start":{"line":17,"column":153},"end":{"line":17,"column":154}},"loc":{"start":{"line":17,"column":175},"end":{"line":22,"column":25}},"line":17},"4":{"name":"(anonymous_4)","decl":{"start":{"line":32,"column":11},"end":{"line":32,"column":12}},"loc":{"start":{"line":32,"column":30},"end":{"line":34,"column":5}},"line":32},"5":{"name":"(anonymous_5)","decl":{"start":{"line":37,"column":55},"end":{"line":37,"column":56}},"loc":{"start":{"line":37,"column":67},"end":{"line":67,"column":1}},"line":37},"6":{"name":"_callee2","decl":{"start":{"line":38,"column":82},"end":{"line":38,"column":90}},"loc":{"start":{"line":38,"column":101},"end":{"line":62,"column":5}},"line":38},"7":{"name":"_callee2$","decl":{"start":{"line":41,"column":49},"end":{"line":41,"column":58}},"loc":{"start":{"line":41,"column":70},"end":{"line":61,"column":9}},"line":41},"8":{"name":"(anonymous_8)","decl":{"start":{"line":48,"column":223},"end":{"line":48,"column":224}},"loc":{"start":{"line":48,"column":240},"end":{"line":52,"column":25}},"line":48},"9":{"name":"(anonymous_9)","decl":{"start":{"line":52,"column":33},"end":{"line":52,"column":34}},"loc":{"start":{"line":52,"column":48},"end":{"line":54,"column":25}},"line":52},"10":{"name":"(anonymous_10)","decl":{"start":{"line":64,"column":11},"end":{"line":64,"column":12}},"loc":{"start":{"line":64,"column":31},"end":{"line":66,"column":5}},"line":64}},"branchMap":{"0":{"loc":{"start":{"line":15,"column":16},"end":{"line":27,"column":17}},"type":"switch","locations":[{"start":{"line":16,"column":20},"end":{"line":22,"column":27}},{"start":{"line":24,"column":20},"end":{"line":24,"column":27}},{"start":{"line":25,"column":20},"end":{"line":26,"column":47}}],"line":15},"1":{"loc":{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},"type":"if","locations":[{"start":{"line":20,"column":28},"end":{"line":20,"column":88}},{"start":{"line":20,"column":28},"end":{"line":20,"column":88}}],"line":20},"2":{"loc":{"start":{"line":43,"column":16},"end":{"line":59,"column":17}},"type":"switch","locations":[{"start":{"line":44,"column":20},"end":{"line":54,"column":27}},{"start":{"line":56,"column":20},"end":{"line":56,"column":27}},{"start":{"line":57,"column":20},"end":{"line":58,"column":48}}],"line":43}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0,"14":1,"15":0,"16":1,"17":1,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":1,"28":0},"f":{"0":1,"1":0,"2":0,"3":0,"4":0,"5":1,"6":0,"7":0,"8":0,"9":0,"10":0},"b":{"0":[0,0,0],"1":[0,0],"2":[0,0,0]},"inputSourceMap":{"version":3,"sources":["src/api/resources/banks/banks.route.js"],"names":["request","express","secret","process","env","PAYSTACK_SECRET","Router","route","get","req","res","set","end","err","data","body","status","send","success","params","bank_code","account_number","then","catch"],"mappings":";;;;;AAAA,OAAOA,OAAP,MAAoB,YAApB;AACA,OAAOC,OAAP,MAAoB,SAApB;AACA,IAAMC,SAASC,QAAQC,GAAR,CAAYC,eAA3B;AACA,IAAMC,SAASL,QAAQK,MAAR,EAAf;;AAEAA,OAAOC,KAAP,CAAa,GAAb,EACKC,GADL;AAAA,wEACS,iBAAOC,GAAP,EAAYC,GAAZ;AAAA;AAAA;AAAA;AAAA;AACDV,gCACKQ,GADL,iCAEKG,GAFL,CAES,cAFT,EAEyB,kBAFzB,EAGKA,GAHL,CAGS,eAHT,cAGoCT,MAHpC,EAIKU,GAJL,CAIS,UAACC,GAAD,SAA6B;AAAA,gCAAbC,IAAa,SAArBC,IAAqB,CAAbD,IAAa;;AAC9B,gCAAID,GAAJ,EAASH,IAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBL,QAAlB,EAArB;AACTH,gCAAIO,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAiBJ,UAAjB,EAAT;AACH,yBAPL;;AADC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAYAR,OAAOC,KAAP,CAAa,oCAAb,EACKC,GADL;AAAA,yEACS,kBAAOC,GAAP,EAAYC,GAAZ;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,sCACqCD,IAAIU,MADzC,EACOC,SADP,eACOA,SADP,EACkBC,cADlB,eACkBA,cADlB;;;AAGDrB,gCACKQ,GADL,0DACgEa,cADhE,mBAC4FD,SAD5F,EAEKT,GAFL,CAES,cAFT,EAEyB,kBAFzB,EAGKA,GAHL,CAGS,eAHT,cAGoCT,MAHpC,EAIKoB,IAJL,CAIU,iBAAwB;AAAA,gCAAbR,IAAa,SAArBC,IAAqB,CAAbD,IAAa;;AAC1BJ,gCAAIO,IAAJ,CAAS,EAAEC,SAAS,IAAX,EAAiBJ,UAAjB,EAAT;AACH,yBANL,EAOKS,KAPL,CAOW,UAACV,GAAD,EAAS;AACZH,gCAAIM,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,KAAX,EAAkBL,QAAlB,EAArB;AACH,yBATL;;AAHC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KADT;;AAAA;AAAA;AAAA;AAAA;;AAiBA,eAAeP,MAAf","file":"banks.route.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import request from 'superagent';\nimport express from 'express';\nconst secret = process.env.PAYSTACK_SECRET;\nconst Router = express.Router();\n\nRouter.route('/')\n    .get(async (req, res) => {\n        request\n            .get(`https://api.paystack.co/bank`)\n            .set('Content-Type', 'application/json')\n            .set('Authorization', `Bearer ${secret}`)\n            .end((err, { body: { data } }) => {\n                if (err) res.status(400).send({ success: false, err });\n                res.send({ success: true, data });\n            });\n    });\n\nRouter.route('/verify/:bank_code/:account_number')\n    .get(async (req, res) => {\n        const { bank_code, account_number } = req.params;\n        \n        request\n            .get(`https://api.paystack.co/bank/resolve?account_number=${account_number}&bank_code=${bank_code}`)\n            .set('Content-Type', 'application/json')\n            .set('Authorization', `Bearer ${secret}`)\n            .then(({ body: { data } }) => {\n                res.send({ success: true, data })\n            })\n            .catch((err) => {\n                res.status(400).send({ success: false, err });\n            });\n    });\n\n\nexport default Router;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"2dfce16ff815242d35e8f89044f5af50b04257a7"},"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/auth.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/modules/auth.js","statementMap":{"0":{"start":{"line":6,"column":12},"end":{"line":6,"column":16}},"1":{"start":{"line":10,"column":11},"end":{"line":10,"column":34}},"2":{"start":{"line":11,"column":15},"end":{"line":11,"column":102}},"3":{"start":{"line":13,"column":16},"end":{"line":13,"column":20}},"4":{"start":{"line":15,"column":20},"end":{"line":55,"column":1}},"5":{"start":{"line":16,"column":4},"end":{"line":54,"column":9}},"6":{"start":{"line":17,"column":19},"end":{"line":49,"column":11}},"7":{"start":{"line":20,"column":12},"end":{"line":48,"column":41}},"8":{"start":{"line":21,"column":16},"end":{"line":47,"column":17}},"9":{"start":{"line":22,"column":20},"end":{"line":46,"column":21}},"10":{"start":{"line":24,"column":28},"end":{"line":24,"column":46}},"11":{"start":{"line":25,"column":28},"end":{"line":25,"column":46}},"12":{"start":{"line":26,"column":28},"end":{"line":26,"column":55}},"13":{"start":{"line":29,"column":28},"end":{"line":29,"column":50}},"14":{"start":{"line":30,"column":28},"end":{"line":30,"column":51}},"15":{"start":{"line":32,"column":28},"end":{"line":32,"column":45}},"16":{"start":{"line":33,"column":28},"end":{"line":33,"column":38}},"17":{"start":{"line":34,"column":28},"end":{"line":34,"column":47}},"18":{"start":{"line":35,"column":28},"end":{"line":35,"column":34}},"19":{"start":{"line":38,"column":28},"end":{"line":38,"column":46}},"20":{"start":{"line":39,"column":28},"end":{"line":39,"column":63}},"21":{"start":{"line":41,"column":28},"end":{"line":41,"column":48}},"22":{"start":{"line":45,"column":28},"end":{"line":45,"column":51}},"23":{"start":{"line":51,"column":8},"end":{"line":53,"column":10}},"24":{"start":{"line":52,"column":12},"end":{"line":52,"column":47}},"25":{"start":{"line":57,"column":25},"end":{"line":96,"column":1}},"26":{"start":{"line":58,"column":23},"end":{"line":58,"column":39}},"27":{"start":{"line":59,"column":24},"end":{"line":59,"column":49}},"28":{"start":{"line":61,"column":4},"end":{"line":87,"column":5}},"29":{"start":{"line":62,"column":20},"end":{"line":62,"column":53}},"30":{"start":{"line":63,"column":24},"end":{"line":63,"column":61}},"31":{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},"32":{"start":{"line":66,"column":36},"end":{"line":66,"column":52}},"33":{"start":{"line":67,"column":22},"end":{"line":67,"column":43}},"34":{"start":{"line":68,"column":22},"end":{"line":68,"column":43}},"35":{"start":{"line":69,"column":26},"end":{"line":69,"column":43}},"36":{"start":{"line":70,"column":22},"end":{"line":70,"column":33}},"37":{"start":{"line":71,"column":22},"end":{"line":71,"column":33}},"38":{"start":{"line":73,"column":36},"end":{"line":75,"column":14}},"39":{"start":{"line":74,"column":16},"end":{"line":74,"column":54}},"40":{"start":{"line":76,"column":37},"end":{"line":76,"column":73}},"41":{"start":{"line":77,"column":27},"end":{"line":77,"column":48}},"42":{"start":{"line":79,"column":29},"end":{"line":79,"column":58}},"43":{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},"44":{"start":{"line":82,"column":16},"end":{"line":82,"column":35}},"45":{"start":{"line":83,"column":16},"end":{"line":83,"column":23}},"46":{"start":{"line":84,"column":16},"end":{"line":84,"column":23}},"47":{"start":{"line":89,"column":4},"end":{"line":92,"column":5}},"48":{"start":{"line":90,"column":8},"end":{"line":90,"column":15}},"49":{"start":{"line":91,"column":8},"end":{"line":91,"column":15}},"50":{"start":{"line":94,"column":4},"end":{"line":94,"column":74}},"51":{"start":{"line":95,"column":4},"end":{"line":95,"column":11}}},"fnMap":{"0":{"name":"getJWT","decl":{"start":{"line":15,"column":29},"end":{"line":15,"column":35}},"loc":{"start":{"line":15,"column":38},"end":{"line":55,"column":1}},"line":15},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":24},"end":{"line":16,"column":25}},"loc":{"start":{"line":16,"column":36},"end":{"line":54,"column":5}},"line":16},"2":{"name":"_callee","decl":{"start":{"line":17,"column":85},"end":{"line":17,"column":92}},"loc":{"start":{"line":17,"column":110},"end":{"line":49,"column":9}},"line":17},"3":{"name":"_callee$","decl":{"start":{"line":20,"column":53},"end":{"line":20,"column":61}},"loc":{"start":{"line":20,"column":72},"end":{"line":48,"column":13}},"line":20},"4":{"name":"(anonymous_4)","decl":{"start":{"line":51,"column":15},"end":{"line":51,"column":16}},"loc":{"start":{"line":51,"column":34},"end":{"line":53,"column":9}},"line":51},"5":{"name":"verifyToken","decl":{"start":{"line":57,"column":34},"end":{"line":57,"column":45}},"loc":{"start":{"line":57,"column":62},"end":{"line":96,"column":1}},"line":57},"6":{"name":"(anonymous_6)","decl":{"start":{"line":73,"column":53},"end":{"line":73,"column":54}},"loc":{"start":{"line":73,"column":66},"end":{"line":75,"column":13}},"line":73}},"branchMap":{"0":{"loc":{"start":{"line":22,"column":20},"end":{"line":46,"column":21}},"type":"switch","locations":[{"start":{"line":23,"column":24},"end":{"line":26,"column":55}},{"start":{"line":28,"column":24},"end":{"line":35,"column":34}},{"start":{"line":37,"column":24},"end":{"line":41,"column":48}},{"start":{"line":43,"column":24},"end":{"line":43,"column":32}},{"start":{"line":44,"column":24},"end":{"line":45,"column":51}}],"line":22},"1":{"loc":{"start":{"line":61,"column":4},"end":{"line":87,"column":5}},"type":"if","locations":[{"start":{"line":61,"column":4},"end":{"line":87,"column":5}},{"start":{"line":61,"column":4},"end":{"line":87,"column":5}}],"line":61},"2":{"loc":{"start":{"line":61,"column":8},"end":{"line":61,"column":60}},"type":"binary-expr","locations":[{"start":{"line":61,"column":8},"end":{"line":61,"column":21}},{"start":{"line":61,"column":25},"end":{"line":61,"column":60}}],"line":61},"3":{"loc":{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},"type":"if","locations":[{"start":{"line":65,"column":8},"end":{"line":86,"column":9}},{"start":{"line":65,"column":8},"end":{"line":86,"column":9}}],"line":65},"4":{"loc":{"start":{"line":74,"column":23},"end":{"line":74,"column":53}},"type":"binary-expr","locations":[{"start":{"line":74,"column":23},"end":{"line":74,"column":36}},{"start":{"line":74,"column":40},"end":{"line":74,"column":53}}],"line":74},"5":{"loc":{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},"type":"if","locations":[{"start":{"line":81,"column":12},"end":{"line":85,"column":13}},{"start":{"line":81,"column":12},"end":{"line":85,"column":13}}],"line":81},"6":{"loc":{"start":{"line":81,"column":16},"end":{"line":81,"column":74}},"type":"binary-expr","locations":[{"start":{"line":81,"column":16},"end":{"line":81,"column":38}},{"start":{"line":81,"column":42},"end":{"line":81,"column":54}},{"start":{"line":81,"column":58},"end":{"line":81,"column":74}}],"line":81},"7":{"loc":{"start":{"line":89,"column":4},"end":{"line":92,"column":5}},"type":"if","locations":[{"start":{"line":89,"column":4},"end":{"line":92,"column":5}},{"start":{"line":89,"column":4},"end":{"line":92,"column":5}}],"line":89},"8":{"loc":{"start":{"line":89,"column":8},"end":{"line":89,"column":531}},"type":"binary-expr","locations":[{"start":{"line":89,"column":8},"end":{"line":89,"column":54}},{"start":{"line":89,"column":58},"end":{"line":89,"column":93}},{"start":{"line":89,"column":97},"end":{"line":89,"column":143}},{"start":{"line":89,"column":147},"end":{"line":89,"column":181}},{"start":{"line":89,"column":185},"end":{"line":89,"column":229}},{"start":{"line":89,"column":233},"end":{"line":89,"column":267}},{"start":{"line":89,"column":271},"end":{"line":89,"column":317}},{"start":{"line":89,"column":321},"end":{"line":89,"column":356}},{"start":{"line":89,"column":360},"end":{"line":89,"column":406}},{"start":{"line":89,"column":410},"end":{"line":89,"column":444}},{"start":{"line":89,"column":448},"end":{"line":89,"column":493}},{"start":{"line":89,"column":497},"end":{"line":89,"column":531}}],"line":89}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":2,"9":3,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":0,"20":0,"21":0,"22":1,"23":1,"24":1,"25":1,"26":3,"27":3,"28":3,"29":3,"30":3,"31":3,"32":3,"33":3,"34":3,"35":3,"36":3,"37":3,"38":3,"39":6,"40":3,"41":3,"42":3,"43":3,"44":3,"45":3,"46":3,"47":0,"48":0,"49":0,"50":0,"51":0},"f":{"0":1,"1":1,"2":1,"3":2,"4":1,"5":3,"6":6},"b":{"0":[1,1,0,1,1],"1":[3,0],"2":[3,3],"3":[3,0],"4":[6,3],"5":[3,0],"6":[3,3,3],"7":[0,0],"8":[0,0,0,0,0,0,0,0,0,0,0,0]},"inputSourceMap":{"version":3,"sources":["src/api/modules/auth.js"],"names":["axios","jwt","aaud","process","env","COGNITO_AUD","tokenUrl","tokenKeys","getJWT","resolve","reject","get","keys","data","verifyToken","req","res","next","bearerLength","length","authorization","headers","token","slice","tokenData","decode","complete","header","kid","alg","payload","aud","exp","filter","k","matchKey","current_ts","Math","floor","Date","undefined","user","originalUrl","match","method","toLowerCase","status","send","success","error"],"mappings":"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","file":"auth.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import axios from 'axios';\nimport jwt from 'jsonwebtoken';\nconst aaud = process.env.COGNITO_AUD;\nconst tokenUrl = `https://cognito-idp.us-east-2.amazonaws.com/us-east-2_ZAwetvcgl/.well-known/jwks.json`;\n\nlet tokenKeys = null;\n\nexport const getJWT = () => new Promise(async (resolve, reject) => {\n    try {\n        const { data: { keys } } = await axios.get(tokenUrl);\n        tokenKeys  = keys;\n        resolve();\n    } catch (err) {\n        reject(err);\n    }\n});\n\nexport const verifyToken = (req, res, next) => {\n    const bearerLength = \"Bearer \".length;\n    const authorization = req.headers.authorization;\n\n    if (authorization && authorization.length > bearerLength) {\n        const token = authorization.slice(bearerLength);\n        const tokenData = jwt.decode(token, { complete: true });\n\n        if (!!tokenData) {\n            const { header: { kid, alg }, payload } = tokenData;\n            const { aud, exp } = payload;\n            const [ matchKey ] = tokenKeys.filter((k) => (k.kid === kid && k.alg === alg));\n            const current_ts = Math.floor(new Date() / 1000);\n\n            if (matchKey !== undefined && aaud === aud && current_ts < exp) {\n                req.user = payload;\n                next();\n                return;\n            }\n        }\n    }\n    \n    if (\n        req.originalUrl.match('/api/payment') !== null && req.method.toLowerCase() === 'post' ||\n        req.originalUrl.match('/api/payment') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/banks') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/dispute') !== null && req.method.toLowerCase() === 'post' ||\n        req.originalUrl.match('/api/dispute') !== null && req.method.toLowerCase() === 'get' ||\n        req.originalUrl.match('/api/verify') !== null && req.method.toLowerCase() === 'get'\n    ) {\n        next(); \n        return;\n    } \n\n    res.status(403).send({ success: false, error: 'Invalid auth token' });\n    return;\n};"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"3ab525ae3dc2d8e924626402fe17d088f45655ad"},"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/index.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/api/resources/index.js","statementMap":{"0":{"start":{"line":12,"column":17},"end":{"line":12,"column":33}},"1":{"start":{"line":14,"column":0},"end":{"line":14,"column":39}},"2":{"start":{"line":15,"column":0},"end":{"line":15,"column":37}},"3":{"start":{"line":16,"column":0},"end":{"line":16,"column":41}},"4":{"start":{"line":17,"column":0},"end":{"line":17,"column":41}},"5":{"start":{"line":18,"column":0},"end":{"line":18,"column":54}},"6":{"start":{"line":19,"column":0},"end":{"line":19,"column":53}},"7":{"start":{"line":20,"column":0},"end":{"line":20,"column":54}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/api/resources/index.js"],"names":["express","VerifyRoute","RequestRoute","InvoceRoute","PaymentRoute","DisputeRoute","ConfirmRoute","BanksRoute","verifyToken","MainRouter","Router","use"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,WAAP,MAAwB,uBAAxB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,WAAP,MAAwB,yBAAxB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,YAAP,MAAyB,yBAAzB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;;AAEA,SAASC,WAAT,QAA4B,iBAA5B;;AAEA,IAAMC,aAAaT,QAAQU,MAAR,EAAnB;;AAEAD,WAAWE,GAAX,CAAe,SAAf,EAA0BV,WAA1B;AACAQ,WAAWE,GAAX,CAAe,QAAf,EAAyBJ,UAAzB;AACAE,WAAWE,GAAX,CAAe,UAAf,EAA2BL,YAA3B;AACAG,WAAWE,GAAX,CAAe,UAAf,EAA2BN,YAA3B;AACAI,WAAWE,GAAX,CAAe,UAAf,EAA2BH,WAA3B,EAAwCN,YAAxC;AACAO,WAAWE,GAAX,CAAe,UAAf,EAA2BH,WAA3B,EAAwCL,WAAxC;AACAM,WAAWE,GAAX,CAAe,UAAf,EAA2BH,WAA3B,EAAwCJ,YAAxC;;AAEA,eAAeK,UAAf","file":"index.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport VerifyRoute from './verify/verify.route';\nimport RequestRoute from './request/request.route';\nimport InvoceRoute from './invoice/invoice.route';\nimport PaymentRoute from './payment/payment.route';\nimport DisputeRoute from './dispute/dispute.route';\nimport ConfirmRoute from './confirm/confirm.route';\nimport BanksRoute from './banks/banks.route';\n\nimport { verifyToken } from '../modules/auth';\n\nconst MainRouter = express.Router();\n\nMainRouter.use('/verify', VerifyRoute);\nMainRouter.use('/banks', BanksRoute);\nMainRouter.use('/confirm', ConfirmRoute);\nMainRouter.use('/dispute', DisputeRoute);\nMainRouter.use('/request', verifyToken, RequestRoute);\nMainRouter.use('/invoice', verifyToken, InvoceRoute);\nMainRouter.use('/payment', verifyToken, PaymentRoute);\n\nexport default MainRouter;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"ad1e96a72ff17b2c1ea694e889c37ed76aa6aa95"},"/Users/Sleekvick/Projects/pipepay/server/src/config/index.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/config/index.js","statementMap":{"0":{"start":{"line":2,"column":10},"end":{"line":2,"column":30}},"1":{"start":{"line":4,"column":0},"end":{"line":4,"column":24}},"2":{"start":{"line":6,"column":17},"end":{"line":11,"column":1}},"3":{"start":{"line":13,"column":16},"end":{"line":13,"column":18}},"4":{"start":{"line":15,"column":0},"end":{"line":25,"column":1}},"5":{"start":{"line":18,"column":8},"end":{"line":18,"column":44}},"6":{"start":{"line":19,"column":8},"end":{"line":19,"column":14}},"7":{"start":{"line":22,"column":8},"end":{"line":22,"column":45}},"8":{"start":{"line":24,"column":8},"end":{"line":24,"column":44}}},"fnMap":{},"branchMap":{"0":{"loc":{"start":{"line":15,"column":0},"end":{"line":25,"column":1}},"type":"switch","locations":[{"start":{"line":16,"column":4},"end":{"line":16,"column":23}},{"start":{"line":17,"column":4},"end":{"line":19,"column":14}},{"start":{"line":20,"column":4},"end":{"line":20,"column":16}},{"start":{"line":21,"column":4},"end":{"line":22,"column":45}},{"start":{"line":23,"column":4},"end":{"line":24,"column":44}}],"line":15}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":0,"6":0,"7":0,"8":1},"f":{},"b":{"0":[0,0,0,0,1]},"inputSourceMap":{"version":3,"sources":["src/config/index.js"],"names":["merge","env","process","NODE_ENV","console","log","baseConfig","port","db","url","envConfig","require","config"],"mappings":"AAAA,OAAOA,KAAP,MAAkB,cAAlB;AACA,IAAMC,MAAMC,QAAQD,GAAR,CAAYE,QAAxB;;AAEAC,QAAQC,GAAR,CAAY,KAAZ,EAAmBJ,GAAnB;;AAEA,IAAMK,aAAa;AACfC,UAAM,IADS;AAEfC,QAAI;AACAC,aAAK;AADL;AAFW,CAAnB;;AAOA,IAAIC,YAAY,EAAhB;;AAEA,QAAQT,GAAR;AACI,SAAK,aAAL;AACA,SAAK,KAAL;AACIS,oBAAYC,QAAQ,OAAR,EAAiBC,MAA7B;AACA;AACJ,SAAK,MAAL;AACA,SAAK,YAAL;AACIF,oBAAYC,QAAQ,QAAR,EAAkBC,MAA9B;AACJ;AACIF,oBAAYC,QAAQ,OAAR,EAAiBC,MAA7B;AATR;;AAYA,eAAeZ,MAAMM,UAAN,EAAkBI,SAAlB,CAAf","file":"index.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import merge from 'lodash.merge';\nconst env = process.env.NODE_ENV\n\nconsole.log('env', env);\n\nconst baseConfig = {\n    port: 3000,\n    db: {\n        url: ''\n    }\n}\n\nlet envConfig = {}\n\nswitch (env) {\n    case 'development':\n    case 'dev':\n        envConfig = require('./dev').config\n        break;\n    case 'prod':\n    case 'production':\n        envConfig = require('./prod').config\n    default:\n        envConfig = require('./dev').config \n}\n\nexport default merge(baseConfig, envConfig)"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"12b98bce8cc8749db5861f0b1c175fec28356b2a"},"/Users/Sleekvick/Projects/pipepay/server/src/config/dev.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/config/dev.js","statementMap":{"0":{"start":{"line":1,"column":15},"end":{"line":1,"column":34}},"1":{"start":{"line":2,"column":15},"end":{"line":2,"column":38}},"2":{"start":{"line":4,"column":20},"end":{"line":8,"column":1}}},"fnMap":{},"branchMap":{},"s":{"0":1,"1":1,"2":1},"f":{},"b":{},"inputSourceMap":{"version":3,"sources":["src/config/dev.js"],"names":["username","process","env","DB_USER","password","DB_PASSWORD","config","db","url"],"mappings":"AAAA,IAAMA,WAAWC,QAAQC,GAAR,CAAYC,OAA7B;AACA,IAAMC,WAAWH,QAAQC,GAAR,CAAYG,WAA7B;;AAEA,OAAO,IAAMC,SAAS;AAClBC,QAAI;AACAC;AADA;AADc,CAAf","file":"dev.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["const username = process.env.DB_USER;\nconst password = process.env.DB_PASSWORD;\n\nexport const config = {\n    db: {\n        url: `mongodb://localhost:27017/pipepay`\n    }\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"7fd446ce6880388639c06c2698ea81f288331135"},"/Users/Sleekvick/Projects/pipepay/server/src/db.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/db.js","statementMap":{"0":{"start":{"line":4,"column":0},"end":{"line":4,"column":34}},"1":{"start":{"line":6,"column":21},"end":{"line":10,"column":1}},"2":{"start":{"line":7,"column":17},"end":{"line":7,"column":94}},"3":{"start":{"line":9,"column":4},"end":{"line":9,"column":70}}},"fnMap":{"0":{"name":"connect","decl":{"start":{"line":6,"column":30},"end":{"line":6,"column":37}},"loc":{"start":{"line":6,"column":40},"end":{"line":10,"column":1}},"line":6}},"branchMap":{"0":{"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":94}},"type":"cond-expr","locations":[{"start":{"line":7,"column":70},"end":{"line":7,"column":82}},{"start":{"line":7,"column":85},"end":{"line":7,"column":94}}],"line":7},"1":{"loc":{"start":{"line":7,"column":17},"end":{"line":7,"column":67}},"type":"binary-expr","locations":[{"start":{"line":7,"column":17},"end":{"line":7,"column":37}},{"start":{"line":7,"column":41},"end":{"line":7,"column":67}}],"line":7}},"s":{"0":1,"1":1,"2":1,"3":1},"f":{"0":1},"b":{"0":[0,1],"1":[1,0]},"inputSourceMap":{"version":3,"sources":["src/db.js"],"names":["mongoose","appConfig","Promise","global","connect","config","db","url","useNewUrlParser"],"mappings":"AAAA,OAAOA,QAAP,MAAqB,UAArB;AACA,OAAOC,SAAP,MAAsB,UAAtB;;AAEAD,SAASE,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,OAAO,IAAME,UAAU,SAAVA,OAAU,GAAwB;AAAA,QAAvBC,MAAuB,uEAAdJ,SAAc;;AAC3C,WAAOD,SAASI,OAAT,CAAiBC,OAAOC,EAAP,CAAUC,GAA3B,EAAgC,EAAEC,iBAAiB,IAAnB,EAAhC,CAAP;AACH,CAFM","file":"db.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import mongoose from 'mongoose'\nimport appConfig from './config'\n\nmongoose.Promise = global.Promise\n\nexport const connect = (config = appConfig) => {\n    return mongoose.connect(config.db.url, { useNewUrlParser: true });\n}"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"16ad6e924b87568ea46f15e9dda6e9bad4f67d09"},"/Users/Sleekvick/Projects/pipepay/server/src/server.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/server.js","statementMap":{"0":{"start":{"line":7,"column":10},"end":{"line":7,"column":19}},"1":{"start":{"line":9,"column":0},"end":{"line":9,"column":9}},"2":{"start":{"line":10,"column":0},"end":{"line":10,"column":21}},"3":{"start":{"line":12,"column":0},"end":{"line":16,"column":3}},"4":{"start":{"line":13,"column":4},"end":{"line":13,"column":51}},"5":{"start":{"line":14,"column":4},"end":{"line":14,"column":112}},"6":{"start":{"line":15,"column":4},"end":{"line":15,"column":11}},"7":{"start":{"line":18,"column":0},"end":{"line":20,"column":3}},"8":{"start":{"line":19,"column":4},"end":{"line":19,"column":36}},"9":{"start":{"line":22,"column":0},"end":{"line":22,"column":28}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":12,"column":8},"end":{"line":12,"column":9}},"loc":{"start":{"line":12,"column":34},"end":{"line":16,"column":1}},"line":12},"1":{"name":"(anonymous_1)","decl":{"start":{"line":18,"column":16},"end":{"line":18,"column":17}},"loc":{"start":{"line":18,"column":31},"end":{"line":20,"column":1}},"line":18}},"branchMap":{},"s":{"0":1,"1":1,"2":1,"3":1,"4":3,"5":3,"6":3,"7":1,"8":0,"9":1},"f":{"0":3,"1":0},"b":{},"inputSourceMap":{"version":3,"sources":["src/server.js"],"names":["express","setupMiddleware","MainRouter","connect","getJWT","app","use","req","res","next","header","catch","err","console","error","qerr"],"mappings":"AAAA,OAAOA,OAAP,MAAoB,SAApB;AACA,OAAOC,eAAP,MAA4B,cAA5B;AACA,OAAOC,UAAP,MAAuB,iBAAvB;AACA,SAASC,OAAT,QAAwB,MAAxB;AACA,SAASC,MAAT,QAAuB,oBAAvB;;AAEA,IAAMC,MAAML,SAAZ;;AAEAI;AACAH,gBAAgBI,GAAhB;;AAEAA,IAAIC,GAAJ,CAAQ,UAASC,GAAT,EAAcC,GAAd,EAAmBC,IAAnB,EAAyB;AAC7BD,QAAIE,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;AACAF,QAAIE,MAAJ,CAAW,8BAAX,EAA2C,+DAA3C;AACAD;AACH,CAJD;;AAMAN,UAAUQ,KAAV,CAAgB,UAACC,GAAD,EAAS;AACrBC,YAAQC,KAAR,CAAc,UAAd,EAA0BC,IAA1B;AACH,CAFD;;AAIAV,IAAIC,GAAJ,CAAQ,MAAR,EAAgBJ,UAAhB;;AAEA,eAAeG,GAAf","file":"server.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import express from 'express';\nimport setupMiddleware from './middleware';\nimport MainRouter from './api/resources';\nimport { connect } from './db';\nimport { getJWT } from './api/modules/auth';\n\nconst app = express();\n\ngetJWT();\nsetupMiddleware(app);\n\napp.use(function(req, res, next) {\n    res.header(\"Access-Control-Allow-Origin\", \"*\");\n    res.header(\"Access-Control-Allow-Headers\", \"Origin, X-Requested-With, Authorization, Content-Type, Accept\");\n    next();\n});\n\nconnect().catch((err) => {\n    console.error('DB error', qerr);\n});\n\napp.use('/api', MainRouter);\n\nexport default app;"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"111e204fb216d33f0f325e3b91a9633abaef5584"},"/Users/Sleekvick/Projects/pipepay/server/src/test-helpers/auth.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/test-helpers/auth.js","statementMap":{"0":{"start":{"line":10,"column":11},"end":{"line":10,"column":34}},"1":{"start":{"line":12,"column":0},"end":{"line":12,"column":34}},"2":{"start":{"line":14,"column":25},"end":{"line":28,"column":1}},"3":{"start":{"line":15,"column":14},"end":{"line":15,"column":39}},"4":{"start":{"line":16,"column":2},"end":{"line":27,"column":5}},"5":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"6":{"start":{"line":18,"column":6},"end":{"line":18,"column":23}},"7":{"start":{"line":20,"column":4},"end":{"line":26,"column":7}},"8":{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},"9":{"start":{"line":22,"column":8},"end":{"line":22,"column":20}},"10":{"start":{"line":24,"column":8},"end":{"line":24,"column":18}},"11":{"start":{"line":30,"column":20},"end":{"line":34,"column":1}},"12":{"start":{"line":31,"column":2},"end":{"line":33,"column":5}},"13":{"start":{"line":32,"column":4},"end":{"line":32,"column":64}},"14":{"start":{"line":36,"column":22},"end":{"line":39,"column":2}},"15":{"start":{"line":41,"column":20},"end":{"line":61,"column":1}},"16":{"start":{"line":42,"column":2},"end":{"line":60,"column":5}},"17":{"start":{"line":43,"column":29},"end":{"line":46,"column":5}},"18":{"start":{"line":48,"column":19},"end":{"line":51,"column":5}},"19":{"start":{"line":53,"column":22},"end":{"line":53,"column":47}},"20":{"start":{"line":54,"column":32},"end":{"line":54,"column":77}},"21":{"start":{"line":56,"column":4},"end":{"line":59,"column":7}}},"fnMap":{"0":{"name":"removeModel","decl":{"start":{"line":14,"column":34},"end":{"line":14,"column":45}},"loc":{"start":{"line":14,"column":57},"end":{"line":28,"column":1}},"line":14},"1":{"name":"(anonymous_1)","decl":{"start":{"line":16,"column":22},"end":{"line":16,"column":23}},"loc":{"start":{"line":16,"column":49},"end":{"line":27,"column":3}},"line":16},"2":{"name":"(anonymous_2)","decl":{"start":{"line":20,"column":17},"end":{"line":20,"column":18}},"loc":{"start":{"line":20,"column":32},"end":{"line":26,"column":5}},"line":20},"3":{"name":"dropDb","decl":{"start":{"line":30,"column":29},"end":{"line":30,"column":35}},"loc":{"start":{"line":30,"column":38},"end":{"line":34,"column":1}},"line":30},"4":{"name":"(anonymous_4)","decl":{"start":{"line":31,"column":73},"end":{"line":31,"column":74}},"loc":{"start":{"line":31,"column":85},"end":{"line":33,"column":3}},"line":31},"5":{"name":"signin","decl":{"start":{"line":41,"column":29},"end":{"line":41,"column":35}},"loc":{"start":{"line":41,"column":56},"end":{"line":61,"column":1}},"line":41},"6":{"name":"(anonymous_6)","decl":{"start":{"line":42,"column":22},"end":{"line":42,"column":23}},"loc":{"start":{"line":42,"column":49},"end":{"line":60,"column":3}},"line":42}},"branchMap":{"0":{"loc":{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},"type":"if","locations":[{"start":{"line":17,"column":4},"end":{"line":19,"column":5}},{"start":{"line":17,"column":4},"end":{"line":19,"column":5}}],"line":17},"1":{"loc":{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},"type":"if","locations":[{"start":{"line":21,"column":6},"end":{"line":25,"column":7}},{"start":{"line":21,"column":6},"end":{"line":25,"column":7}}],"line":21}},"s":{"0":1,"1":1,"2":1,"3":3,"4":3,"5":3,"6":0,"7":3,"8":3,"9":0,"10":3,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":1,"20":1,"21":1},"f":{"0":3,"1":3,"2":3,"3":1,"4":1,"5":1,"6":1},"b":{"0":[0,3],"1":[0,3]},"inputSourceMap":{"version":3,"sources":["src/test-helpers/auth.js"],"names":["AuthenticationDetails","CognitoUserPool","CognitoUser","mongoose","config","aaud","process","env","COGNITO_AUD","Promise","global","removeModel","modelName","model","resolve","reject","remove","err","dropDb","connect","db","url","useNewUrlParser","then","all","modelNames","map","userPool","UserPoolId","ClientId","signin","Username","Password","authenticationData","userData","Pool","cognitoUser","authenticationDetails","authenticateUser","onSuccess","onFailure"],"mappings":";AAAA,OAAO,wCAAP;AACA,OAAO,wCAAP;AACA,OAAO,wCAAP;;AAEA,SAASA,qBAAT,EAAgCC,eAAhC,EAAiDC,WAAjD,QAAoE,4BAApE;;AAEA,OAAOC,QAAP,MAAqB,UAArB;AACA,OAAOC,MAAP,MAAmB,WAAnB;AACA,IAAMC,OAAOC,QAAQC,GAAR,CAAYC,WAAzB;;AAEAL,SAASM,OAAT,GAAmBC,OAAOD,OAA1B;;AAEA,OAAO,IAAME,cAAc,SAAdA,WAAc,CAACC,SAAD,EAAe;AACxC,MAAMC,QAAQV,SAASU,KAAT,CAAeD,SAAf,CAAd;AACA,SAAO,aAAY,UAACE,OAAD,EAAUC,MAAV,EAAqB;AACtC,QAAI,CAACF,KAAL,EAAY;AACV,aAAOC,SAAP;AACD;AACDD,UAAMG,MAAN,CAAa,UAACC,GAAD,EAAS;AACpB,UAAIA,GAAJ,EAAS;AACPF,eAAOE,GAAP;AACD,OAFD,MAEO;AACLH;AACD;AACF,KAND;AAOD,GAXM,CAAP;AAYD,CAdM;;AAgBP,OAAO,IAAMI,SAAS,SAATA,MAAS,GAAM;AAC1B,SAAOf,SAASgB,OAAT,CAAiBf,OAAOgB,EAAP,CAAUC,GAA3B,EAAgC,EAAEC,iBAAiB,IAAnB,EAAhC,EAA2DC,IAA3D,CAAgE;AAAA,WAAM,SAAQC,GAAR,CAAYrB,SAASsB,UAAT,GAAsBC,GAAtB,CAA0Bf,WAA1B,CAAZ,CAAN;AAAA,GAAhE,CAAP;AACD,CAFM;;AAIP,OAAO,IAAMgB,WAAW,IAAI1B,eAAJ,CAAoB;AAC1C2B,cAAY,qBAD8B;AAE1CC,YAAUxB;AAFgC,CAApB,CAAjB;;AAKP,OAAO,IAAMyB,SAAS,SAATA,MAAS,CAACC,QAAD,EAAWC,QAAX;AAAA,SAAwB,aAAY,UAAClB,OAAD,EAAUC,MAAV,EAAqB;AAC7E,QAAIkB,qBAAqB;AACvBF,wBADuB;AAEvBC;AAFuB,KAAzB;;AAKA,QAAIE,WAAW;AACbH,wBADa;AAEbI,YAAMR;AAFO,KAAf;;AAKA,QAAMS,cAAc,IAAIlC,WAAJ,CAAgBgC,QAAhB,CAApB;AACA,QAAIG,wBAAwB,IAAIrC,qBAAJ,CAA0BiC,kBAA1B,CAA5B;;AAEAG,gBAAYE,gBAAZ,CAA6BD,qBAA7B,EAAoD;AAClDE,iBAAWzB,OADuC;AAElD0B,iBAAWzB;AAFuC,KAApD;AAID,GAlB6C,CAAxB;AAAA,CAAf","file":"auth.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import '../api/resources/dispute/dispute.model'\nimport '../api/resources/invoice/invoice.model'\nimport '../api/resources/payment/payment.model'\n\nimport { AuthenticationDetails, CognitoUserPool, CognitoUser } from 'amazon-cognito-identity-js';\n\nimport mongoose from 'mongoose'\nimport config from '../config'\nconst aaud = process.env.COGNITO_AUD;\n\nmongoose.Promise = global.Promise\n\nexport const removeModel = (modelName) => {\n  const model = mongoose.model(modelName)\n  return new Promise((resolve, reject) => {\n    if (!model) {\n      return resolve()\n    }\n    model.remove((err) => {\n      if (err) {\n        reject(err)\n      } else {\n        resolve()\n      }\n    })\n  })\n}\n\nexport const dropDb = () => {\n  return mongoose.connect(config.db.url, { useNewUrlParser: true }).then(() => Promise.all(mongoose.modelNames().map(removeModel)))\n}\n\nexport const userPool = new CognitoUserPool({\n  UserPoolId: 'us-east-2_ZAwetvcgl',\n  ClientId: aaud\n});\n\nexport const signin = (Username, Password) => new Promise((resolve, reject) => {\n  let authenticationData = {\n    Username,\n    Password\n  };\n\n  let userData = {\n    Username,\n    Pool: userPool   \n  }\n\n  const cognitoUser = new CognitoUser(userData);\n  let authenticationDetails = new AuthenticationDetails(authenticationData);\n\n  cognitoUser.authenticateUser(authenticationDetails, {\n    onSuccess: resolve,\n    onFailure: reject\n  });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"0fd5e5af5555499341b1949e56d82fa8a4594af5"},"/Users/Sleekvick/Projects/pipepay/server/src/server.spec.js":{"path":"/Users/Sleekvick/Projects/pipepay/server/src/server.spec.js","statementMap":{"0":{"start":{"line":5,"column":12},"end":{"line":5,"column":16}},"1":{"start":{"line":15,"column":15},"end":{"line":15,"column":40}},"2":{"start":{"line":16,"column":15},"end":{"line":16,"column":40}},"3":{"start":{"line":17,"column":13},"end":{"line":17,"column":40}},"4":{"start":{"line":18,"column":11},"end":{"line":18,"column":33}},"5":{"start":{"line":19,"column":13},"end":{"line":19,"column":24}},"6":{"start":{"line":21,"column":0},"end":{"line":21,"column":19}},"7":{"start":{"line":22,"column":0},"end":{"line":22,"column":46}},"8":{"start":{"line":24,"column":0},"end":{"line":24,"column":9}},"9":{"start":{"line":26,"column":0},"end":{"line":309,"column":3}},"10":{"start":{"line":28,"column":16},"end":{"line":28,"column":22}},"11":{"start":{"line":29,"column":15},"end":{"line":29,"column":21}},"12":{"start":{"line":30,"column":20},"end":{"line":30,"column":30}},"13":{"start":{"line":31,"column":20},"end":{"line":31,"column":24}},"14":{"start":{"line":32,"column":23},"end":{"line":32,"column":27}},"15":{"start":{"line":33,"column":25},"end":{"line":33,"column":29}},"16":{"start":{"line":34,"column":21},"end":{"line":34,"column":25}},"17":{"start":{"line":36,"column":4},"end":{"line":73,"column":9}},"18":{"start":{"line":38,"column":8},"end":{"line":72,"column":37}},"19":{"start":{"line":39,"column":12},"end":{"line":71,"column":13}},"20":{"start":{"line":40,"column":16},"end":{"line":70,"column":17}},"21":{"start":{"line":42,"column":24},"end":{"line":42,"column":42}},"22":{"start":{"line":43,"column":24},"end":{"line":43,"column":42}},"23":{"start":{"line":44,"column":24},"end":{"line":44,"column":58}},"24":{"start":{"line":47,"column":24},"end":{"line":47,"column":64}},"25":{"start":{"line":49,"column":24},"end":{"line":58,"column":27}},"26":{"start":{"line":50,"column":28},"end":{"line":50,"column":56}},"27":{"start":{"line":50,"column":37},"end":{"line":50,"column":56}},"28":{"start":{"line":52,"column":28},"end":{"line":55,"column":29}},"29":{"start":{"line":53,"column":32},"end":{"line":53,"column":74}},"30":{"start":{"line":54,"column":32},"end":{"line":54,"column":67}},"31":{"start":{"line":57,"column":28},"end":{"line":57,"column":65}},"32":{"start":{"line":59,"column":24},"end":{"line":59,"column":43}},"33":{"start":{"line":60,"column":24},"end":{"line":60,"column":30}},"34":{"start":{"line":63,"column":24},"end":{"line":63,"column":42}},"35":{"start":{"line":64,"column":24},"end":{"line":64,"column":59}},"36":{"start":{"line":65,"column":24},"end":{"line":65,"column":42}},"37":{"start":{"line":69,"column":24},"end":{"line":69,"column":47}},"38":{"start":{"line":75,"column":4},"end":{"line":98,"column":7}},"39":{"start":{"line":76,"column":8},"end":{"line":97,"column":11}},"40":{"start":{"line":92,"column":12},"end":{"line":92,"column":54}},"41":{"start":{"line":93,"column":12},"end":{"line":93,"column":42}},"42":{"start":{"line":94,"column":12},"end":{"line":94,"column":70}},"43":{"start":{"line":95,"column":12},"end":{"line":95,"column":55}},"44":{"start":{"line":96,"column":12},"end":{"line":96,"column":19}},"45":{"start":{"line":100,"column":4},"end":{"line":107,"column":7}},"46":{"start":{"line":101,"column":8},"end":{"line":106,"column":11}},"47":{"start":{"line":102,"column":12},"end":{"line":102,"column":61}},"48":{"start":{"line":103,"column":12},"end":{"line":103,"column":65}},"49":{"start":{"line":104,"column":12},"end":{"line":104,"column":55}},"50":{"start":{"line":105,"column":12},"end":{"line":105,"column":19}},"51":{"start":{"line":109,"column":4},"end":{"line":117,"column":7}},"52":{"start":{"line":110,"column":8},"end":{"line":116,"column":11}},"53":{"start":{"line":113,"column":12},"end":{"line":113,"column":71}},"54":{"start":{"line":114,"column":12},"end":{"line":114,"column":55}},"55":{"start":{"line":115,"column":12},"end":{"line":115,"column":19}},"56":{"start":{"line":119,"column":4},"end":{"line":146,"column":7}},"57":{"start":{"line":120,"column":22},"end":{"line":136,"column":9}},"58":{"start":{"line":138,"column":19},"end":{"line":138,"column":101}},"59":{"start":{"line":140,"column":8},"end":{"line":145,"column":11}},"60":{"start":{"line":143,"column":12},"end":{"line":143,"column":48}},"61":{"start":{"line":144,"column":12},"end":{"line":144,"column":19}},"62":{"start":{"line":148,"column":4},"end":{"line":154,"column":7}},"63":{"start":{"line":149,"column":8},"end":{"line":153,"column":11}},"64":{"start":{"line":150,"column":12},"end":{"line":150,"column":67}},"65":{"start":{"line":151,"column":12},"end":{"line":151,"column":55}},"66":{"start":{"line":152,"column":12},"end":{"line":152,"column":19}},"67":{"start":{"line":156,"column":4},"end":{"line":161,"column":7}},"68":{"start":{"line":157,"column":8},"end":{"line":160,"column":11}},"69":{"start":{"line":158,"column":12},"end":{"line":158,"column":55}},"70":{"start":{"line":159,"column":12},"end":{"line":159,"column":19}},"71":{"start":{"line":163,"column":4},"end":{"line":170,"column":7}},"72":{"start":{"line":164,"column":8},"end":{"line":169,"column":11}},"73":{"start":{"line":167,"column":12},"end":{"line":167,"column":56}},"74":{"start":{"line":168,"column":12},"end":{"line":168,"column":19}},"75":{"start":{"line":172,"column":4},"end":{"line":181,"column":7}},"76":{"start":{"line":173,"column":8},"end":{"line":180,"column":11}},"77":{"start":{"line":177,"column":12},"end":{"line":177,"column":65}},"78":{"start":{"line":178,"column":12},"end":{"line":178,"column":55}},"79":{"start":{"line":179,"column":12},"end":{"line":179,"column":19}},"80":{"start":{"line":183,"column":4},"end":{"line":192,"column":7}},"81":{"start":{"line":184,"column":8},"end":{"line":191,"column":11}},"82":{"start":{"line":188,"column":12},"end":{"line":188,"column":65}},"83":{"start":{"line":189,"column":12},"end":{"line":189,"column":55}},"84":{"start":{"line":190,"column":12},"end":{"line":190,"column":19}},"85":{"start":{"line":194,"column":4},"end":{"line":201,"column":7}},"86":{"start":{"line":195,"column":8},"end":{"line":200,"column":11}},"87":{"start":{"line":196,"column":12},"end":{"line":196,"column":51}},"88":{"start":{"line":197,"column":12},"end":{"line":197,"column":62}},"89":{"start":{"line":198,"column":12},"end":{"line":198,"column":55}},"90":{"start":{"line":199,"column":12},"end":{"line":199,"column":19}},"91":{"start":{"line":203,"column":4},"end":{"line":209,"column":7}},"92":{"start":{"line":204,"column":8},"end":{"line":208,"column":11}},"93":{"start":{"line":205,"column":12},"end":{"line":205,"column":69}},"94":{"start":{"line":206,"column":12},"end":{"line":206,"column":55}},"95":{"start":{"line":207,"column":12},"end":{"line":207,"column":19}},"96":{"start":{"line":211,"column":4},"end":{"line":223,"column":7}},"97":{"start":{"line":212,"column":8},"end":{"line":222,"column":11}},"98":{"start":{"line":219,"column":12},"end":{"line":219,"column":60}},"99":{"start":{"line":220,"column":12},"end":{"line":220,"column":55}},"100":{"start":{"line":221,"column":12},"end":{"line":221,"column":19}},"101":{"start":{"line":225,"column":4},"end":{"line":231,"column":7}},"102":{"start":{"line":226,"column":8},"end":{"line":230,"column":11}},"103":{"start":{"line":227,"column":12},"end":{"line":227,"column":58}},"104":{"start":{"line":228,"column":12},"end":{"line":228,"column":55}},"105":{"start":{"line":229,"column":12},"end":{"line":229,"column":19}},"106":{"start":{"line":233,"column":4},"end":{"line":240,"column":7}},"107":{"start":{"line":234,"column":8},"end":{"line":239,"column":11}},"108":{"start":{"line":237,"column":12},"end":{"line":237,"column":55}},"109":{"start":{"line":238,"column":12},"end":{"line":238,"column":19}},"110":{"start":{"line":242,"column":4},"end":{"line":279,"column":7}},"111":{"start":{"line":243,"column":8},"end":{"line":278,"column":11}},"112":{"start":{"line":272,"column":12},"end":{"line":272,"column":54}},"113":{"start":{"line":273,"column":12},"end":{"line":273,"column":42}},"114":{"start":{"line":274,"column":12},"end":{"line":274,"column":50}},"115":{"start":{"line":275,"column":12},"end":{"line":275,"column":70}},"116":{"start":{"line":276,"column":12},"end":{"line":276,"column":55}},"117":{"start":{"line":277,"column":12},"end":{"line":277,"column":19}},"118":{"start":{"line":281,"column":4},"end":{"line":288,"column":7}},"119":{"start":{"line":282,"column":8},"end":{"line":287,"column":11}},"120":{"start":{"line":285,"column":12},"end":{"line":285,"column":55}},"121":{"start":{"line":286,"column":12},"end":{"line":286,"column":19}},"122":{"start":{"line":290,"column":4},"end":{"line":299,"column":7}},"123":{"start":{"line":291,"column":8},"end":{"line":298,"column":11}},"124":{"start":{"line":295,"column":12},"end":{"line":295,"column":71}},"125":{"start":{"line":296,"column":12},"end":{"line":296,"column":55}},"126":{"start":{"line":297,"column":12},"end":{"line":297,"column":19}},"127":{"start":{"line":301,"column":4},"end":{"line":308,"column":7}},"128":{"start":{"line":302,"column":8},"end":{"line":307,"column":11}},"129":{"start":{"line":305,"column":12},"end":{"line":305,"column":55}},"130":{"start":{"line":306,"column":12},"end":{"line":306,"column":19}}},"fnMap":{"0":{"name":"(anonymous_0)","decl":{"start":{"line":26,"column":30},"end":{"line":26,"column":31}},"loc":{"start":{"line":26,"column":42},"end":{"line":309,"column":1}},"line":26},"1":{"name":"_callee","decl":{"start":{"line":36,"column":82},"end":{"line":36,"column":89}},"loc":{"start":{"line":36,"column":92},"end":{"line":73,"column":5}},"line":36},"2":{"name":"_callee$","decl":{"start":{"line":38,"column":49},"end":{"line":38,"column":57}},"loc":{"start":{"line":38,"column":68},"end":{"line":72,"column":9}},"line":38},"3":{"name":"(anonymous_3)","decl":{"start":{"line":49,"column":47},"end":{"line":49,"column":48}},"loc":{"start":{"line":49,"column":70},"end":{"line":58,"column":25}},"line":49},"4":{"name":"(anonymous_4)","decl":{"start":{"line":75,"column":25},"end":{"line":75,"column":26}},"loc":{"start":{"line":75,"column":41},"end":{"line":98,"column":5}},"line":75},"5":{"name":"(anonymous_5)","decl":{"start":{"line":91,"column":15},"end":{"line":91,"column":16}},"loc":{"start":{"line":91,"column":35},"end":{"line":97,"column":9}},"line":91},"6":{"name":"(anonymous_6)","decl":{"start":{"line":100,"column":27},"end":{"line":100,"column":28}},"loc":{"start":{"line":100,"column":43},"end":{"line":107,"column":5}},"line":100},"7":{"name":"(anonymous_7)","decl":{"start":{"line":101,"column":63},"end":{"line":101,"column":64}},"loc":{"start":{"line":101,"column":83},"end":{"line":106,"column":9}},"line":101},"8":{"name":"(anonymous_8)","decl":{"start":{"line":109,"column":28},"end":{"line":109,"column":29}},"loc":{"start":{"line":109,"column":44},"end":{"line":117,"column":5}},"line":109},"9":{"name":"(anonymous_9)","decl":{"start":{"line":112,"column":15},"end":{"line":112,"column":16}},"loc":{"start":{"line":112,"column":35},"end":{"line":116,"column":9}},"line":112},"10":{"name":"(anonymous_10)","decl":{"start":{"line":119,"column":26},"end":{"line":119,"column":27}},"loc":{"start":{"line":119,"column":42},"end":{"line":146,"column":5}},"line":119},"11":{"name":"(anonymous_11)","decl":{"start":{"line":142,"column":29},"end":{"line":142,"column":30}},"loc":{"start":{"line":142,"column":49},"end":{"line":145,"column":9}},"line":142},"12":{"name":"(anonymous_12)","decl":{"start":{"line":148,"column":23},"end":{"line":148,"column":24}},"loc":{"start":{"line":148,"column":39},"end":{"line":154,"column":5}},"line":148},"13":{"name":"(anonymous_13)","decl":{"start":{"line":149,"column":63},"end":{"line":149,"column":64}},"loc":{"start":{"line":149,"column":83},"end":{"line":153,"column":9}},"line":149},"14":{"name":"(anonymous_14)","decl":{"start":{"line":156,"column":42},"end":{"line":156,"column":43}},"loc":{"start":{"line":156,"column":58},"end":{"line":161,"column":5}},"line":156},"15":{"name":"(anonymous_15)","decl":{"start":{"line":157,"column":62},"end":{"line":157,"column":63}},"loc":{"start":{"line":157,"column":82},"end":{"line":160,"column":9}},"line":157},"16":{"name":"(anonymous_16)","decl":{"start":{"line":163,"column":45},"end":{"line":163,"column":46}},"loc":{"start":{"line":163,"column":61},"end":{"line":170,"column":5}},"line":163},"17":{"name":"(anonymous_17)","decl":{"start":{"line":166,"column":15},"end":{"line":166,"column":16}},"loc":{"start":{"line":166,"column":35},"end":{"line":169,"column":9}},"line":166},"18":{"name":"(anonymous_18)","decl":{"start":{"line":172,"column":37},"end":{"line":172,"column":38}},"loc":{"start":{"line":172,"column":53},"end":{"line":181,"column":5}},"line":172},"19":{"name":"(anonymous_19)","decl":{"start":{"line":176,"column":15},"end":{"line":176,"column":16}},"loc":{"start":{"line":176,"column":35},"end":{"line":180,"column":9}},"line":176},"20":{"name":"(anonymous_20)","decl":{"start":{"line":183,"column":37},"end":{"line":183,"column":38}},"loc":{"start":{"line":183,"column":53},"end":{"line":192,"column":5}},"line":183},"21":{"name":"(anonymous_21)","decl":{"start":{"line":187,"column":15},"end":{"line":187,"column":16}},"loc":{"start":{"line":187,"column":35},"end":{"line":191,"column":9}},"line":187},"22":{"name":"(anonymous_22)","decl":{"start":{"line":194,"column":29},"end":{"line":194,"column":30}},"loc":{"start":{"line":194,"column":45},"end":{"line":201,"column":5}},"line":194},"23":{"name":"(anonymous_23)","decl":{"start":{"line":195,"column":49},"end":{"line":195,"column":50}},"loc":{"start":{"line":195,"column":69},"end":{"line":200,"column":9}},"line":195},"24":{"name":"(anonymous_24)","decl":{"start":{"line":203,"column":34},"end":{"line":203,"column":35}},"loc":{"start":{"line":203,"column":50},"end":{"line":209,"column":5}},"line":203},"25":{"name":"(anonymous_25)","decl":{"start":{"line":204,"column":89},"end":{"line":204,"column":90}},"loc":{"start":{"line":204,"column":109},"end":{"line":208,"column":9}},"line":204},"26":{"name":"(anonymous_26)","decl":{"start":{"line":211,"column":26},"end":{"line":211,"column":27}},"loc":{"start":{"line":211,"column":42},"end":{"line":223,"column":5}},"line":211},"27":{"name":"(anonymous_27)","decl":{"start":{"line":218,"column":15},"end":{"line":218,"column":16}},"loc":{"start":{"line":218,"column":35},"end":{"line":222,"column":9}},"line":218},"28":{"name":"(anonymous_28)","decl":{"start":{"line":225,"column":23},"end":{"line":225,"column":24}},"loc":{"start":{"line":225,"column":39},"end":{"line":231,"column":5}},"line":225},"29":{"name":"(anonymous_29)","decl":{"start":{"line":226,"column":63},"end":{"line":226,"column":64}},"loc":{"start":{"line":226,"column":83},"end":{"line":230,"column":9}},"line":226},"30":{"name":"(anonymous_30)","decl":{"start":{"line":233,"column":25},"end":{"line":233,"column":26}},"loc":{"start":{"line":233,"column":41},"end":{"line":240,"column":5}},"line":233},"31":{"name":"(anonymous_31)","decl":{"start":{"line":236,"column":15},"end":{"line":236,"column":16}},"loc":{"start":{"line":236,"column":35},"end":{"line":239,"column":9}},"line":236},"32":{"name":"(anonymous_32)","decl":{"start":{"line":242,"column":36},"end":{"line":242,"column":37}},"loc":{"start":{"line":242,"column":52},"end":{"line":279,"column":5}},"line":242},"33":{"name":"(anonymous_33)","decl":{"start":{"line":271,"column":15},"end":{"line":271,"column":16}},"loc":{"start":{"line":271,"column":35},"end":{"line":278,"column":9}},"line":271},"34":{"name":"(anonymous_34)","decl":{"start":{"line":281,"column":37},"end":{"line":281,"column":38}},"loc":{"start":{"line":281,"column":53},"end":{"line":288,"column":5}},"line":281},"35":{"name":"(anonymous_35)","decl":{"start":{"line":284,"column":15},"end":{"line":284,"column":16}},"loc":{"start":{"line":284,"column":35},"end":{"line":287,"column":9}},"line":284},"36":{"name":"(anonymous_36)","decl":{"start":{"line":290,"column":47},"end":{"line":290,"column":48}},"loc":{"start":{"line":290,"column":63},"end":{"line":299,"column":5}},"line":290},"37":{"name":"(anonymous_37)","decl":{"start":{"line":294,"column":15},"end":{"line":294,"column":16}},"loc":{"start":{"line":294,"column":35},"end":{"line":298,"column":9}},"line":294},"38":{"name":"(anonymous_38)","decl":{"start":{"line":301,"column":26},"end":{"line":301,"column":27}},"loc":{"start":{"line":301,"column":42},"end":{"line":308,"column":5}},"line":301},"39":{"name":"(anonymous_39)","decl":{"start":{"line":304,"column":15},"end":{"line":304,"column":16}},"loc":{"start":{"line":304,"column":35},"end":{"line":307,"column":9}},"line":304}},"branchMap":{"0":{"loc":{"start":{"line":40,"column":16},"end":{"line":70,"column":17}},"type":"switch","locations":[{"start":{"line":41,"column":20},"end":{"line":44,"column":58}},{"start":{"line":46,"column":20},"end":{"line":60,"column":30}},{"start":{"line":62,"column":20},"end":{"line":65,"column":42}},{"start":{"line":67,"column":20},"end":{"line":67,"column":28}},{"start":{"line":68,"column":20},"end":{"line":69,"column":47}}],"line":40},"1":{"loc":{"start":{"line":50,"column":28},"end":{"line":50,"column":56}},"type":"if","locations":[{"start":{"line":50,"column":28},"end":{"line":50,"column":56}},{"start":{"line":50,"column":28},"end":{"line":50,"column":56}}],"line":50},"2":{"loc":{"start":{"line":52,"column":28},"end":{"line":55,"column":29}},"type":"if","locations":[{"start":{"line":52,"column":28},"end":{"line":55,"column":29}},{"start":{"line":52,"column":28},"end":{"line":55,"column":29}}],"line":52},"3":{"loc":{"start":{"line":52,"column":32},"end":{"line":52,"column":58}},"type":"binary-expr","locations":[{"start":{"line":52,"column":32},"end":{"line":52,"column":38}},{"start":{"line":52,"column":42},"end":{"line":52,"column":58}}],"line":52}},"s":{"0":1,"1":1,"2":1,"3":1,"4":1,"5":1,"6":1,"7":1,"8":1,"9":1,"10":1,"11":1,"12":1,"13":1,"14":1,"15":1,"16":1,"17":1,"18":1,"19":2,"20":3,"21":1,"22":1,"23":1,"24":1,"25":1,"26":1,"27":0,"28":1,"29":1,"30":1,"31":1,"32":1,"33":1,"34":0,"35":0,"36":0,"37":1,"38":1,"39":1,"40":1,"41":1,"42":1,"43":1,"44":1,"45":1,"46":0,"47":0,"48":0,"49":0,"50":0,"51":1,"52":1,"53":1,"54":1,"55":1,"56":1,"57":0,"58":0,"59":0,"60":0,"61":0,"62":1,"63":0,"64":0,"65":0,"66":0,"67":1,"68":0,"69":0,"70":0,"71":1,"72":0,"73":0,"74":0,"75":1,"76":0,"77":0,"78":0,"79":0,"80":1,"81":0,"82":0,"83":0,"84":0,"85":1,"86":0,"87":0,"88":0,"89":0,"90":0,"91":1,"92":0,"93":0,"94":0,"95":0,"96":1,"97":0,"98":0,"99":0,"100":0,"101":1,"102":0,"103":0,"104":0,"105":0,"106":1,"107":1,"108":1,"109":1,"110":1,"111":0,"112":0,"113":0,"114":0,"115":0,"116":0,"117":0,"118":1,"119":0,"120":0,"121":0,"122":1,"123":0,"124":0,"125":0,"126":0,"127":1,"128":0,"129":0,"130":0},"f":{"0":1,"1":1,"2":2,"3":1,"4":1,"5":1,"6":0,"7":0,"8":1,"9":1,"10":0,"11":0,"12":0,"13":0,"14":0,"15":0,"16":0,"17":0,"18":0,"19":0,"20":0,"21":0,"22":0,"23":0,"24":0,"25":0,"26":0,"27":0,"28":0,"29":0,"30":1,"31":1,"32":0,"33":0,"34":0,"35":0,"36":0,"37":0,"38":0,"39":0},"b":{"0":[1,1,0,1,1],"1":[0,1],"2":[1,0],"3":[1,1]},"inputSourceMap":{"version":3,"sources":["src/server.spec.js"],"names":["chai","chaiHttp","axios","MockAdapter","crypto","app","signin","userPool","dropDb","username","process","env","TEST_USERNAME","password","TEST_PASSWORD","secret","PAYSTACK_SECRET","mock","expect","use","global","fetch","require","describe","token","user","emailCode","invoiceId","invoice_code","accessBankCode","milestones","it","cognitoUser","getCurrentUser","getSession","err","result","console","error","isValid","getIdToken","getJwtToken","payload","to","have","property","done","request","post","set","send","description","type","deliveryAmount","purchaseAmount","customerName","customerEmail","customerPhone","whoPaysPipepayFee","whoPaysDeliveryFee","end","res","body","data","_id","be","success","equal","xit","get","invoices","length","greaterThan","payment","event","paid","status","amount","transaction","reference","customer","first_name","last_name","email","hash","createHmac","update","digest","accepted","code","haveOwnProperty","marchantEmail","category","from","reason","delete","Date"],"mappings":"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","file":"server.spec.js","sourceRoot":"/Users/Sleekvick/Projects/pipepay/server","sourcesContent":["import chai from 'chai';\nimport chaiHttp from 'chai-http';\nimport axios from 'axios';\nimport MockAdapter from 'axios-mock-adapter';\nimport crypto from 'crypto';\nimport app from './server';\nimport { signin, userPool, dropDb } from './test-helpers/auth';\n\nconst username = process.env.TEST_USERNAME;\nconst password = process.env.TEST_PASSWORD;\nconst secret = process.env.PAYSTACK_SECRET;\nconst mock = new MockAdapter(axios);\nconst expect = chai.expect;\n\nchai.use(chaiHttp);\nglobal.fetch = require('node-fetch-polyfill');\n\ndropDb();\n\ndescribe('Server Operations', () => {\n    \n    let token;\n    let user;\n    let emailCode = 'AXYZ0000';\n    let invoiceId = null;\n    let invoice_code = null;\n    let accessBankCode = null;\n    let milestones = null;\n\n    it('Login', async () => {\n        try {\n            await signin(username, password);\n            const cognitoUser = userPool.getCurrentUser();    \n            cognitoUser.getSession((err, result) => {\n                if (err) console.error(err);\n\n                if (result && result.isValid()) {\n                    token = result.getIdToken().getJwtToken();\n                    user = result.getIdToken().payload;\n                }\n\n                expect(user).to.have.property('sub');\n            });\n        } catch (err) {\n            throw err;\n        }\n    });\n\n    it('create invoice', (done) => {\n        chai.request(app)\n        .post('/api/invoice')\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .send({\n            description: \"This is an invoice\",\n            type: 'good',\n            \n            deliveryAmount: 500,\n            purchaseAmount: 5000,\n            \n            customerName: 'Victor Nwaokocha',\n            customerEmail: 'vnwaokocha@gmail.com',\n            customerPhone: '09098612833',\n\n            whoPaysPipepayFee: 'seller',\n            whoPaysDeliveryFee: 'seller'\n        })\n        .end((err, res) => {\n            invoice_code = res.body.data.invoice_code;\n            invoiceId = res.body.data._id;\n            expect(res.body.data).to.be.have.property('invoice_code');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('retrive invoice', (done) => {\n        chai.request(app)\n        .get('/api/invoice/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.data._id).to.be.equal(invoiceId);\n            expect(res.body.data).to.have.property('totalPrice');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('get user invoices', (done) => {\n        chai.request(app)\n        .get('/api/invoice/')\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .end((err, res) => {\n            expect(res.body.data.invoices.length).to.be.greaterThan(0);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('create payment', (done) => {\n        const payment = {\n            event: 'invoice.update',\n            data: {\n                paid: true,\n                status: \"success\",\n                amount: 200000,\n                invoice_code,\n                transaction: {\n                    reference: \"1234\",\n                },\n                customer: {\n                    first_name: 'Victor',\n                    last_name: 'Nwaokocha',\n                    email: 'nvonweb@outlook.com',\n                } \n            }\n        };\n        \n        const hash = crypto.createHmac('sha512', secret).update(JSON.stringify(payment)).digest('hex');\n\n        chai.request(app)\n        .post('/api/payment')\n        .set({\n            'X-Paystack-Signature': hash\n        })\n        .send(payment)\n        .end((err, res) => {\n            expect(res.status).to.be.equal(200);\n            done();\n        });\n    });\n\n    xit('get payment', (done) => {\n        chai.request(app)\n        .get('/api/payment/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.data.invoiceId).to.be.equal(invoiceId);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('send customer verifcation mail', (done) => {\n        chai.request(app)\n        .get('/api/verify/'+invoiceId)\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('do not confirm without email code', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            accepted: true\n        })\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(false);\n            done();\n        });\n    });\n\n    xit('confirm payment::accepted', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            emailCode,\n            accepted: true\n        })\n        .end((err, res) => {\n            expect(res.body.data.status).to.be.equal(\"accepted\");\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('confirm payment::rejected', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId)\n        .send({\n            emailCode,\n            accepted: false\n        })\n        .end((err, res) => {\n            expect(res.body.data.status).to.be.equal(\"rejected\");\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('get list of banks', (done) => {\n        chai.request(app)\n        .get('/api/banks/')\n        .end((err, res) => {\n            accessBankCode = res.body.data[0].code;\n            expect(res.body.data.length).to.be.greaterThan(2);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('confirm account number', (done) => {\n        chai.request(app)\n        .get(`/api/banks/verify/${accessBankCode}/0695257934`)\n        .end((err, res) => {\n            expect(res.body.data).to.haveOwnProperty('account_name');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    })\n    \n    xit('create dispute', (done) => {\n        chai.request(app)\n        .post(`/api/dispute/${invoiceId}`)\n        .send({\n            customerEmail: 'nvonweb@outlook.com',\n            marchantEmail: 'vnwaokocha@gmail.com',\n            category: '',\n            from: 'marchant',\n            reason: 'I don\\'t want anymore'\n        })\n        .end((err, res) => {\n            expect(res.body.data).to.haveOwnProperty('_id');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('get dispute', (done) => {\n        chai.request(app)\n        .get(`/api/dispute/${invoiceId}`)\n        .end((err, res) => {\n            expect(res.body.data.status).to.equal('open');\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    it('delete invoice', (done) => {\n        chai.request(app)\n        .delete('/api/invoice/'+invoiceId)\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('create milestone invoice', (done) => {\n        chai.request(app)\n            .post('/api/invoice')\n            .set({\n                'Authorization': `Bearer ${token}`\n            })\n            .send({\n                description: \"This is an invoice\",\n                type: 'service',\n                \n                milestones: [{\n                    'name': 'Design',\n                    'amount': 30000,\n                    'description': 'Desiging',\n                    'dueDate':  new Date()\n                },{\n                    'name': 'Development',\n                    'amount': 30000,\n                    'description': 'Coding',\n                    'dueDate':  new Date()\n                },{\n                    'name': 'Deployment',\n                    'amount': 30000,\n                    'description': 'Deploying',\n                    'dueDate':  new Date()\n                }],\n                \n                customerName: 'Victor Nwaokocha',\n                customerEmail: 'vnwaokocha@gmail.com',\n                customerPhone: '09098612833',\n\n                whoPaysPipepayFee: 'seller'\n            })\n            .end((err, res) => {\n                invoice_code = res.body.data.invoice_code;\n                invoiceId = res.body.data._id;\n                milestones = res.body.data.milestones;\n                expect(res.body.data).to.be.have.property('invoice_code');\n                expect(res.body.success).to.be.equal(true);\n                done();\n            });\n    });\n\n    xit('request milestone payment', (done) => {\n        chai.request(app)\n            .get('/api/request/'+invoiceId+'/'+milestones[0]._id)\n            .set({\n                'Authorization': `Bearer ${token}`\n            })\n            .end((err, res) => {\n                expect(res.body.success).to.be.equal(true);\n                done();\n            });\n    });\n\n    xit('confirm milestone payment::accepted', (done) => {\n        chai.request(app)\n        .post('/api/confirm/'+invoiceId+'/'+milestones[0]._id)\n        .send({\n            emailCode,\n            accepted: true\n        })\n        .end((err, res) => {\n            expect(res.body.data.milestones[0].paid).to.be.equal(true);\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n\n    xit('delete invoice', (done) => {\n        chai.request(app)\n        .delete('/api/invoice/'+invoiceId)\n        .set({\n            'Authorization': `Bearer ${token}`\n        })\n        .end((err, res) => {\n            expect(res.body.success).to.be.equal(true);\n            done();\n        });\n    });\n});"]},"_coverageSchema":"332fd63041d2c1bcb487cc26dd0d5f7d97098a6c","hash":"f9e1019d07455b6174c46f369da52074269fce67"}}