{"version":3,"sources":["webpack:///./src/api/modules/mailer.js"],"names":["ZOHO_EMAIL","ZOHO_PASSWORD","transporter","nodemailer","createTransport","host","port","secure","auth","user","pass","from","sendInvoiceMail","customerEmail","totalPrice","resolve","reject","mailOptions","to","subject","text","sendMail","error","info","Error","sendTo","mailOption","sendReceiptMail","customerName","marchantEmail","amount","race","then","catch","sendTransferMail","esolve","sendDisputeMail","reason","disputeFrom","supportEmail","all","sendCustormerVerificationCode","code","sendPaymentRequest","marchantName","name","console","log"],"mappings":"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","file":"main.9698b0b4e7230f0be47a.hot-update.js","sourcesContent":["import nodemailer from 'nodemailer';\n\nconst ZOHO_EMAIL = process.env.ZOHO_EMAIL;\nconst ZOHO_PASSWORD = process.env.ZOHO_PASSWORD;\n\nconst transporter = nodemailer.createTransport({\n    host: 'smtp.zoho.com',\n    port: 465,\n    secure: true,\n    auth: {\n        user: ZOHO_EMAIL,\n        pass: ZOHO_PASSWORD\n    }\n});\n\nconst from = 'Pipepay <hello@pipepay.africa>';\n\nexport const sendInvoiceMail = ({ customerEmail, totalPrice }) => new Promise((resolve, reject) => {\n    let mailOptions = {\n        from,\n        to: customerEmail,\n        subject: 'Your Invoice Is Ready',\n        text: `Your invoice is worth ${totalPrice }`,\n    };\n\n    transporter.sendMail(mailOptions, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n\n        resolve(info);\n    });\n});\n\nconst sendTo = (mailOption) => new Promise((resolve, reject) => {\n    transporter.sendMail(mailOption, (error, info) => {\n        if (error) {\n            return reject(new Error(error));\n        }\n        resolve(info);\n    });\n});\n\nexport const sendReceiptMail = (customerName, customerEmail, marchantEmail, amount) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Your Receipt Is Ready',\n        text: `${customerName} made payment of ${amount}`,\n    };\n    Promise.race([\n        sendTo({ ...mailOption, to: customerEmail }),\n        sendTo({ ...mailOption, to: marchantEmail })\n    ]).then(resolve)\n    .catch(reject)\n});\n\nexport const sendTransferMail = (customerEmail, marchantEmail) => new Promise((esolve, reject) => {\n\n});\n\nexport const sendDisputeMail = (marchantEmail, customerEmail, customerName, reason, disputeFrom, supportEmail = 'hello@pipepay.africa') => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Payment Dispute',\n    };\n\n    try {\n        if (disputeFrom !== 'marchant') {\n            await Promise.all([\n                sendTo({ ...mailOption, to: customerEmail,  text: 'Your dispute has been received, you will hear from our support rep soon.' }),\n                sendTo({ ...mailOption, to: marchantEmail, text: `New dispute from ${customerName} reason being that: \"${reason}\"` }),\n                sendTo({ ...mailOption, to: supportEmail, text: `New dispute from ${customerEmail} reason being that: \"${reason}\" marchant email is ${marchantEmail}` })\n            ]);\n        } else {\n            await Promise.all([\n                sendTo({ ...mailOption, to: customerEmail,  text: 'Your dispute has been received, you will hear from our support rep soon.' }),\n                sendTo({ ...mailOption, to: marchantEmail, text: `New dispute from ${customerName} reason being that: \"${reason}\"` }),\n                sendTo({ ...mailOption, to: supportEmail, text: `New dispute from ${marchantEmail} reason being that: \"${reason}\" customer email is ${customerEmail}` })\n            ]);\n        }\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendCustormerVerificationCode = (customerEmail, code) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Invoice Mail Verification',\n        text: `Your invoice verfication code is ${code}`\n    };\n\n    try {\n        await sendTo({ ...mailOption, to: customerEmail });\n        resolve();\n    } catch(err) {\n        reject(err);\n    }\n});\n\nexport const sendPaymentRequest = ({ amount, name }, customerEmail, marchantName) => new Promise(async (resolve, reject) => {\n    let mailOption = {\n        from,\n        subject: 'Payment Request',\n        text: `${marchantName} is requesting for payment for milestone \"${name}\"`\n    };\n\n    try {\n        await sendTo({ ...mailOption, to: customerEmail });\n        resolve();\n    } catch(err) {\n        console.log('err', err);\n        reject(err);\n    }\n});"],"sourceRoot":""}